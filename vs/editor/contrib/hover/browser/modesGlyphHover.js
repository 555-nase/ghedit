var __extends=this&&this.__extends||function(t,e){function o(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)};define(["require","exports","./hoverOperation","./hoverWidgets"],function(t,e,o,i){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";var n=function(){function t(t){this._editor=t,this._lineNumber=-1}return t.prototype.setLineNumber=function(t){this._lineNumber=t,this._result=[]},t.prototype.clearResult=function(){this._result=[]},t.prototype.computeSync=function(){var t,e,o,i=[],n=this._editor.getLineDecorations(this._lineNumber);for(t=0,e=n.length;t<e;t++)o=n[t],o.options.glyphMarginClassName&&o.options.glyphMarginHoverMessage&&i.push({value:o.options.glyphMarginHoverMessage});return i},t.prototype.onResult=function(t,e){this._result=this._result.concat(t)},t.prototype.getResult=function(){return this._result},t.prototype.getResultWithLoadingMessage=function(){return this.getResult()},t}(),s=function(t){function e(i){var s=this;t.call(this,e.ID,i),this._lastLineNumber=-1,this._computer=new n(this._editor),this._hoverOperation=new o.HoverOperation(this._computer,function(t){return s._withResult(t)},null,function(t){return s._withResult(t)})}return __extends(e,t),e.prototype.dispose=function(){this._hoverOperation.cancel(),t.prototype.dispose.call(this)},e.prototype.onModelDecorationsChanged=function(){this._isVisible&&(this._hoverOperation.cancel(),this._computer.clearResult(),this._hoverOperation.start())},e.prototype.startShowingAt=function(t){this._lastLineNumber!==t&&(this._hoverOperation.cancel(),this.hide(),this._lastLineNumber=t,this._computer.setLineNumber(t),this._hoverOperation.start())},e.prototype.hide=function(){this._lastLineNumber=-1,this._hoverOperation.cancel(),t.prototype.hide.call(this)},e.prototype._withResult=function(t){this._messages=t,this._messages.length>0?this._renderMessages(this._lastLineNumber,this._messages):this.hide()},e.prototype._renderMessages=function(t,e){var o=document.createDocumentFragment();e.forEach(function(t){var e=document.createElement("div"),i=null;t.className?(i=document.createElement("span"),i.textContent=t.value,i.className=t.className,e.appendChild(i)):e.textContent=t.value,o.appendChild(e)}),this._domNode.textContent="",this._domNode.appendChild(o),this.showAt(t)},e.ID="editor.contrib.modesGlyphHoverWidget",e}(i.GlyphHoverWidget);e.ModesGlyphHoverWidget=s});