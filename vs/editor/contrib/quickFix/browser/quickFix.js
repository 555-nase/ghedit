var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},__decorate=this&&this.__decorate||function(e,t,i,o){var r,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(s=(n<3?r(s):n>3?r(t,i,s):r(t,i))||s);return n>3&&s&&Object.defineProperty(t,i,s),s},__param=this&&this.__param||function(e,t){return function(i,o){t(i,o,e)}};define(["require","exports","vs/nls","vs/base/common/errors","vs/base/common/keyCodes","vs/base/common/winjs.base","vs/platform/editor/common/editor","vs/platform/commands/common/commands","vs/platform/keybinding/common/keybinding","vs/platform/markers/common/markers","vs/platform/message/common/message","vs/platform/telemetry/common/telemetry","vs/editor/common/editorAction","vs/editor/common/editorCommonExtensions","vs/editor/common/modes","vs/editor/browser/editorBrowserExtensions","./quickFixModel","./quickFixSelectionWidget"],function(e,t,i,o,r,n,s,c,d,g,a,u,m,l,p,y,h,v){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";var f=function(){function e(e,t,i,o,r,n,s){var c=this;this._markerService=t,this._keybindingService=i,this._commandService=o,this.editor=e,this.model=new h.QuickFixModel(this.editor,this._markerService,this.onAccept.bind(this)),this.quickFixWidgetVisible=this._keybindingService.createKey(x,!1),this.suggestWidget=new v.QuickFixSelectionWidget(this.editor,r,function(){c.quickFixWidgetVisible.set(!0)},function(){c.quickFixWidgetVisible.reset()}),this.suggestWidget.setModel(this.model)}return e.getQuickFixController=function(t){return t.getContribution(e.ID)},e.prototype.getId=function(){return e.ID},e.prototype.onAccept=function(e,t){var i=this.editor.getModel();if(i){var r=e.command;return(n=this._commandService).executeCommand.apply(n,[r.id].concat(r.arguments)).done(void 0,o.onUnexpectedError)}var n},e.prototype.run=function(){return this.model.triggerDialog(!1,this.editor.getPosition()),this.editor.focus(),n.TPromise.as(!1)},e.prototype.dispose=function(){this.suggestWidget&&(this.suggestWidget.destroy(),this.suggestWidget=null),this.model&&(this.model.dispose(),this.model=null)},e.prototype.acceptSelectedSuggestion=function(){this.suggestWidget&&this.suggestWidget.acceptSelectedSuggestion()},e.prototype.closeWidget=function(){this.model&&this.model.cancelDialog()},e.prototype.selectNextSuggestion=function(){this.suggestWidget&&this.suggestWidget.selectNext()},e.prototype.selectNextPageSuggestion=function(){this.suggestWidget&&this.suggestWidget.selectNextPage()},e.prototype.selectPrevSuggestion=function(){this.suggestWidget&&this.suggestWidget.selectPrevious()},e.prototype.selectPrevPageSuggestion=function(){this.suggestWidget&&this.suggestWidget.selectPreviousPage()},e.ID="editor.contrib.quickFixController",e=__decorate([__param(1,g.IMarkerService),__param(2,d.IKeybindingService),__param(3,c.ICommandService),__param(4,u.ITelemetryService),__param(5,s.IEditorService),__param(6,a.IMessageService)],e)}();t.QuickFixController=f;var C=function(e){function t(t,i){e.call(this,t,i)}return __extends(t,e),t.prototype.isSupported=function(){var e=this.editor.getModel();return p.CodeActionProviderRegistry.has(e)&&!this.editor.getConfiguration().readOnly},t.prototype.run=function(){return f.getQuickFixController(this.editor).run()},t.ID="editor.action.quickFix",t}(m.EditorAction);t.QuickFixAction=C;var x="quickFixWidgetVisible",k=l.CommonEditorRegistry.commandWeight(80);l.CommonEditorRegistry.registerEditorAction(new l.EditorActionDescriptor(C,C.ID,i.localize("quickfix.trigger.label","Quick Fix"),{context:l.ContextKey.EditorTextFocus,primary:r.KeyMod.CtrlCmd|r.KeyCode.US_DOT},"Quick Fix")),l.CommonEditorRegistry.registerEditorCommand("acceptQuickFixSuggestion",k,{primary:r.KeyCode.Enter,secondary:[r.KeyCode.Tab]},!1,x,function(e,t,i){var o=f.getQuickFixController(t);o.acceptSelectedSuggestion()}),l.CommonEditorRegistry.registerEditorCommand("closeQuickFixWidget",k,{primary:r.KeyCode.Escape,secondary:[r.KeyMod.Shift|r.KeyCode.Escape]},!1,x,function(e,t,i){var o=f.getQuickFixController(t);o.closeWidget()}),l.CommonEditorRegistry.registerEditorCommand("selectNextQuickFix",k,{primary:r.KeyCode.DownArrow,mac:{primary:r.KeyCode.DownArrow,secondary:[r.KeyMod.WinCtrl|r.KeyCode.KEY_N]}},!1,x,function(e,t,i){var o=f.getQuickFixController(t);o.selectNextSuggestion()}),l.CommonEditorRegistry.registerEditorCommand("selectNextPageQuickFix",k,{primary:r.KeyCode.PageDown},!1,x,function(e,t,i){var o=f.getQuickFixController(t);o.selectNextPageSuggestion()}),l.CommonEditorRegistry.registerEditorCommand("selectPrevQuickFix",k,{primary:r.KeyCode.UpArrow,mac:{primary:r.KeyCode.UpArrow,secondary:[r.KeyMod.WinCtrl|r.KeyCode.KEY_P]}},!1,x,function(e,t,i){var o=f.getQuickFixController(t);o.selectPrevSuggestion()}),l.CommonEditorRegistry.registerEditorCommand("selectPrevPageQuickFix",k,{primary:r.KeyCode.PageUp},!1,x,function(e,t,i){var o=f.getQuickFixController(t);o.selectPrevPageSuggestion()}),y.EditorBrowserRegistry.registerEditorContribution(f)});