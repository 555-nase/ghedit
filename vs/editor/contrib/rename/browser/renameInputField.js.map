{"version":3,"sources":["vs/editor/contrib/rename/browser/renameInputField.ts"],"names":[],"mappings":"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","file":"vs/editor/contrib/rename/browser/renameInputField.js","sourceRoot":"file:///Users/darrin/src/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n'use strict';\n\nimport 'vs/css!./rename';\nimport {localize} from 'vs/nls';\nimport {canceled} from 'vs/base/common/errors';\nimport {IDisposable, dispose} from 'vs/base/common/lifecycle';\nimport {TPromise} from 'vs/base/common/winjs.base';\nimport {Range} from 'vs/editor/common/core/range';\nimport {EventType, IPosition, IRange} from 'vs/editor/common/editorCommon';\nimport {ContentWidgetPositionPreference, ICodeEditor, IContentWidget, IContentWidgetPosition} from 'vs/editor/browser/editorBrowser';\n\nexport default class RenameInputField implements IContentWidget, IDisposable {\n\n\tprivate _editor: ICodeEditor;\n\tprivate _position: IPosition;\n\tprivate _domNode: HTMLElement;\n\tprivate _inputField: HTMLInputElement;\n\tprivate _visible: boolean;\n\n\t// Editor.IContentWidget.allowEditorOverflow\n\tpublic allowEditorOverflow: boolean = true;\n\n\tconstructor(editor: ICodeEditor) {\n\t\tthis._editor = editor;\n\t\tthis._editor.addContentWidget(this);\n\t}\n\n\tpublic dispose(): void {\n\t\tthis._editor.removeContentWidget(this);\n\t}\n\n\tpublic getId(): string {\n\t\treturn '__renameInputWidget';\n\t}\n\n\tpublic getDomNode(): HTMLElement {\n\t\tif (!this._domNode) {\n\t\t\tthis._inputField = document.createElement('input');\n\t\t\tthis._inputField.className = 'rename-input';\n\t\t\tthis._inputField.type = 'text';\n\t\t\tthis._inputField.setAttribute('aria-label', localize('renameAriaLabel', \"Rename input. Type new name and press Enter to commit.\"));\n\t\t\tthis._domNode = document.createElement('div');\n\t\t\tthis._domNode.style.height = `${this._editor.getConfiguration().lineHeight}px`;\n\t\t\tthis._domNode.className = 'monaco-editor rename-box';\n\t\t\tthis._domNode.appendChild(this._inputField);\n\t\t}\n\t\treturn this._domNode;\n\t}\n\n\tpublic getPosition(): IContentWidgetPosition {\n\t\treturn this._visible\n\t\t\t? { position: this._position, preference: [ContentWidgetPositionPreference.BELOW, ContentWidgetPositionPreference.ABOVE] }\n\t\t\t: null;\n\t}\n\n\tprivate _currentAcceptInput: () => void = null;\n\tprivate _currentCancelInput: () => void = null;\n\n\tpublic acceptInput(): void {\n\t\tif (this._currentAcceptInput) {\n\t\t\tthis._currentAcceptInput();\n\t\t}\n\t}\n\n\tpublic cancelInput(): void {\n\t\tif (this._currentCancelInput) {\n\t\t\tthis._currentCancelInput();\n\t\t}\n\t}\n\n\tpublic getInput(where: IRange, value: string, selectionStart: number, selectionEnd: number): TPromise<string> {\n\n\t\tthis._position = { lineNumber: where.startLineNumber, column: where.startColumn };\n\t\tthis._inputField.value = value;\n\t\tthis._inputField.setAttribute('selectionStart', selectionStart.toString());\n\t\tthis._inputField.setAttribute('selectionEnd', selectionEnd.toString());\n\t\tthis._inputField.size = Math.max((where.endColumn - where.startColumn) * 1.1, 20);\n\n\t\tlet disposeOnDone: IDisposable[] = [],\n\t\t\talways: Function;\n\n\t\talways = () => {\n\t\t\tdispose(disposeOnDone);\n\t\t\tthis._hide();\n\t\t};\n\n\t\treturn new TPromise<string>((c, e) => {\n\n\t\t\tthis._currentCancelInput = () => {\n\t\t\t\tthis._currentAcceptInput = null;\n\t\t\t\tthis._currentCancelInput = null;\n\t\t\t\te(canceled());\n\t\t\t\treturn true;\n\t\t\t};\n\n\t\t\tthis._currentAcceptInput = () => {\n\t\t\t\tif (this._inputField.value.trim().length === 0 || this._inputField.value === value) {\n\t\t\t\t\t// empty or whitespace only or not changed\n\t\t\t\t\tthis._currentCancelInput();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis._currentAcceptInput = null;\n\t\t\t\tthis._currentCancelInput = null;\n\t\t\t\tc(this._inputField.value);\n\t\t\t};\n\n\t\t\tlet onCursorChanged = () => {\n\t\t\t\tif (!Range.containsPosition(where, this._editor.getPosition())) {\n\t\t\t\t\tthis._currentCancelInput();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tdisposeOnDone.push(this._editor.addListener2(EventType.CursorSelectionChanged, onCursorChanged));\n\t\t\tdisposeOnDone.push(this._editor.addListener2(EventType.EditorBlur, this._currentCancelInput));\n\n\t\t\tthis._show();\n\n\t\t}, this._currentCancelInput).then(newValue => {\n\t\t\talways();\n\t\t\treturn newValue;\n\t\t}, err => {\n\t\t\talways();\n\t\t\treturn TPromise.wrapError(err);\n\t\t});\n\t}\n\n\tprivate _show(): void {\n\t\tthis._editor.revealLineInCenterIfOutsideViewport(this._position.lineNumber);\n\t\tthis._visible = true;\n\t\tthis._editor.layoutContentWidget(this);\n\n\t\tsetTimeout(() => {\n\t\t\tthis._inputField.focus();\n\t\t\tthis._inputField.setSelectionRange(\n\t\t\t\tparseInt(this._inputField.getAttribute('selectionStart')),\n\t\t\t\tparseInt(this._inputField.getAttribute('selectionEnd')));\n\t\t}, 25);\n\t}\n\n\tprivate _hide(): void {\n\t\tthis._visible = false;\n\t\tthis._editor.layoutContentWidget(this);\n\t}\n}\n"]}