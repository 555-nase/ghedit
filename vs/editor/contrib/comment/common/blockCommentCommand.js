define(["require","exports","vs/editor/common/core/editOperation","vs/editor/common/core/position","vs/editor/common/core/range","vs/editor/common/core/selection","vs/editor/common/modes/languageConfigurationRegistry"],function(e,n,t,o,r,i,m){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";var a=function(){function e(e){this._selection=e,this._usedEndToken=null}return e._haystackHasNeedleAtOffset=function(e,n,t){if(t<0)return!1;var o=n.length,r=e.length;if(t+o>r)return!1;for(var i=0;i<o;i++)if(e.charCodeAt(t+i)!==n.charCodeAt(i))return!1;return!0},e.prototype._createOperationsForBlockComment=function(n,t,o,r){var i,m=n.startLineNumber,a=n.startColumn,u=n.endLineNumber,s=n.endColumn,d=t.blockCommentStartToken,l=t.blockCommentEndToken,c=o.getLineContent(m).lastIndexOf(d,a-1+d.length),C=o.getLineContent(u).indexOf(l,s-1-l.length);c!==-1&&C!==-1?i=e._createRemoveBlockCommentOperations({startLineNumber:m,startColumn:c+1+d.length,endLineNumber:u,endColumn:C+1},d,l):(i=e._createAddBlockCommentOperations(n,d,l),this._usedEndToken=1===i.length?l:null);for(var g=0;g<i.length;g++)r.addEditOperation(i[g].range,i[g].text)},e._createRemoveBlockCommentOperations=function(e,n,o){var i=[];return r.Range.isEmpty(e)?i.push(t.EditOperation["delete"](new r.Range(e.startLineNumber,e.startColumn-n.length,e.endLineNumber,e.endColumn+o.length))):(i.push(t.EditOperation["delete"](new r.Range(e.startLineNumber,e.startColumn-n.length,e.startLineNumber,e.startColumn))),i.push(t.EditOperation["delete"](new r.Range(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn+o.length)))),i},e._createAddBlockCommentOperations=function(e,n,i){var m=[];return r.Range.isEmpty(e)?m.push(t.EditOperation.replace(new r.Range(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn),n+i)):(m.push(t.EditOperation.insert(new o.Position(e.startLineNumber,e.startColumn),n)),m.push(t.EditOperation.insert(new o.Position(e.endLineNumber,e.endColumn),i))),m},e.prototype.getEditOperations=function(e,n){var t=this._selection.startLineNumber,o=this._selection.startColumn,r=this._selection.endLineNumber,i=this._selection.endColumn,a=e.getModeIdAtPosition(t,o),u=m.LanguageConfigurationRegistry.getComments(a);u&&u.blockCommentStartToken&&u.blockCommentEndToken&&this._createOperationsForBlockComment({startLineNumber:t,startColumn:o,endLineNumber:r,endColumn:i},u,e,n)},e.prototype.computeCursorState=function(e,n){var t=n.getInverseEditOperations();if(2===t.length){var o=t[0],r=t[1];return new i.Selection(o.range.endLineNumber,o.range.endColumn,r.range.startLineNumber,r.range.startColumn)}var m=t[0].range,a=this._usedEndToken?-this._usedEndToken.length:0;return new i.Selection(m.endLineNumber,m.endColumn+a,m.endLineNumber,m.endColumn+a)},e}();n.BlockCommentCommand=a});