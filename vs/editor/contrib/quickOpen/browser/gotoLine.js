/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define(["require","exports","vs/nls","vs/base/parts/quickopen/browser/quickOpenModel","vs/base/parts/quickopen/common/quickOpen","vs/editor/common/editorCommon","./editorQuickOpen","vs/css!./gotoLine"],function(e,t,o,n,i,r,l){"use strict";var u=function(e){function t(t,o,n){e.call(this),this.editor=o,this.decorator=n,this._parseResult=this._parseInput(t)}return __extends(t,e),t.prototype._parseInput=function(e){var t,n=e.split(",").map(function(e){return parseInt(e,10)}).filter(function(e){return!isNaN(e)});t=0===n.length?{lineNumber:-1,column:-1}:1===n.length?{lineNumber:n[0],column:1}:{lineNumber:n[0],column:n[1]};var i,l=this.editor.getEditorType();switch(l){case r.EditorType.IDiffEditor:i=this.editor.getModel().modified;break;case r.EditorType.ICodeEditor:i=this.editor.getModel();break;default:throw new Error}var u,s=i.validatePosition(t).equals(t);return u=s?t.column&&t.column>1?o.localize("gotoLineLabelValidLineAndColumn","Go to line {0} and column {1}",t.lineNumber,t.column):o.localize("gotoLineLabelValidLine","Go to line {0}",t.lineNumber,t.column):t.lineNumber<1||t.lineNumber>i.getLineCount()?o.localize("gotoLineLabelEmptyWithLineLimit","Type a line number between 1 and {0} to navigate to",i.getLineCount()):o.localize("gotoLineLabelEmptyWithLineAndColumnLimit","Type a column between 1 and {0} to navigate to",i.getLineMaxColumn(t.lineNumber)),{position:t,isValid:s,label:u}},t.prototype.getLabel=function(){return this._parseResult.label},t.prototype.getAriaLabel=function(){return o.localize("gotoLineAriaLabel","Go to line {0}",this._parseResult.label)},t.prototype.run=function(e,t){return e===i.Mode.OPEN?this.runOpen():this.runPreview()},t.prototype.runOpen=function(){if(!this._parseResult.isValid)return!1;var e=this.toSelection();return this.editor.setSelection(e),this.editor.revealRangeInCenter(e),this.editor.focus(),!0},t.prototype.runPreview=function(){if(!this._parseResult.isValid)return this.decorator.clearDecorations(),!1;var e=this.toSelection();return this.editor.revealRangeInCenter(e),this.decorator.decorateLine(e,this.editor),!1},t.prototype.toSelection=function(){return{startLineNumber:this._parseResult.position.lineNumber,startColumn:this._parseResult.position.column,endLineNumber:this._parseResult.position.lineNumber,endColumn:this._parseResult.position.column}},t}(n.QuickOpenEntry);t.GotoLineEntry=u;var s=function(e){function t(t,n){e.call(this,t,n,o.localize("GotoLineAction.label","Go to Line..."))}return __extends(t,e),t.prototype._getModel=function(e){return new n.QuickOpenModel([new u(e,this.editor,this)])},t.prototype._getAutoFocus=function(e){return{autoFocusFirstEntry:e.length>0}},t.prototype._getInputAriaLabel=function(){return o.localize("gotoLineActionInput","Type a line number, followed by an optional colon and a column number to navigate to")},t.ID="editor.action.gotoLine",t}(l.BaseEditorQuickOpenAction);t.GotoLineAction=s});