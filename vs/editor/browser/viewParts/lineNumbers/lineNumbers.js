/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};define(["require","exports","vs/base/common/platform","vs/editor/browser/view/dynamicViewOverlay","vs/editor/browser/editorBrowser","vs/css!./lineNumbers"],function(e,t,n,r,i){"use strict";var o=function(e){function t(t){e.call(this),this._context=t,this._lineHeight=this._context.configuration.editor.lineHeight,this._lineNumbers=this._context.configuration.editor.viewInfo.lineNumbers,this._lineNumbersLeft=0,this._lineNumbersWidth=0,this._renderResult=null,this._context.addEventHandler(this)}return __extends(t,e),t.prototype.dispose=function(){this._context.removeEventHandler(this),this._context=null,this._renderResult=null},t.prototype.onModelFlushed=function(){return!0},t.prototype.onModelDecorationsChanged=function(e){return!1},t.prototype.onModelLinesDeleted=function(e){return!0},t.prototype.onModelLineChanged=function(e){return!0},t.prototype.onModelLinesInserted=function(e){return!0},t.prototype.onCursorPositionChanged=function(e){return!1},t.prototype.onCursorSelectionChanged=function(e){return!1},t.prototype.onCursorRevealRange=function(e){return!1},t.prototype.onConfigurationChanged=function(e){return e.lineHeight&&(this._lineHeight=this._context.configuration.editor.lineHeight),e.viewInfo.lineNumbers&&(this._lineNumbers=this._context.configuration.editor.viewInfo.lineNumbers),!0},t.prototype.onLayoutChanged=function(e){return this._lineNumbersLeft=e.lineNumbersLeft,this._lineNumbersWidth=e.lineNumbersWidth,!0},t.prototype.onScrollChanged=function(e){return e.scrollTopChanged},t.prototype.onZonesChanged=function(){return!0},t.prototype.prepareRender=function(e){if(!this.shouldRender())throw new Error("I did not ask to render!");if(!this._lineNumbers)return void(this._renderResult=null);for(var t=n.isLinux?this._lineHeight%2===0?" lh-even":" lh-odd":"",r=this._lineHeight.toString(),o=e.visibleRange.startLineNumber,s=e.visibleRange.endLineNumber,u='<div class="'+i.ClassNames.LINE_NUMBERS+t+'" style="left:'+this._lineNumbersLeft.toString()+"px;width:"+this._lineNumbersWidth.toString()+"px;height:"+r+'px;">',l=[],h=o;h<=s;h++){var d=h-o,c=this._context.model.getLineRenderLineNumber(h);c?l[d]=u+c+"</div>":l[d]=""}this._renderResult=l},t.prototype.render=function(e,t){if(!this._renderResult)return"";var n=t-e;if(n<0||n>=this._renderResult.length)throw new Error("Unexpected render request");return this._renderResult[n]},t}(r.DynamicViewOverlay);t.LineNumbersOverlay=o});