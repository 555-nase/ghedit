/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)};define(["require","exports","vs/editor/browser/view/dynamicViewOverlay","vs/css!./currentLineHighlight"],function(t,e,i){"use strict";var n=function(t){function e(e,i){t.call(this),this._context=e,this._lineHeight=this._context.configuration.editor.lineHeight,this._readOnly=this._context.configuration.editor.readOnly,this._layoutProvider=i,this._selectionIsEmpty=!0,this._primaryCursorIsInEditableRange=!0,this._primaryCursorLineNumber=1,this._scrollWidth=this._layoutProvider.getScrollWidth(),this._contentWidth=this._context.configuration.editor.layoutInfo.contentWidth,this._context.addEventHandler(this)}return __extends(e,t),e.prototype.dispose=function(){this._context.removeEventHandler(this),this._context=null},e.prototype.onModelFlushed=function(){return this._primaryCursorIsInEditableRange=!0,this._selectionIsEmpty=!0,this._primaryCursorLineNumber=1,this._scrollWidth=this._layoutProvider.getScrollWidth(),!0},e.prototype.onModelLinesDeleted=function(t){return!0},e.prototype.onModelLinesInserted=function(t){return!0},e.prototype.onCursorPositionChanged=function(t){var e=!1;return this._primaryCursorIsInEditableRange!==t.isInEditableRange&&(this._primaryCursorIsInEditableRange=t.isInEditableRange,e=!0),this._primaryCursorLineNumber!==t.position.lineNumber&&(this._primaryCursorLineNumber=t.position.lineNumber,e=!0),e},e.prototype.onCursorSelectionChanged=function(t){var e=t.selection.isEmpty();return this._selectionIsEmpty!==e&&(this._selectionIsEmpty=e,!0)},e.prototype.onConfigurationChanged=function(t){return t.lineHeight&&(this._lineHeight=this._context.configuration.editor.lineHeight),t.readOnly&&(this._readOnly=this._context.configuration.editor.readOnly),t.layoutInfo&&(this._contentWidth=this._context.configuration.editor.layoutInfo.contentWidth),!0},e.prototype.onLayoutChanged=function(t){return!0},e.prototype.onScrollChanged=function(t){return this._scrollWidth=t.scrollWidth,t.scrollWidthChanged},e.prototype.onZonesChanged=function(){return!0},e.prototype.prepareRender=function(t){if(!this.shouldRender())throw new Error("I did not ask to render!");this._scrollWidth=t.scrollWidth},e.prototype.render=function(t,e){return e===this._primaryCursorLineNumber&&this._shouldShowCurrentLine()?'<div class="current-line" style="width:'+String(Math.max(this._scrollWidth,this._contentWidth))+"px; height:"+String(this._lineHeight)+'px;"></div>':""},e.prototype._shouldShowCurrentLine=function(){return this._selectionIsEmpty&&this._primaryCursorIsInEditableRange&&!this._readOnly},e}(i.DynamicViewOverlay);e.CurrentLineHighlightOverlay=n});