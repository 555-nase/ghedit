define(["require","exports","vs/base/common/async","vs/base/common/winjs.base","vs/editor/common/viewLayout/viewLineRenderer","vs/editor/common/core/viewLineToken"],function(e,n,t,o,r,i){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";function u(e,n,t){var o,u,c,a,d,s=n.tokenizationSupport,f=[],l=s.getInitialState(),v=[];for(o=0,u=e.length;o<u;o++)c=e[o],a=s.tokenize(c,l),a.retokenize&&v.push(a.retokenize),d=r.renderLine(new r.RenderLineInput(c,t,0,(-1),(!1),(!1),a.tokens.map(function(e){return new i.ViewLineToken(e.startIndex,e.type)}))),f=f.concat(d.output),f.push("<br/>"),l=a.endState;return{result:f.join(""),retokenize:v}}var c=function(){function e(){}return e.colorizeElement=function(e,n,t){t=t||{};var o=t.theme||"vs",r=t.mimeType||n.getAttribute("lang")||n.getAttribute("data-lang");if(!r)return void console.error("Mode not detected");var i=n.firstChild.nodeValue;n.className+="monaco-editor "+o;var u=function(e){n.innerHTML=e};return this.colorize(e,i,r,t).then(u,function(e){return console.error(e)},u)},e.colorize=function(e,n,r,i){i=i||{},"undefined"==typeof i.tabSize&&(i.tabSize=4);var c,a,d,s,f=n.split("\n"),l=!1,v=new o.TPromise(function(e,n,t){c=e,a=n,d=t},function(){l=!0}),z=new t.RunOnceScheduler(function(){if(!l){var e=u(f,s,i.tabSize);e.retokenize.length>0?(e.retokenize.forEach(function(e){return e.then(p)}),d(e.result)):c(e.result)}},0),p=function(){return z.schedule()};return e.getOrCreateMode(r).then(function(e){return e?e.tokenizationSupport?(s=e,void p()):void a('Mode found ("'+e.getId()+'"), but does not support tokenization.'):void a('Mode not found: "'+r+'".')}),v},e.colorizeLine=function(e,n,t){void 0===t&&(t=4);var o=r.renderLine(new r.RenderLineInput(e,t,0,(-1),(!1),(!1),n));return o.output},e.colorizeModelLine=function(e,n,t){void 0===t&&(t=4);var o=e.getLineContent(n),r=e.getLineTokens(n,!1),i=r.inflate();return this.colorizeLine(o,i,t)},e}();n.Colorizer=c});