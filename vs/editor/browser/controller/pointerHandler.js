var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define(["require","exports","vs/base/browser/dom","vs/base/browser/touch","vs/editor/browser/controller/mouseHandler","vs/editor/browser/editorDom"],function(e,t,o,n,i,r){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";var s=function(e,t){var o={translationY:t.translationY,translationX:t.translationX};return e&&(o.translationY+=e.translationY,o.translationX+=e.translationX),o},l=function(e){function t(t,n,i){var r=this;e.call(this,t,n,i),this.viewHelper.linesContentDomNode.style.msTouchAction="none",this.viewHelper.linesContentDomNode.style.msContentZooming="none",this._installGestureHandlerTimeout=window.setTimeout(function(){if(r._installGestureHandlerTimeout=-1,window.MSGesture){var e=new MSGesture,t=new MSGesture;e.target=r.viewHelper.linesContentDomNode,t.target=r.viewHelper.linesContentDomNode,r.viewHelper.linesContentDomNode.addEventListener("MSPointerDown",function(o){var n=o.pointerType;return n===(o.MSPOINTER_TYPE_MOUSE||"mouse")?void(r._lastPointerType="mouse"):void(n===(o.MSPOINTER_TYPE_TOUCH||"touch")?(r._lastPointerType="touch",e.addPointer(o.pointerId)):(r._lastPointerType="pen",t.addPointer(o.pointerId)))}),r.listenersToRemove.push(o.addDisposableThrottledListener(r.viewHelper.linesContentDomNode,"MSGestureChange",function(e){return r._onGestureChange(e)},s)),r.listenersToRemove.push(o.addDisposableListener(r.viewHelper.linesContentDomNode,"MSGestureTap",function(e){return r._onCaptureGestureTap(e)},!0))}},100),this._lastPointerType="mouse"}return __extends(t,e),t.prototype._onMouseDown=function(t){"mouse"===this._lastPointerType&&e.prototype._onMouseDown.call(this,t)},t.prototype._onCaptureGestureTap=function(e){var t=this,o=new r.EditorMouseEvent(e,this.viewHelper.viewDomNode),n=this._createMouseTarget(o,!1);n.position&&this.viewController.moveTo("mouse",n.position),o.browserEvent.fromElement?(o.preventDefault(),this.viewHelper.focusTextArea()):setTimeout(function(){t.viewHelper.focusTextArea()})},t.prototype._onGestureChange=function(e){this.viewHelper.setScrollPosition({scrollLeft:this.viewHelper.getScrollLeft()-e.translationX,scrollTop:this.viewHelper.getScrollTop()-e.translationY})},t.prototype.dispose=function(){window.clearTimeout(this._installGestureHandlerTimeout),e.prototype.dispose.call(this)},t}(i.MouseHandler),a=function(e){function t(t,n,i){var r=this;e.call(this,t,n,i),this.viewHelper.linesContentDomNode.style.touchAction="none",this._installGestureHandlerTimeout=window.setTimeout(function(){if(r._installGestureHandlerTimeout=-1,window.MSGesture){var e=new MSGesture,t=new MSGesture;e.target=r.viewHelper.linesContentDomNode,t.target=r.viewHelper.linesContentDomNode,r.viewHelper.linesContentDomNode.addEventListener("pointerdown",function(o){var n=o.pointerType;return"mouse"===n?void(r._lastPointerType="mouse"):void("touch"===n?(r._lastPointerType="touch",e.addPointer(o.pointerId)):(r._lastPointerType="pen",t.addPointer(o.pointerId)))}),r.listenersToRemove.push(o.addDisposableThrottledListener(r.viewHelper.linesContentDomNode,"MSGestureChange",function(e){return r._onGestureChange(e)},s)),r.listenersToRemove.push(o.addDisposableListener(r.viewHelper.linesContentDomNode,"MSGestureTap",function(e){return r._onCaptureGestureTap(e)},!0))}},100),this._lastPointerType="mouse"}return __extends(t,e),t.prototype._onMouseDown=function(t){"mouse"===this._lastPointerType&&e.prototype._onMouseDown.call(this,t)},t.prototype._onCaptureGestureTap=function(e){var t=this,o=new r.EditorMouseEvent(e,this.viewHelper.viewDomNode),n=this._createMouseTarget(o,!1);n.position&&this.viewController.moveTo("mouse",n.position),o.browserEvent.fromElement?(o.preventDefault(),this.viewHelper.focusTextArea()):setTimeout(function(){t.viewHelper.focusTextArea()})},t.prototype._onGestureChange=function(e){this.viewHelper.setScrollPosition({scrollLeft:this.viewHelper.getScrollLeft()-e.translationX,scrollTop:this.viewHelper.getScrollTop()-e.translationY})},t.prototype.dispose=function(){window.clearTimeout(this._installGestureHandlerTimeout),e.prototype.dispose.call(this)},t}(i.MouseHandler),p=function(e){function t(t,i,s){var l=this;e.call(this,t,i,s),this.gesture=new n.Gesture(this.viewHelper.linesContentDomNode),this.listenersToRemove.push(o.addDisposableListener(this.viewHelper.linesContentDomNode,n.EventType.Tap,function(e){return l.onTap(e)})),this.listenersToRemove.push(o.addDisposableListener(this.viewHelper.linesContentDomNode,n.EventType.Change,function(e){return l.onChange(e)})),this.listenersToRemove.push(o.addDisposableListener(this.viewHelper.linesContentDomNode,n.EventType.Contextmenu,function(e){return l._onContextMenu(new r.EditorMouseEvent(e,l.viewHelper.viewDomNode),!1)}))}return __extends(t,e),t.prototype.dispose=function(){this.gesture.dispose(),e.prototype.dispose.call(this)},t.prototype.onTap=function(e){e.preventDefault(),this.viewHelper.focusTextArea();var t=this._createMouseTarget(new r.EditorMouseEvent(e,this.viewHelper.viewDomNode),!1);t.position&&this.viewController.moveTo("mouse",t.position)},t.prototype.onChange=function(e){this.viewHelper.setScrollPosition({scrollLeft:this.viewHelper.getScrollLeft()-e.translationX,scrollTop:this.viewHelper.getScrollTop()-e.translationY})},t}(i.MouseHandler),u=function(){function e(e,t,o){window.navigator.msPointerEnabled?this.handler=new l(e,t,o):window.TouchEvent?this.handler=new p(e,t,o):window.navigator.pointerEnabled?this.handler=new a(e,t,o):this.handler=new i.MouseHandler(e,t,o)}return e.prototype.onScrollChanged=function(e){this.handler.onScrollChanged(e)},e.prototype.dispose=function(){this.handler.dispose()},e}();t.PointerHandler=u});