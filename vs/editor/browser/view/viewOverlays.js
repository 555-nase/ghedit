var __extends=this&&this.__extends||function(t,e){function o(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)};define(["require","exports","vs/base/browser/styleMutator","vs/editor/browser/editorBrowser","vs/editor/browser/view/viewLayer","vs/editor/browser/config/configuration"],function(t,e,o,i,n,r){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";var s=function(t){function e(e,o){t.call(this,e),this._dynamicOverlays=[],this._isFocused=!1,this._layoutProvider=o,this.domNode.setClassName("view-overlays")}return __extends(e,t),e.prototype.shouldRender=function(){if(t.prototype.shouldRender.call(this))return!0;for(var e=0,o=this._dynamicOverlays.length;e<o;e++){var i=this._dynamicOverlays[e];if(i.shouldRender())return!0}return!1},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._layoutProvider=null;for(var e=0,o=this._dynamicOverlays.length;e<o;e++){var i=this._dynamicOverlays[e];i.dispose()}this._dynamicOverlays=null},e.prototype.getDomNode=function(){return this.domNode.domNode},e.prototype.addDynamicOverlay=function(t){this._dynamicOverlays.push(t)},e.prototype.onViewFocusChanged=function(t){return this._isFocused=t,!0},e.prototype._createLine=function(){var t=new h(this._context,this._dynamicOverlays);return t},e.prototype.prepareRender=function(t){for(var e=this._dynamicOverlays.filter(function(t){return t.shouldRender()}),o=0,i=e.length;o<i;o++){var n=e[o];n.prepareRender(t),n.onDidRender()}return null},e.prototype.render=function(t){this._viewOverlaysRender(t),this.domNode.toggleClassName("focused",this._isFocused)},e.prototype._viewOverlaysRender=function(e){t.prototype._renderLines.call(this,e.linesViewportData)},e}(n.ViewLayer);e.ViewOverlays=s;var h=function(){function t(t,e){this._context=t,this._lineHeight=this._context.configuration.editor.lineHeight,this._dynamicOverlays=e,this._domNode=null,this._renderPieces=null}return t.prototype.getDomNode=function(){return this._domNode?this._domNode.domNode:null},t.prototype.setDomNode=function(t){this._domNode=o.createFastDomNode(t)},t.prototype.onContentChanged=function(){},t.prototype.onLinesInsertedAbove=function(){},t.prototype.onLinesDeletedAbove=function(){},t.prototype.onLineChangedAbove=function(){},t.prototype.onTokensChanged=function(){},t.prototype.onConfigurationChanged=function(t){t.lineHeight&&(this._lineHeight=this._context.configuration.editor.lineHeight)},t.prototype.shouldUpdateHTML=function(t,e,o){for(var i="",n=0,r=this._dynamicOverlays.length;n<r;n++){var s=this._dynamicOverlays[n];i+=s.render(t,e)}var h=this._renderPieces===i;return h||(this._renderPieces=i),!h},t.prototype.getLineOuterHTML=function(t,e,o){t.push('<div lineNumber="'),t.push(e.toString()),t.push('" style="top:'),t.push(o.toString()),t.push("px;height:"),t.push(this._lineHeight.toString()),t.push('px;" class="'),t.push(i.ClassNames.VIEW_LINE),t.push('">'),t.push(this.getLineInnerHTML(e)),t.push("</div>")},t.prototype.getLineInnerHTML=function(t){return this._renderPieces},t.prototype.layoutLine=function(t,e){this._domNode.setLineNumber(String(t)),this._domNode.setTop(e),this._domNode.setHeight(this._lineHeight)},t}();e.ViewOverlayLine=h;var a=function(t){function e(e,o){t.call(this,e,o),this._scrollWidth=this._layoutProvider.getScrollWidth(),this._contentWidth=this._context.configuration.editor.layoutInfo.contentWidth,this.domNode.setWidth(this._scrollWidth),this.domNode.setHeight(0)}return __extends(e,t),e.prototype.onConfigurationChanged=function(e){return e.layoutInfo&&(this._contentWidth=this._context.configuration.editor.layoutInfo.contentWidth),t.prototype.onConfigurationChanged.call(this,e)},e.prototype.onScrollChanged=function(e){return this._scrollWidth=e.scrollWidth,t.prototype.onScrollChanged.call(this,e)||e.scrollWidthChanged},e.prototype._viewOverlaysRender=function(e){t.prototype._viewOverlaysRender.call(this,e),this.domNode.setWidth(Math.max(this._scrollWidth,this._contentWidth))},e}(s);e.ContentViewOverlays=a;var d=function(t){function e(e,o){t.call(this,e,o),this._glyphMarginLeft=e.configuration.editor.layoutInfo.glyphMarginLeft,this._glyphMarginWidth=e.configuration.editor.layoutInfo.glyphMarginWidth,this._scrollHeight=o.getScrollHeight(),this._contentLeft=e.configuration.editor.layoutInfo.contentLeft,this._canUseTranslate3d=e.configuration.editor.viewInfo.canUseTranslate3d,this.domNode.setClassName(i.ClassNames.MARGIN_VIEW_OVERLAYS+" monaco-editor-background"),this.domNode.setWidth(1),r.Configuration.applyFontInfo(this.domNode,this._context.configuration.editor.fontInfo)}return __extends(e,t),e.prototype._extraDomNodeHTML=function(){return['<div class="',i.ClassNames.GLYPH_MARGIN,'" style="left:',String(this._glyphMarginLeft),"px;width:",String(this._glyphMarginWidth),"px;height:",String(this._scrollHeight),'px;"></div>'].join("")},e.prototype._getGlyphMarginDomNode=function(){return this.domNode.domNode.children[0]},e.prototype.onScrollChanged=function(e){return this._scrollHeight=e.scrollHeight,t.prototype.onScrollChanged.call(this,e)||e.scrollHeightChanged},e.prototype.onLayoutChanged=function(e){return this._glyphMarginLeft=e.glyphMarginLeft,this._glyphMarginWidth=e.glyphMarginWidth,this._scrollHeight=this._layoutProvider.getScrollHeight(),this._contentLeft=e.contentLeft,t.prototype.onLayoutChanged.call(this,e)||!0},e.prototype.onConfigurationChanged=function(e){return e.fontInfo&&r.Configuration.applyFontInfo(this.domNode,this._context.configuration.editor.fontInfo),e.viewInfo.canUseTranslate3d&&(this._canUseTranslate3d=this._context.configuration.editor.viewInfo.canUseTranslate3d),t.prototype.onConfigurationChanged.call(this,e)},e.prototype._viewOverlaysRender=function(e){if(t.prototype._viewOverlaysRender.call(this,e),this._canUseTranslate3d){var i="translate3d(0px, "+e.linesViewportData.visibleRangesDeltaTop+"px, 0px)";this.domNode.setTransform(i),this.domNode.setTop(0)}else this.domNode.setTransform(""),this.domNode.setTop(e.linesViewportData.visibleRangesDeltaTop);var n=Math.min(this._layoutProvider.getTotalHeight(),1e6);this.domNode.setHeight(n),this.domNode.setWidth(this._contentLeft);var r=this._getGlyphMarginDomNode();r&&(o.StyleMutator.setHeight(r,this._scrollHeight),o.StyleMutator.setLeft(r,this._glyphMarginLeft),o.StyleMutator.setWidth(r,this._glyphMarginWidth))},e}(s);e.MarginViewOverlays=d});