define(["require","exports","vs/base/common/strings","vs/editor/common/core/editOperation","vs/editor/common/core/range"],function(e,t,n,i,r){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";function o(e,t){t.sort(function(e,t){return e.lineNumber===t.lineNumber?e.column-t.column:e.lineNumber-t.lineNumber});for(var o=t.length-2;o>=0;o--)t[o].lineNumber===t[o+1].lineNumber&&t.splice(o,1);var c,l,u,s,a,m,g,d=[],h=0,p=t.length;for(c=1,l=e.getLineCount();c<=l;c++)if(u=e.getLineContent(c),a=u.length+1,s=0,!(h<p&&t[h].lineNumber===c&&(s=t[h].column,h++,s===a))&&0!==u.length){if(g=n.lastNonWhitespaceIndex(u),m=0,g===-1)m=1;else{if(g===u.length-1)continue;m=g+2}m=Math.max(s,m),d.push(i.EditOperation["delete"](new r.Range(c,m,c,a)))}return d}var c=function(){function e(e){this.selection=e}return e.prototype.getEditOperations=function(e,t){for(var n=o(e,[]),i=0,r=n.length;i<r;i++){var c=n[i];t.addEditOperation(c.range,c.text)}this.selectionId=t.trackSelection(this.selection)},e.prototype.computeCursorState=function(e,t){return t.getTrackedSelection(this.selectionId)},e}();t.TrimTrailingWhitespaceCommand=c,t.trimTrailingWhitespace=o});