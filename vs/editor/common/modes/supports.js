define(["require","exports","vs/editor/common/core/modeTransition"],function(t,e,n){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";function o(t,e,o){var r=t.modeTransitions;if(1===r.length)return o(r[0].modeId,t,e);var i=n.ModeTransition.findIndexInSegmentsArray(r,e),s=r[i].mode,d=r[i].startIndex,a=t.findIndexOfOffset(d),u=-1,h=-1;i+1<r.length?(h=t.findIndexOfOffset(r[i+1].startIndex),u=t.getTokenStartIndex(h)):(h=t.getTokenCount(),u=t.getLineContent().length);var T=t.getTokenStartIndex(a),c=new f(t,s,a,h,T,u);return o(s.getId(),c,e-T)}function r(t){return d.test(t)}var i=function(){function t(t,e){this.startIndex=t,this.type=e}return t.prototype.toString=function(){return"("+this.startIndex+", "+this.type+")"},t}();e.Token=i;var s=function(){function t(t,e,n,o){this.tokens=t,this.modeTransitions=e,this.actualStopOffset=n,this.endState=o,this.retokenize=null}return t}();e.LineTokens=s,e.handleEvent=o;var f=function(){function t(t,e,o,r,i,s){this.modeTransitions=[new n.ModeTransition(0,e)],this._actual=t,this._firstTokenInModeIndex=o,this._nextTokenAfterMode=r,this._firstTokenCharacterOffset=i,this._nextCharacterAfterModeIndex=s}return t.prototype.getLineContent=function(){var t=this._actual.getLineContent();return t.substring(this._firstTokenCharacterOffset,this._nextCharacterAfterModeIndex)},t.prototype.getTokenCount=function(){return this._nextTokenAfterMode-this._firstTokenInModeIndex},t.prototype.findIndexOfOffset=function(t){return this._actual.findIndexOfOffset(t+this._firstTokenCharacterOffset)-this._firstTokenInModeIndex},t.prototype.getTokenStartIndex=function(t){return this._actual.getTokenStartIndex(t+this._firstTokenInModeIndex)-this._firstTokenCharacterOffset},t.prototype.getTokenEndIndex=function(t){return this._actual.getTokenEndIndex(t+this._firstTokenInModeIndex)-this._firstTokenCharacterOffset},t.prototype.getTokenType=function(t){return this._actual.getTokenType(t+this._firstTokenInModeIndex)},t.prototype.getTokenText=function(t){return this._actual.getTokenText(t+this._firstTokenInModeIndex)},t}();e.FilteredLineContext=f;var d=/\b(comment|string|regex)\b/;e.ignoreBracketsInToken=r});