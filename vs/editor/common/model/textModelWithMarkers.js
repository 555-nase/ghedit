var __extends=this&&this.__extends||function(r,e){function t(){this.constructor=r}for(var o in e)e.hasOwnProperty(o)&&(r[o]=e[o]);r.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)};define(["require","exports","vs/base/common/idGenerator","vs/editor/common/core/position","vs/editor/common/model/textModelWithTokens"],function(r,e,t,o,n){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";var i=function(){function r(r,e,t){this.id=r,this.column=e,this.stickToPreviousCharacter=t,this.oldLineNumber=0,this.oldColumn=0,this.line=null}return r.prototype.toString=function(){return"{'"+this.id+"';"+this.column+","+this.stickToPreviousCharacter+",["+this.oldLineNumber+","+this.oldColumn+"]}"},r}();e.LineMarker=i;var a=0,s=function(r){function e(e,o,n){r.call(this,e,o,n),this._markerIdGenerator=new t.IdGenerator(++a+";"),this._markerIdToMarker={}}return __extends(e,r),e.prototype.dispose=function(){this._markerIdToMarker=null,r.prototype.dispose.call(this)},e.prototype._resetValue=function(e,t){r.prototype._resetValue.call(this,e,t),this._markerIdToMarker={}},e.prototype._addMarker=function(r,e,t){var n=this.validatePosition(new o.Position(r,e)),a=new i(this._markerIdGenerator.nextId(),n.column,t);return this._markerIdToMarker[a.id]=a,this._lines[n.lineNumber-1].addMarker(a),a.id},e.prototype._addMarkers=function(r){for(var e=Object.create(null),t=[],o=0,n=r.length;o<n;o++){var a=r[o],s=new i(this._markerIdGenerator.nextId(),a.column,a.stickToPreviousCharacter);this._markerIdToMarker[s.id]=s,e[a.lineNumber]||(e[a.lineNumber]=[]),e[a.lineNumber].push(s),t.push(s.id)}for(var h=Object.keys(e),o=0,n=h.length;o<n;o++){var k=parseInt(h[o],10);this._lines[k-1].addMarkers(e[h[o]])}return t},e.prototype._changeMarker=function(r,e,t){if(this._markerIdToMarker.hasOwnProperty(r)){var n=this._markerIdToMarker[r],i=this.validatePosition(new o.Position(e,t));i.lineNumber!==n.line.lineNumber&&(n.line.removeMarker(n),this._lines[i.lineNumber-1].addMarker(n)),n.column=i.column}},e.prototype._changeMarkerStickiness=function(r,e){if(this._markerIdToMarker.hasOwnProperty(r)){var t=this._markerIdToMarker[r];t.stickToPreviousCharacter!==e&&(t.stickToPreviousCharacter=e)}},e.prototype._getMarker=function(r){if(this._markerIdToMarker.hasOwnProperty(r)){var e=this._markerIdToMarker[r];return new o.Position(e.line.lineNumber,e.column)}return null},e.prototype._getMarkersCount=function(){return Object.keys(this._markerIdToMarker).length},e.prototype._getLineMarkers=function(r){if(r<1||r>this.getLineCount())throw new Error("Illegal value "+r+" for `lineNumber`");return this._lines[r-1].getMarkers()},e.prototype._removeMarker=function(r){if(this._markerIdToMarker.hasOwnProperty(r)){var e=this._markerIdToMarker[r];e.line.removeMarker(e),delete this._markerIdToMarker[r]}},e.prototype._removeMarkers=function(r){for(var e=Object.create(null),t=0,o=r.length;t<o;t++){var n=r[t];if(this._markerIdToMarker.hasOwnProperty(n)){var i=this._markerIdToMarker[n],a=i.line.lineNumber;e[a]||(e[a]=Object.create(null)),e[a][n]=!0,delete this._markerIdToMarker[n]}}for(var s=Object.keys(e),t=0,o=s.length;t<o;t++){var a=parseInt(s[t],10);this._lines[a-1].removeMarkers(e[s[t]])}},e.prototype._getMarkersInMap=function(r){for(var e=[],t=Object.keys(r),o=0,n=t.length;o<n;o++){var i=t[o];this._markerIdToMarker.hasOwnProperty(i)&&e.push(this._markerIdToMarker[i])}return e},e}(n.TextModelWithTokens);e.TextModelWithMarkers=s});