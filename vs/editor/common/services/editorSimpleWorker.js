/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};define(["require","exports","vs/base/common/uri","vs/base/common/winjs.base","vs/editor/common/core/range","vs/base/common/filters","vs/editor/common/diff/diffComputer","vs/editor/common/model/mirrorModel2","vs/editor/common/modes/linkComputer","vs/editor/common/modes/supports/inplaceReplaceSupport","vs/editor/common/model/wordHelper","vs/editor/common/standalone/standaloneBase"],function(e,t,n,o,r,i,s,u,l,a,c,p){"use strict";function d(){return new g}var f=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),Object.defineProperty(t.prototype,"uri",{get:function(){return this._uri},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this._versionId},enumerable:!0,configurable:!0}),t.prototype.getValue=function(){return this.getText()},t.prototype.getLinesContent=function(){return this._lines.slice(0)},t.prototype.getLineCount=function(){return this._lines.length},t.prototype.getLineContent=function(e){return this._lines[e-1]},t.prototype.getWordAtPosition=function(e,t){var n=c.getWordAtText(e.column,c.ensureValidWordDefinition(t),this._lines[e.lineNumber-1],0);return n?new r.Range(e.lineNumber,n.startColumn,e.lineNumber,n.endColumn):null},t.prototype.getWordUntilPosition=function(e,t){var n=this.getWordAtPosition(e,t);return n?{word:this._lines[e.lineNumber-1].substring(n.startColumn-1,e.column-1),startColumn:n.startColumn,endColumn:e.column}:{word:"",startColumn:e.column,endColumn:e.column}},t.prototype._getAllWords=function(e){var t=this,n=[];return this._lines.forEach(function(o){t._wordenize(o,e).forEach(function(e){n.push(o.substring(e.start,e.end))})}),n},t.prototype.getAllUniqueWords=function(e,t){var n=!1,o={};return this._getAllWords(e).filter(function(e){return t&&!n&&t===e?(n=!0,!1):!o[e]&&(o[e]=!0,!0)})},t.prototype._wordenize=function(e,t){for(var n,o=[];(n=t.exec(e))&&0!==n[0].length;)o.push({start:n.index,end:n.index+n[0].length});return o},t.prototype.getValueInRange=function(e){if(e.startLineNumber===e.endLineNumber)return this._lines[e.startLineNumber-1].substring(e.startColumn-1,e.endColumn-1);var t=this._eol,n=e.startLineNumber-1,o=e.endLineNumber-1,r=[];r.push(this._lines[n].substring(e.startColumn-1));for(var i=n+1;i<o;i++)r.push(this._lines[i]);return r.push(this._lines[o].substring(0,e.endColumn-1)),r.join(t)},t}(u.MirrorModel2);t.MirrorModel=f;var m=function(){function e(){this._foreignModule=null}return e.prototype.computeDiff=function(e,t,n){var r=this._getModel(e),i=this._getModel(t);if(!r||!i)return null;var u=r.getLinesContent(),l=i.getLinesContent(),a=new s.DiffComputer(u,l,{shouldPostProcessCharChanges:!0,shouldIgnoreTrimWhitespace:n,shouldConsiderTrimWhitespaceInEmptyCase:!0});return o.TPromise.as(a.computeDiff())},e.prototype.computeDirtyDiff=function(e,t,n){var r=this._getModel(e),i=this._getModel(t);if(!r||!i)return null;var u=r.getLinesContent(),l=i.getLinesContent(),a=new s.DiffComputer(u,l,{shouldPostProcessCharChanges:!1,shouldIgnoreTrimWhitespace:n,shouldConsiderTrimWhitespaceInEmptyCase:!1});return o.TPromise.as(a.computeDiff())},e.prototype.computeLinks=function(e){var t=this._getModel(e);return t?o.TPromise.as(l.computeLinks(t)):null},e.prototype.textualSuggest=function(e,t,n,r){var i=this._getModel(e);return i?o.TPromise.as(this._suggestFiltered(i,t,new RegExp(n,r))):null},e.prototype._suggestFiltered=function(e,t,n){var o=this._suggestUnfiltered(e,t,n);return[{currentWord:o.currentWord,suggestions:o.suggestions.filter(function(e){return!!i.fuzzyContiguousFilter(o.currentWord,e.label)}),incomplete:o.incomplete}]},e.prototype._suggestUnfiltered=function(e,t,n){var o=e.getWordUntilPosition(t,n).word,r=e.getAllUniqueWords(n,o),i=r.filter(function(e){return!/^-?\d*\.?\d/.test(e)}).map(function(e){return{type:"text",label:e,codeSnippet:e,noAutoAccept:!0}});return{currentWord:o,suggestions:i}},e.prototype.navigateValueSet=function(e,t,n,r,i){var s=this._getModel(e);if(!s)return null;var u=new RegExp(r,i);t.startColumn===t.endColumn&&(t.endColumn+=1);var l=s.getValueInRange(t),c=s.getWordAtPosition({lineNumber:t.startLineNumber,column:t.startColumn},u),p=null;null!==c&&(p=s.getValueInRange(c));var d=a.BasicInplaceReplace.INSTANCE.navigateValueSet(t,l,c,p,n);return o.TPromise.as(d)},e.prototype.loadForeignModule=function(e,t){var n=this;return new o.TPromise(function(o,r){self.require([e],function(e){var r={getMirrorModels:function(){return n._getModels()}};n._foreignModule=e.create(r,t);var i=[];for(var s in n._foreignModule)"function"==typeof n._foreignModule[s]&&i.push(s);o(i)},r)})},e.prototype.fmr=function(e,t){if(!this._foreignModule||"function"!=typeof this._foreignModule[e])return o.TPromise.wrapError(new Error("Missing requestHandler or method: "+e));try{return o.TPromise.as(this._foreignModule[e].apply(this._foreignModule,t))}catch(n){return o.TPromise.wrapError(n)}},e}();t.BaseEditorSimpleWorker=m;var g=function(e){function t(){e.call(this),this._models=Object.create(null)}return __extends(t,e),t.prototype.dispose=function(){this._models=Object.create(null)},t.prototype._getModel=function(e){return this._models[e]},t.prototype._getModels=function(){var e=this,t=[];return Object.keys(this._models).forEach(function(n){return t.push(e._models[n])}),t},t.prototype.acceptNewModel=function(e){this._models[e.url]=new f(n["default"].parse(e.url),e.value.lines,e.value.EOL,e.versionId)},t.prototype.acceptModelChanged=function(e,t){if(this._models[e]){var n=this._models[e];n.onEvents(t)}},t.prototype.acceptRemovedModel=function(e){this._models[e]&&delete this._models[e]},t}(m);t.EditorSimpleWorkerImpl=g,t.create=d;var h=self,_="function"==typeof h.importScripts;_&&(h.monaco=p.createMonacoBaseAPI())});