define(["require","exports","vs/editor/common/viewLayout/whitespaceComputer"],function(e,t,i){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";var r=function(){function e(){this.linesCount=0,this.whitespaces=new i.WhitespaceComputer}return e.prototype.replaceLines=function(e){this.linesCount=e},e.prototype.insertWhitespace=function(e,t,i){return this.whitespaces.insertWhitespace(e,t,i)},e.prototype.changeWhitespace=function(e,t,i){return this.whitespaces.changeWhitespace(e,t,i)},e.prototype.removeWhitespace=function(e){return this.whitespaces.removeWhitespace(e)},e.prototype.onModelLinesDeleted=function(e,t){this.linesCount-=t-e+1,this.whitespaces.onModelLinesDeleted(e,t)},e.prototype.onModelLinesInserted=function(e,t){this.linesCount+=t-e+1,this.whitespaces.onModelLinesInserted(e,t)},e.prototype.getTotalHeight=function(e){e=0|e;var t=e*this.linesCount,i=this.whitespaces.getTotalHeight();return t+i},e.prototype.getVerticalOffsetForLineNumber=function(e,t){e=0|e,t=0|t;var i;i=e>1?t*(e-1):0;var r=this.whitespaces.getAccumulatedHeightBeforeLineNumber(e);return i+r},e.prototype.getWhitespaceAccumulatedHeightBeforeLineNumber=function(e){return this.whitespaces.getAccumulatedHeightBeforeLineNumber(e)},e.prototype.hasWhitespace=function(){return this.whitespaces.getCount()>0},e.prototype.isAfterLines=function(e,t){var i=this.getTotalHeight(t);return e>i},e.prototype.getLineNumberAtOrAfterVerticalOffset=function(e,t){if(e=0|e,t=0|t,e<0)return 1;for(var i=1,r=0|this.linesCount,s=r;i<s;){var n=(i+s)/2|0,h=0|this.getVerticalOffsetForLineNumber(n,t);if(e>=h+t)i=n+1;else{if(e>=h)return n;s=n}}return i>r?r:i},e.prototype.getCenteredLineInViewport=function(e,t,i){e=0|e,t=0|t,i=0|i;for(var r,s,n=this.getLinesViewportData(e,t,i),h=(t-e)/2,a=n.startLineNumber;a<=n.endLineNumber;a++)if(r=n.visibleRangesDeltaTop+n.relativeVerticalOffset[a-n.startLineNumber],s=r+i,r<=h&&h<s||r>h)return a;return n.endLineNumber},e.prototype.getLinesViewportData=function(e,t,i){e=0|e,t=0|t,i=0|i;var r,s,n=0|this.getLineNumberAtOrAfterVerticalOffset(e,i),h=0|this.linesCount,a=0|this.getVerticalOffsetForLineNumber(n,i),o=0|this.whitespaces.getFirstWhitespaceIndexAfterLineNumber(n),c=0|this.whitespaces.getCount();o===-1?(o=c,s=h+1,r=0):(s=0|this.whitespaces.getAfterLineNumberForWhitespaceIndex(o),r=0|this.whitespaces.getHeightForWhitespaceIndex(o));var p=a,u=p,f=5e5,g=0;a>=f&&(g=Math.floor(a/f)*f,g=Math.floor(g/i)*i,u-=g);for(var l=[],d=n;d<=h;d++){for(p+=i,l.push(u),u+=i;s===d;)u+=r,p+=r,o++,o>=c?s=h+1:(s=0|this.whitespaces.getAfterLineNumberForWhitespaceIndex(o),r=0|this.whitespaces.getHeightForWhitespaceIndex(o));if(p>t){h=d;break}}return{viewportTop:e-g,viewportHeight:t-e,bigNumbersDelta:g,startLineNumber:n,endLineNumber:h,visibleRangesDeltaTop:-(e-g),relativeVerticalOffset:l}},e.prototype.getVerticalOffsetForWhitespaceIndex=function(e,t){e=0|e,t=0|t;var i,r=this.whitespaces.getAfterLineNumberForWhitespaceIndex(e);i=r>=1?t*r:0;var s;return s=e>0?this.whitespaces.getAccumulatedHeight(e-1):0,i+s},e.prototype.getWhitespaceIndexAtOrAfterVerticallOffset=function(e,t){e=0|e,t=0|t;var i,r,s,n=0,h=this.whitespaces.getCount()-1;if(h<0)return-1;var a=this.getVerticalOffsetForWhitespaceIndex(h,t),o=this.whitespaces.getHeightForWhitespaceIndex(h);if(e>=a+o)return-1;for(;n<h;)if(i=Math.floor((n+h)/2),r=this.getVerticalOffsetForWhitespaceIndex(i,t),s=this.whitespaces.getHeightForWhitespaceIndex(i),e>=r+s)n=i+1;else{if(e>=r)return i;h=i}return n},e.prototype.getWhitespaceAtVerticalOffset=function(e,t){e=0|e,t=0|t;var i=this.getWhitespaceIndexAtOrAfterVerticallOffset(e,t);if(i<0)return null;if(i>=this.whitespaces.getCount())return null;var r=this.getVerticalOffsetForWhitespaceIndex(i,t);if(r>e)return null;var s=this.whitespaces.getHeightForWhitespaceIndex(i),n=this.whitespaces.getIdForWhitespaceIndex(i),h=this.whitespaces.getAfterLineNumberForWhitespaceIndex(i);return{id:n,afterLineNumber:h,verticalOffset:r,height:s}},e.prototype.getWhitespaceViewportData=function(e,t,i){e=0|e,t=0|t,i=0|i;var r=this.getWhitespaceIndexAtOrAfterVerticallOffset(e,i),s=this.whitespaces.getCount()-1;if(r<0)return[];var n,h,a,o=[];for(n=r;n<=s&&(h=this.getVerticalOffsetForWhitespaceIndex(n,i),a=this.whitespaces.getHeightForWhitespaceIndex(n),!(h>=t));n++)o.push({id:this.whitespaces.getIdForWhitespaceIndex(n),afterLineNumber:this.whitespaces.getAfterLineNumberForWhitespaceIndex(n),verticalOffset:h,height:a});return o},e.prototype.getWhitespaces=function(e){return this.whitespaces.getWhitespaces(e)},e}();t.VerticalObjects=r});