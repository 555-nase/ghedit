/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
var __decorate=this&&this.__decorate||function(e,n,t,o){var r,i=arguments.length,s=i<3?n:null===o?o=Object.getOwnPropertyDescriptor(n,t):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,n,t,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(s=(i<3?r(s):i>3?r(n,t,s):r(n,t))||s);return i>3&&s&&Object.defineProperty(n,t,s),s},__param=this&&this.__param||function(e,n){return function(t,o){n(t,o,e)}};define(["require","exports","vs/base/common/event","vs/base/common/lifecycle","vs/base/common/collections","vs/platform/keybinding/common/keybinding","vs/platform/actions/common/actions","vs/platform/extensions/common/extensions","vs/platform/commands/common/commands","vs/platform/actions/common/resourceContextKey"],function(e,n,t,o,r,i,s,c,a,u){"use strict";var m=function(){function e(e,n){this._extensionService=e,this._commandService=n}return e.prototype.createMenu=function(e,n){return new p(e,this._commandService,n,this._extensionService)},e.prototype.getCommandActions=function(){return r.values(s.MenuRegistry.commands)},e=__decorate([__param(0,c.IExtensionService),__param(1,a.ICommandService)],e)}();n.MenuService=m;var p=function(){function e(n,o,r,i){var c=this;this._commandService=o,this._keybindingService=r,this._extensionService=i,this._menuGroups=[],this._disposables=[],this._onDidChange=new t.Emitter,this._extensionService.onReady().then(function(t){var o,r=s.MenuRegistry.getMenuItems(n),i=Object.create(null);r.sort(e._compareMenuItems);for(var a=0,u=r;a<u.length;a++){var m=u[a],p=m.group;o&&o[0]===p||(o=[p,[]],c._menuGroups.push(o)),o[1].push(new s.MenuItemAction(m,c._commandService)),e._fillInKbExprKeys(m.when,i)}c._disposables.push(c._keybindingService.onDidChangeContext(function(e){for(var n=0,t=e;n<t.length;n++){var o=t[n];if(i[o])return void c._onDidChange.fire()}})),c._onDidChange.fire(c)})}return e.prototype.dispose=function(){this._disposables=o.dispose(this._disposables),this._onDidChange.dispose()},Object.defineProperty(e.prototype,"onDidChange",{get:function(){return this._onDidChange.event},enumerable:!0,configurable:!0}),e.prototype.getActions=function(){for(var e=[],n=0,t=this._menuGroups;n<t.length;n++){for(var o=t[n],r=o[0],i=o[1],s=[],c=0,a=i;c<a.length;c++){var m=a[c];this._keybindingService.contextMatchesRules(m.item.when)&&(m.resource=this._keybindingService.getContextValue(u.ResourceContextKey.Resource),s.push(m))}s.length>0&&e.push([r,s])}return e},e._fillInKbExprKeys=function(e,n){if(e)for(var t=0,o=e.keys();t<o.length;t++){var r=o[t];n[r]=!0}},e._compareMenuItems=function(e,n){var t=e.group,o=n.group;if(t!==o){if(!t)return 1;if(!o)return-1;if("navigation"===t)return-1;if("navigation"===o)return 1;var r=t.localeCompare(o);if(0!==r)return r}var i=e.order||0,s=n.order||0;return i<s?-1:i>s?1:e.command.title.localeCompare(n.command.title)},e=__decorate([__param(1,a.ICommandService),__param(2,i.IKeybindingService),__param(3,c.IExtensionService)],e)}()});