define(["require","exports","vs/base/browser/dom","vs/nls","vs/base/common/paths","vs/base/common/idGenerator","vs/base/common/collections","vs/platform/extensions/common/extensionsRegistry","vs/platform/keybinding/common/keybinding","vs/platform/actions/common/actions"],function(e,t,o,n,i,r,a,s,c,m){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";var d;!function(e){function t(e){switch(e){case"editor/title":return m.MenuId.EditorTitle;case"editor/context":return m.MenuId.EditorContext;case"explorer/context":return m.MenuId.ExplorerContext}}function o(e,t){if(!Array.isArray(e))return t.error(n.localize("requirearry","menu items must be an arry")),!1;for(var o=0,i=e;o<i.length;o++){var r=i[o];if("string"!=typeof r.command)return t.error(n.localize("requirestring","property `{0}` is mandatory and must be of type `string`","command")),!1;if(r.alt&&"string"!=typeof r.alt)return t.error(n.localize("optstring","property `{0}` can be omitted or must be of type `string`","alt")),!1;if(r.when&&"string"!=typeof r.when)return t.error(n.localize("optstring","property `{0}` can be omitted or must be of type `string`","when")),!1;if(r.group&&"string"!=typeof r.group)return t.error(n.localize("optstring","property `{0}` can be omitted or must be of type `string`","group")),!1}return!0}function i(e,t){return e?"string"!=typeof e.command?(t.error(n.localize("requirestring","property `{0}` is mandatory and must be of type `string`","command")),!1):"string"!=typeof e.title?(t.error(n.localize("requirestring","property `{0}` is mandatory and must be of type `string`","title")),!1):e.category&&"string"!=typeof e.category?(t.error(n.localize("optstring","property `{0}` can be omitted or must be of type `string`","category")),!1):!!r(e.icon,t):(t.error(n.localize("nonempty","expected non-empty value.")),!1)}function r(e,t){return"undefined"==typeof e||("string"==typeof e||("string"==typeof e.dark&&"string"==typeof e.light||(t.error(n.localize("opticon","property `icon` can be omitted or must be either a string or a literal like `{dark, light}`")),!1)))}e.parseMenuId=t,e.isValidMenuItems=o;var a={type:"object",properties:{command:{description:n.localize("vscode.extension.contributes.menuItem.command","Identifier of the command to execute. The command must be declared in the 'commands'-section"),type:"string"},alt:{description:n.localize("vscode.extension.contributes.menuItem.alt","Identifier of an alternative command to execute. The command must be declared in the 'commands'-section"),type:"string"},when:{description:n.localize("vscode.extension.contributes.menuItem.when","Condition which must be true to show this item"),type:"string"},group:{description:n.localize("vscode.extension.contributes.menuItem.group","Group into which this command belongs"),type:"string"}}};e.menusContribtion={description:n.localize("vscode.extension.contributes.menus","Contributes menu items to the editor"),type:"object",properties:{"editor/title":{description:n.localize("menus.editorTitle","The editor title menu"),type:"array",items:a},"editor/context":{description:n.localize("menus.editorContext","The editor context menu"),type:"array",items:a},"explorer/context":{description:n.localize("menus.explorerContext","The file explorer context menu"),type:"array",items:a}}},e.isValidCommand=i;var s={type:"object",properties:{command:{description:n.localize("vscode.extension.contributes.commandType.command","Identifier of the command to execute"),type:"string"},title:{description:n.localize("vscode.extension.contributes.commandType.title","Title by which the command is represented in the UI"),type:"string"},category:{description:n.localize("vscode.extension.contributes.commandType.category","(Optional) Category string by the command is grouped in the UI"),type:"string"},icon:{description:n.localize("vscode.extension.contributes.commandType.icon","(Optional) Icon which is used to represent the command in the UI. Either a file path or a themable configuration"),anyOf:["string",{type:"object",properties:{light:{description:n.localize("vscode.extension.contributes.commandType.icon.light","Icon path when a light theme is used"),type:"string"},dark:{description:n.localize("vscode.extension.contributes.commandType.icon.dark","Icon path when a dark theme is used"),type:"string"}}}]}}};e.commandsContribution={description:n.localize("vscode.extension.contributes.commands","Contributes commands to the command palette."),oneOf:[s,{type:"array",items:s}]}}(d||(d={})),s.ExtensionsRegistry.registerExtensionPoint("commands",d.commandsContribution).setHandler(function(e){function t(e,t){if(d.isValidCommand(e,t.collector)){var r,s=e.icon,c=e.category,l=e.title,u=e.command;if(s)if(r=a.nextId(),"string"==typeof s){var p=i.join(t.description.extensionFolderPath,s);o.createCSSRule(".icon."+r,'background-image: url("'+p+'")')}else{var g=i.join(t.description.extensionFolderPath,s.light),y=i.join(t.description.extensionFolderPath,s.dark);o.createCSSRule(".icon."+r,'background-image: url("'+g+'")'),o.createCSSRule(".vs-dark .icon."+r+", hc-black .icon."+r,'background-image: url("'+y+'")')}m.MenuRegistry.addCommand({id:u,title:l,category:c,iconClass:r})&&t.collector.info(n.localize("dup","Command `{0}` appears multiple times in the `commands` section.",e.command))}}for(var a=new r.IdGenerator("contrib-cmd-icon-"),s=0,c=e;s<c.length;s++){var l=c[s],u=l.value;if(Array.isArray(u))for(var p=0,g=u;p<g.length;p++){var y=g[p];t(y,l)}else t(u,l)}}),s.ExtensionsRegistry.registerExtensionPoint("menus",d.menusContribtion).setHandler(function(e){for(var t=function(e){var t=e.value,o=e.collector;a.forEach(t,function(e){if(d.isValidMenuItems(e.value,o)){var t=d.parseMenuId(e.key);if(!t)return void o.warn(n.localize("menuId.invalid","`{0}` is not a valid menu identifier",e.key));for(var i=0,r=e.value;i<r.length;i++){var a=r[i],s=m.MenuRegistry.getCommand(a.command),l=a.alt&&m.MenuRegistry.getCommand(a.alt);s||o.warn(n.localize("missing.command","Menu item references a command `{0}` which is not defined in the 'commands' section.",a.command)),a.alt&&!l&&o.warn(n.localize("missing.altCommand","Menu item references an alt-command `{0}` which is not defined in the 'commands' section.",a.alt)),a.command===a.alt&&o.info(n.localize("dupe.command","Menu item references the same command as default and alt-command")),a.alt&&t!==m.MenuId.EditorTitle&&"navigation"!==a.group&&o.info(n.localize("nosupport.altCommand","Sorry, but currently only the 'navigation' group of the 'editor/title' menu supports alt-commands"));var u=void 0,p=void 0;if(a.group){var g=a.group.lastIndexOf("@");g>0?(u=a.group.substr(0,g),p=Number(a.group.substr(g+1))||void 0):u=a.group}m.MenuRegistry.appendMenuItem(t,{command:s,alt:l,group:u,order:p,when:c.KbExpr.deserialize(a.when)})}}})},o=0,i=e;o<i.length;o++){var r=i[o];t(r)}})});