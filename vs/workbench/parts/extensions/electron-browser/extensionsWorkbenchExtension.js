/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
var __decorate=this&&this.__decorate||function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},__param=this&&this.__param||function(e,t){return function(n,s){t(n,s,e)}};define(["require","exports","vs/base/common/errors","vs/nls","vs/base/common/winjs.base","vs/base/common/lifecycle","vs/platform/extensionManagement/common/extensionManagement","vs/platform/instantiation/common/instantiation","vs/platform/message/common/message","./extensions","vs/base/common/severity","vs/workbench/services/workspace/common/contextService","vs/workbench/services/activity/common/activityService","vs/workbench/electron-browser/actions","electron"],function(e,t,n,s,i,o,r,a,c,l,v,u,p,d,m){"use strict";var h=function(){function e(e,t,s,i,o,r){this.instantiationService=e,this.extensionManagementService=t,this.messageService=s,this.registerListeners();var a=i.getOptions();a.extensionsToInstall&&a.extensionsToInstall.length&&this.install(a.extensionsToInstall).done(null,n.onUnexpectedError)}return e.prototype.registerListeners=function(){var e=this;m.ipcRenderer.on("vscode:installExtensions",function(t,s){s.extensionsToInstall&&e.install(s.extensionsToInstall).done(null,n.onUnexpectedError)})},e.prototype.install=function(e){var t=this;return i.TPromise.join(e.map(function(e){return t.extensionManagementService.install(e)})).then(function(){t.messageService.show(v["default"].Info,{message:e.length>1?s.localize("success","Extensions were successfully installed. Restart to enable them."):s.localize("successSingle","Extension was successfully installed. Restart to enable it."),actions:[t.instantiationService.createInstance(d.ReloadWindowAction,d.ReloadWindowAction.ID,s.localize("reloadNow","Restart Now"))]})})},e.prototype.getId=function(){return"vs.extensions.workbenchextension"},e=__decorate([__param(0,a.IInstantiationService),__param(1,r.IExtensionManagementService),__param(2,c.IMessageService),__param(3,u.IWorkspaceContextService),__param(4,r.IExtensionTipsService),__param(5,r.IExtensionGalleryService)],e)}();t.ExtensionsWorkbenchExtension=h;var f=function(){function e(e,t){this.activityService=e,this.extensionsWorkbenchService=t,t.onChange(this.onServiceChange,this,this.disposables)}return e.prototype.getId=function(){return"vs.extensions.statusupdater"},e.prototype.onServiceChange=function(){if(this.extensionsWorkbenchService.local.some(function(e){return e.state===l.ExtensionState.Installing}))return void this.activityService.showActivity(l.VIEWLET_ID,new p.ProgressBadge(function(){return s.localize("extensions","Extensions")}),"extensions-badge progress-badge");var e=this.extensionsWorkbenchService.local.reduce(function(e,t){return e+(t.outdated?1:0)},0);if(e>0){var t=new p.NumberBadge(e,function(e){return s.localize("outdatedExtensions","{0} Outdated Extensions",e)});this.activityService.showActivity(l.VIEWLET_ID,t,"extensions-badge count-badge")}else this.activityService.showActivity(l.VIEWLET_ID,null,"extensions-badge")},e.prototype.dispose=function(){this.disposables=o.dispose(this.disposables)},e=__decorate([__param(0,p.IActivityService),__param(1,l.IExtensionsWorkbenchService)],e)}();t.StatusUpdater=f});