/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
define(["require","exports","vs/base/parts/ipc/node/ipc.net","vs/workbench/parts/git/common/gitIpc","fs"],function(e,n,s,r,t){"use strict";function i(e){console.error(e),process.exit(1)}function o(e){if(5!==e.length)return i("Wrong number of arguments");if(!process.env.VSCODE_IPC_HOOK)return i("Missing ipc hook");if(!process.env.VSCODE_GIT_REQUEST_ID)return i("Missing git id");if(!process.env.VSCODE_GIT_ASKPASS_PIPE)return i("Missing pipe");var n=process.env.VSCODE_GIT_REQUEST_ID,o=process.env.VSCODE_GIT_ASKPASS_PIPE,c=e[2],p=e[4].substring(1,e[4].length-2);s.connect(process.env.VSCODE_IPC_HOOK).then(function(e){var s=e.getChannel("askpass"),i=new r.AskpassChannelClient(s);return i.askpass(n,p,process.env.MONACO_GIT_COMMAND).then(function(n){return n&&t.writeFileSync(o,(/^Username$/i.test(c)?n.username:n.password)+"\n"),e})}).done(function(e){e.dispose(),setTimeout(function(){return process.exit(0)},0)})}o(process.argv)});