define(["require","exports","vs/editor/common/core/range"],function(e,n,i){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";function r(e){e.sort(function(e,n){return e.originalStartLineNumber<n.originalStartLineNumber?-1:e.originalStartLineNumber>n.originalStartLineNumber?1:e.modifiedStartLineNumber<n.modifiedStartLineNumber?-1:1})}function t(e){e.sort(function(e,n){return e.getStartPosition().lineNumber<n.getStartPosition().lineNumber?-1:1})}function u(e){return e.originalEndLineNumber<=0}function m(e){return e.modifiedEndLineNumber<=0}function o(e,n){var i={modifiedStartLineNumber:Math.max(e.modifiedStartLineNumber,n.startLineNumber),modifiedEndLineNumber:Math.min(e.modifiedEndLineNumber,n.endLineNumber),originalStartLineNumber:e.originalStartLineNumber,originalEndLineNumber:e.originalEndLineNumber},r=m(i)&&e.modifiedStartLineNumber>=n.startLineNumber&&e.modifiedStartLineNumber<=n.endLineNumber;return i.modifiedStartLineNumber<=i.modifiedEndLineNumber||r?i:null}function d(e,n){r(e),t(n);for(var i=[],u=0,d=-1,a=0;a<e.length;++a)for(u=Math.max(0,u-1);u<n.length&&(n[u].startLineNumber<=e[a].modifiedEndLineNumber||m(e[a]));){var L=o(e[a],n[u]);null!==L&&(d!==L.modifiedStartLineNumber?(i.push(L),d=L.modifiedEndLineNumber):(L.modifiedStartLineNumber++,L.modifiedStartLineNumber<=L.modifiedEndLineNumber&&(i.push(L),d=L.modifiedEndLineNumber))),u++}return i}function a(e,n,i){var r=e;return""!==r&&(r+=n.getEOL()),r+n.getValueInRange(i)}function L(e,n,t){r(t);for(var o="",d=1,L=0;L<t.length;++L){var b=u(t[L])?t[L].originalStartLineNumber+1:t[L].originalStartLineNumber;d<b&&(o=a(o,e,new i.Range(d,1,b-1,e.getLineMaxColumn(b-1))),d=b),m(t[L])||(o=a(o,n,new i.Range(t[L].modifiedStartLineNumber,1,t[L].modifiedEndLineNumber,n.getLineMaxColumn(t[L].modifiedEndLineNumber)))),u(t[L])||(d=t[L].originalEndLineNumber+1)}return d<=e.getLineCount()&&(o=a(o,e,new i.Range(d,1,e.getLineCount(),e.getLineMaxColumn(e.getLineCount())))),o}n.intersectChangeAndSelection=o,n.getSelectedChanges=d,n.applyChangesToModel=L});