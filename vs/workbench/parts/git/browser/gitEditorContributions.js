var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},__decorate=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__param=this&&this.__param||function(e,t){return function(r,o){t(r,o,e)}};define(["require","exports","vs/editor/common/editorCommon","vs/workbench/parts/git/common/git","vs/platform/workspace/common/workspace","vs/base/common/lifecycle","vs/base/common/async"],function(e,t,r,o,i,n,s){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";function c(e){var t=h.DECORATION_OPTIONS;return e.getLinesContent().map(function(e,t){return a.test(e)?t:null}).filter(function(e){return null!==e}).map(function(e){return{startLineNumber:e+1,startColumn:1,endLineNumber:e+1,endColumn:1}}).map(function(e){return{range:e,options:t}})}var a=/^<<<<<<<|^=======|^>>>>>>>/,u=function(e){function t(t,r,i,n){var c=this;e.call(this),this.editor=t,this.model=r,this.filePath=i,this.gitService=n,this.decorations=[];var a=new s.Delayer(300);a.trigger(function(){return c.redecorate()});var u=n.getModel();this._register(r.onDidChangeContent(function(){return a.trigger(function(){return c.redecorate()})})),this._register(u.addListener2(o.ModelEvents.STATUS_MODEL_UPDATED,function(){return a.trigger(function(){return c.redecorate()})}))}return __extends(t,e),t.prototype._setDecorations=function(e){this.decorations=this.editor.deltaDecorations(this.decorations,e)},t.prototype.redecorate=function(){var e=this.gitService.getModel();if(e){var t=e.getStatus().find(this.filePath,o.StatusType.MERGE);t&&this._setDecorations(c(this.model))}},t.prototype.dispose=function(){this._setDecorations([]),e.prototype.dispose.call(this)},t}(n.Disposable),h=function(e){function t(t,r,o){var i=this;e.call(this),this.editor=t,this.gitService=r,this.contextService=o,this._register(this.editor.onDidChangeModel(function(){return i.onModelChanged()})),this.mergeDecorator=null}return __extends(t,e),t.prototype.getId=function(){return t.ID},t.prototype.onModelChanged=function(){if(this.mergeDecorator&&(this.mergeDecorator.dispose(),this.mergeDecorator=null),this.contextService&&this.gitService){var e=this.editor.getModel();if(e){var t=e.uri;if(t){var r=this.contextService.toWorkspaceRelativePath(t);r&&(this.mergeDecorator=new u(this.editor,e,r,this.gitService))}}}},t.prototype.dispose=function(){this.mergeDecorator&&(this.mergeDecorator.dispose(),this.mergeDecorator=null),e.prototype.dispose.call(this)},t.ID="vs.git.editor.merge.decorator",t.DECORATION_OPTIONS={className:"git-merge-control-decoration",isWholeLine:!0,overviewRuler:{color:"rgb(197, 118, 0)",darkColor:"rgb(197, 118, 0)",position:r.OverviewRulerLane.Left},stickiness:r.TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges},t=__decorate([__param(1,o.IGitService),__param(2,i.IWorkspaceContextService)],t)}(n.Disposable);t.MergeDecorator=h});