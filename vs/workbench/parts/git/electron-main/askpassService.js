/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
define(["require","exports","vs/nls","electron","vs/base/common/platform","vs/base/common/winjs.base"],function(e,s,t,i,n,a){"use strict";var r=function(){function s(){var e=this;this.askpassCache=Object.create(null),i.ipcMain.on("git:askpass",function(s,t){e.askpassCache[t.id].credentials=t.credentials})}return s.prototype.askpass=function(s,r,o){var c=this;return new a.TPromise(function(a,l){var u=c.askpassCache[s];if("undefined"!=typeof u)return a(u.credentials);if("fetch"===o)return a({username:"",password:""});var d=new i.BrowserWindow({alwaysOnTop:!0,skipTaskbar:!0,resizable:!1,width:450,height:n.isWindows?280:260,show:!0,title:t.localize("git","Git")});d.setMenuBarVisibility(!1),c.askpassCache[s]={window:d,credentials:null},d.loadURL(e.toUrl("vs/workbench/parts/git/electron-main/index.html")),d.webContents.executeJavaScript("init("+JSON.stringify({id:s,host:r,command:o})+")"),d.once("closed",function(){a(c.askpassCache[s].credentials),setTimeout(function(){return delete c.askpassCache[s]},1e4)})})},s}();s.GitAskpassService=r});