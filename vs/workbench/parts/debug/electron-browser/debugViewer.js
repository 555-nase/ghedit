/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},__decorate=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},__param=this&&this.__param||function(e,t){return function(n,o){t(n,o,e)}};define(["require","exports","vs/nls","vs/base/common/winjs.base","vs/base/common/lifecycle","vs/base/common/keyCodes","vs/base/common/paths","vs/base/common/async","vs/base/common/errors","vs/base/common/strings","vs/base/common/platform","vs/base/browser/dom","vs/base/common/labels","vs/base/browser/ui/actionbar/actionbar","vs/base/browser/ui/inputbox/inputBox","vs/base/parts/tree/browser/treeDefaults","vs/workbench/parts/debug/common/debug","vs/workbench/parts/debug/common/debugModel","vs/workbench/parts/debug/common/debugViewModel","vs/workbench/parts/debug/browser/debugActions","vs/workbench/parts/debug/electron-browser/electronDebugActions","vs/platform/contextview/browser/contextView","vs/platform/instantiation/common/instantiation","vs/platform/workspace/common/workspace","vs/platform/message/common/message"],function(e,t,n,o,i,r,a,s,c,p,u,l,d,h,f,v,b,m,A,E,g,S,y,k,T){"use strict";function I(e,t,n,o){var i="string"==typeof e?e:e.value;t.className="value",null===i||(e instanceof m.Expression||e instanceof m.Variable)&&!e.available?(l.addClass(t,"unavailable"),i!==m.Expression.DEFAULT_VALUE&&l.addClass(t,"error")):isNaN(+i)?D.test(i)?l.addClass(t,"boolean"):C.test(i)&&l.addClass(t,"string"):l.addClass(t,"number"),n&&e.valueChanged&&(t.className="value changed"),o&&i.length>o&&(i=i.substr(0,o)+"..."),t.textContent=i,t.title=i}function x(e,t,n,o){t.available&&(n.name.textContent=t.name,n.name.title=t.type?t.type:""),t.value?(n.name.textContent+=":",I(t,n.value,o,P),n.value.title=t.value):(n.value.textContent="",n.value.title="")}function _(e,t,n,o,a,p){var u=l.append(a,L(".inputBoxContainer")),d=new f.InputBox(u,t,{validationOptions:p.validationOptions,placeholder:p.placeholder,ariaLabel:p.ariaLabel});d.value=p.initialValue?p.initialValue:"",d.focus();var h=!1,v=[d],b=s.once(function(t){h||(h=!0,o instanceof m.Expression&&t&&d.value?e.renameWatchExpression(o.getId(),d.value).done(null,c.onUnexpectedError):o instanceof m.Expression&&!o.name?e.removeWatchExpressions(o.getId()):o instanceof m.FunctionBreakpoint&&t&&d.value?e.renameFunctionBreakpoint(o.getId(),d.value).done(null,c.onUnexpectedError):o instanceof m.FunctionBreakpoint&&!o.name?e.removeFunctionBreakpoints(o.getId()).done(null,c.onUnexpectedError):o instanceof m.Variable&&(o.errorMessage=null,t&&e.setVariable(o,d.value).done(function(){return n.refresh(o,!1)},c.onUnexpectedError)),n.clearHighlight(),n.DOMFocus(),n.setFocus(o),a.removeChild(u),i.dispose(v))});v.push(l.addStandardDisposableListener(d.inputElement,"keydown",function(e){var t=e.equals(r.CommonKeybindings.ESCAPE),n=e.equals(r.CommonKeybindings.ENTER);(t||n)&&b(n)})),v.push(l.addDisposableListener(d.inputElement,"blur",function(){b(!0)}))}function B(e,t){return e.inMemory?e.name:d.getPathLabel(a.basename(e.uri.fsPath),t)}var L=l.emmet,D=/^true|false$/i,C=/^(['"]).*\1$/,P=1024;t.renderExpressionValue=I,t.renderVariable=x;var R=function(e){function t(t,n,o,i){void 0===i&&(i=!0),e.call(this),this.debugService=t,this.contextMenuService=n,this.actionProvider=o,this.focusOnContextMenu=i,u.isMacintosh?this.downKeyBindingDispatcher.set(r.CommonKeybindings.CTRLCMD_BACKSPACE,this.onDelete.bind(this)):(this.downKeyBindingDispatcher.set(r.CommonKeybindings.DELETE,this.onDelete.bind(this)),this.downKeyBindingDispatcher.set(r.CommonKeybindings.SHIFT_DELETE,this.onDelete.bind(this)))}return __extends(t,e),t.prototype.onContextMenu=function(e,t,n){var o=this;if(n.target&&n.target.tagName&&"input"===n.target.tagName.toLowerCase())return!1;if(n.preventDefault(),n.stopPropagation(),this.focusOnContextMenu&&e.setFocus(t),this.actionProvider.hasSecondaryActions(e,t)){var i={x:n.posx+1,y:n.posy};return this.contextMenuService.showContextMenu({getAnchor:function(){return i},getActions:function(){return o.actionProvider.getSecondaryActions(e,t)},onHide:function(t){t&&e.DOMFocus()},getActionsContext:function(){return t}}),!0}return!1},t.prototype.onDelete=function(e,t){return!1},t}(v.DefaultController);t.BaseDebugController=R;var M=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.onLeftClick=function(t,n,o){return"number"==typeof n?this.showMoreStackFrames(t,n):(n instanceof m.StackFrame&&this.focusStackFrame(n,o,!0),e.prototype.onLeftClick.call(this,t,n,o))},t.prototype.onEnter=function(t,n){var o=t.getFocus();return"number"==typeof o?this.showMoreStackFrames(t,o):(o instanceof m.StackFrame&&this.focusStackFrame(o,n,!1),e.prototype.onEnter.call(this,t,n))},t.prototype.onUp=function(t,n){return e.prototype.onUp.call(this,t,n),this.focusStackFrame(t.getFocus(),n,!0),!0},t.prototype.onPageUp=function(t,n){return e.prototype.onPageUp.call(this,t,n),this.focusStackFrame(t.getFocus(),n,!0),!0},t.prototype.onDown=function(t,n){return e.prototype.onDown.call(this,t,n),this.focusStackFrame(t.getFocus(),n,!0),!0},t.prototype.onPageDown=function(t,n){return e.prototype.onPageDown.call(this,t,n),this.focusStackFrame(t.getFocus(),n,!0),!0},t.prototype.showMoreStackFrames=function(e,t){var n=this.debugService.getModel().getThreads()[t];return n&&n.getCallStack(this.debugService,!0).done(function(){return e.refresh()},c.onUnexpectedError),!0},t.prototype.focusStackFrame=function(e,t,n){this.debugService.setFocusedStackFrameAndEvaluate(e).done(null,c.onUnexpectedError);var o=t&&(t.ctrlKey||t.metaKey);this.debugService.openOrRevealSource(e.source,e.lineNumber,n,o).done(null,c.onUnexpectedError)},t}(R);t.CallStackController=M;var F=function(){function e(e,t){this.instantiationService=e,this.debugService=t}return e.prototype.hasActions=function(e,t){return!1},e.prototype.getActions=function(e,t){return o.TPromise.as([])},e.prototype.hasSecondaryActions=function(e,t){return t instanceof m.Thread||t instanceof m.StackFrame},e.prototype.getSecondaryActions=function(e,t){var n=[];if(t instanceof m.Thread){var i=t;i.stopped?(n.push(this.instantiationService.createInstance(E.ContinueAction,E.ContinueAction.ID,E.ContinueAction.LABEL)),n.push(this.instantiationService.createInstance(E.StepOverDebugAction,E.StepOverDebugAction.ID,E.StepOverDebugAction.LABEL)),n.push(this.instantiationService.createInstance(E.StepIntoDebugAction,E.StepIntoDebugAction.ID,E.StepIntoDebugAction.LABEL)),n.push(this.instantiationService.createInstance(E.StepOutDebugAction,E.StepOutDebugAction.ID,E.StepOutDebugAction.LABEL))):n.push(this.instantiationService.createInstance(E.PauseAction,E.PauseAction.ID,E.PauseAction.LABEL))}else if(t instanceof m.StackFrame){var r=this.debugService.getActiveSession().configuration.capabilities;"boolean"==typeof r.supportsRestartFrame&&r.supportsRestartFrame&&n.push(this.instantiationService.createInstance(E.RestartFrameAction,E.RestartFrameAction.ID,E.RestartFrameAction.LABEL))}return o.TPromise.as(n)},e.prototype.getActionItem=function(e,t,n){return null},e=__decorate([__param(0,y.IInstantiationService),__param(1,b.IDebugService)],e)}();t.CallStackActionProvider=F;var w=function(){function e(e){this.debugService=e}return e.prototype.getId=function(e,t){return"number"==typeof t?t.toString():"string"==typeof t?t:t.getId()},e.prototype.hasChildren=function(e,t){return t instanceof m.Model||t instanceof m.Thread&&t.stopped},e.prototype.getChildren=function(e,t){if(t instanceof m.Thread)return this.getThreadChildren(t);var n=t.getThreads();return o.TPromise.as(Object.keys(n).map(function(e){return n[e]}))},e.prototype.getThreadChildren=function(e){return e.getCallStack(this.debugService).then(function(t){return e.stoppedDetails.framesErrorMessage?t.concat([e.stoppedDetails.framesErrorMessage]):e.stoppedDetails&&e.stoppedDetails.totalFrames>t.length?t.concat([e.threadId]):t})},e.prototype.getParent=function(e,t){return o.TPromise.as(null)},e=__decorate([__param(0,b.IDebugService)],e)}();t.CallStackDataSource=w;var O=function(){function e(e){this.contextService=e}return e.prototype.getHeight=function(e,t){return 22},e.prototype.getTemplateId=function(t,n){return n instanceof m.Thread?e.THREAD_TEMPLATE_ID:n instanceof m.StackFrame?e.STACK_FRAME_TEMPLATE_ID:"string"==typeof n?e.ERROR_TEMPLATE_ID:e.LOAD_MORE_TEMPLATE_ID},e.prototype.renderTemplate=function(t,n,o){if(n===e.LOAD_MORE_TEMPLATE_ID){var i=Object.create(null);return i.label=l.append(o,L(".load-more")),i}if(n===e.ERROR_TEMPLATE_ID){var r=Object.create(null);return r.label=l.append(o,L(".error")),r}if(n===e.THREAD_TEMPLATE_ID){var a=Object.create(null);return a.thread=l.append(o,L(".thread")),a.name=l.append(a.thread,L(".name")),a.state=l.append(a.thread,L(".state")),a.stateLabel=l.append(a.state,L("span.label")),a}var s=Object.create(null);return s.stackFrame=l.append(o,L(".stack-frame")),s.label=l.append(s.stackFrame,L("span.label")),s.file=l.append(s.stackFrame,L(".file")),s.fileName=l.append(s.file,L("span.file-name")),s.lineNumber=l.append(s.file,L("span.line-number")),s},e.prototype.renderElement=function(t,n,o,i){o===e.THREAD_TEMPLATE_ID?this.renderThread(n,i):o===e.STACK_FRAME_TEMPLATE_ID?this.renderStackFrame(n,i):o===e.ERROR_TEMPLATE_ID?this.renderError(n,i):this.renderLoadMore(n,i)},e.prototype.renderThread=function(e,t){t.thread.title=n.localize("thread","Thread"),t.name.textContent=e.name,t.stateLabel.textContent=e.stopped?n.localize("paused","paused"):n.localize({key:"running",comment:["indicates state"]},"running")},e.prototype.renderError=function(e,t){t.label.textContent=e,t.label.title=e},e.prototype.renderLoadMore=function(e,t){t.label.textContent=n.localize("loadMoreStackFrames","Load More Stack Frames")},e.prototype.renderStackFrame=function(e,t){e.source.available?l.removeClass(t.stackFrame,"disabled"):l.addClass(t.stackFrame,"disabled"),t.file.title=e.source.uri.fsPath,t.label.textContent=e.name,t.label.title=e.name,t.fileName.textContent=B(e.source,this.contextService),void 0!==e.lineNumber?(t.lineNumber.textContent=""+e.lineNumber,l.removeClass(t.lineNumber,"unavailable")):l.addClass(t.lineNumber,"unavailable")},e.prototype.disposeTemplate=function(e,t,n){},e.THREAD_TEMPLATE_ID="thread",e.STACK_FRAME_TEMPLATE_ID="stackFrame",e.ERROR_TEMPLATE_ID="error",e.LOAD_MORE_TEMPLATE_ID="loadMore",e=__decorate([__param(0,k.IWorkspaceContextService)],e)}();t.CallStackRenderer=O;var V=function(){function e(e){this.contextService=e}return e.prototype.getAriaLabel=function(e,t){return t instanceof m.Thread?n.localize("threadAriaLabel","Thread {0}, callstack, debug",t.name):t instanceof m.StackFrame?n.localize("stackFrameAriaLabel","Stack Frame {0} line {1} {2}, callstack, debug",t.name,t.lineNumber,B(t.source,this.contextService)):null},e=__decorate([__param(0,k.IWorkspaceContextService)],e)}();t.CallstackAccessibilityProvider=V;var N=function(){function e(e){this.instantiationService=e}return e.prototype.hasActions=function(e,t){return!1},e.prototype.getActions=function(e,t){return o.TPromise.as([])},e.prototype.hasSecondaryActions=function(e,t){return t instanceof m.Variable},e.prototype.getSecondaryActions=function(e,t){var n=[],i=t;return 0===i.reference&&(n.push(this.instantiationService.createInstance(E.SetValueAction,E.SetValueAction.ID,E.SetValueAction.LABEL,i)),n.push(this.instantiationService.createInstance(g.CopyValueAction,g.CopyValueAction.ID,g.CopyValueAction.LABEL,i)),n.push(new h.Separator)),n.push(this.instantiationService.createInstance(E.AddToWatchExpressionsAction,E.AddToWatchExpressionsAction.ID,E.AddToWatchExpressionsAction.LABEL,i)),o.TPromise.as(n)},e.prototype.getActionItem=function(e,t,n){return null},e}();t.VariablesActionProvider=N;var W=function(){function e(e){this.debugService=e}return e.prototype.getId=function(e,t){return t.getId()},e.prototype.hasChildren=function(e,t){if(t instanceof A.ViewModel||t instanceof m.Scope)return!0;var n=t;return 0!==n.reference&&!p.equalsIgnoreCase(n.value,"null")},e.prototype.getChildren=function(e,t){if(t instanceof A.ViewModel){var n=t.getFocusedStackFrame();return n?n.getScopes(this.debugService):o.TPromise.as([])}var i=t;return i.getChildren(this.debugService)},e.prototype.getParent=function(e,t){return o.TPromise.as(null)},e}();t.VariablesDataSource=W;var K=function(){function e(e,t){this.debugService=e,this.contextViewService=t}return e.prototype.getHeight=function(e,t){return 22},e.prototype.getTemplateId=function(t,n){return n instanceof m.Scope?e.SCOPE_TEMPLATE_ID:n instanceof m.Variable?e.VARIABLE_TEMPLATE_ID:null},e.prototype.renderTemplate=function(t,n,o){if(n===e.SCOPE_TEMPLATE_ID){var i=Object.create(null);return i.name=l.append(o,L(".scope")),i}var r=Object.create(null);return r.expression=l.append(o,L(".expression")),r.name=l.append(r.expression,L("span.name")),r.value=l.append(r.expression,L("span.value")),r},e.prototype.renderElement=function(t,o,i,r){if(i===e.SCOPE_TEMPLATE_ID)this.renderScope(o,r);else{var a=o;a===this.debugService.getViewModel().getSelectedExpression()||a.errorMessage?_(this.debugService,this.contextViewService,t,a,r.expression,{initialValue:a.value,ariaLabel:n.localize("variableValueAriaLabel","Type new variable value"),validationOptions:{validation:function(e){return a.errorMessage?{content:a.errorMessage}:null}}}):x(t,a,r,!0)}},e.prototype.renderScope=function(e,t){t.name.textContent=e.name},e.prototype.disposeTemplate=function(e,t,n){},e.SCOPE_TEMPLATE_ID="scope",e.VARIABLE_TEMPLATE_ID="variable",e=__decorate([__param(0,b.IDebugService),__param(1,S.IContextViewService)],e)}();t.VariablesRenderer=K;var U=function(){function e(){}return e.prototype.getAriaLabel=function(e,t){return t instanceof m.Scope?n.localize("variableScopeAriaLabel","Scope {0}, variables, debug",t.name):t instanceof m.Variable?n.localize("variableAriaLabel","{0} value {1}, variables, debug",t.name,t.value):null},e}();t.VariablesAccessibilityProvider=U;var z=function(e){function t(t,n,o){e.call(this,t,n,o),this.downKeyBindingDispatcher.set(r.CommonKeybindings.ENTER,this.setSelectedExpression.bind(this))}return __extends(t,e),t.prototype.onLeftClick=function(t,n,o){if(n instanceof m.Variable&&2===o.detail){var i=n;return 0===i.reference&&this.debugService.getViewModel().setSelectedExpression(i),!0}return e.prototype.onLeftClick.call(this,t,n,o)},t.prototype.setSelectedExpression=function(e,t){var n=e.getFocus();return n instanceof m.Variable&&0===n.reference&&(this.debugService.getViewModel().setSelectedExpression(n),!0)},t}(R);t.VariablesController=z;var H=function(){function e(e){this.instantiationService=e}return e.prototype.hasActions=function(e,t){return t instanceof m.Expression&&t.name},e.prototype.hasSecondaryActions=function(e,t){return!0},e.prototype.getActions=function(e,t){return o.TPromise.as(this.getExpressionActions())},e.prototype.getExpressionActions=function(){return[this.instantiationService.createInstance(E.RemoveWatchExpressionAction,E.RemoveWatchExpressionAction.ID,E.RemoveWatchExpressionAction.LABEL)]},e.prototype.getSecondaryActions=function(e,t){var n=[];if(t instanceof m.Expression){var i=t;n.push(this.instantiationService.createInstance(E.AddWatchExpressionAction,E.AddWatchExpressionAction.ID,E.AddWatchExpressionAction.LABEL)),n.push(this.instantiationService.createInstance(E.RenameWatchExpressionAction,E.RenameWatchExpressionAction.ID,E.RenameWatchExpressionAction.LABEL,i)),0===i.reference&&n.push(this.instantiationService.createInstance(g.CopyValueAction,g.CopyValueAction.ID,g.CopyValueAction.LABEL,i.value)),n.push(new h.Separator),n.push(this.instantiationService.createInstance(E.RemoveWatchExpressionAction,E.RemoveWatchExpressionAction.ID,E.RemoveWatchExpressionAction.LABEL)),n.push(this.instantiationService.createInstance(E.RemoveAllWatchExpressionsAction,E.RemoveAllWatchExpressionsAction.ID,E.RemoveAllWatchExpressionsAction.LABEL))}else{if(n.push(this.instantiationService.createInstance(E.AddWatchExpressionAction,E.AddWatchExpressionAction.ID,E.AddWatchExpressionAction.LABEL)),t instanceof m.Variable){var r=t;0===r.reference&&n.push(this.instantiationService.createInstance(g.CopyValueAction,g.CopyValueAction.ID,g.CopyValueAction.LABEL,r.value)),n.push(new h.Separator)}n.push(this.instantiationService.createInstance(E.RemoveAllWatchExpressionsAction,E.RemoveAllWatchExpressionsAction.ID,E.RemoveAllWatchExpressionsAction.LABEL))}return o.TPromise.as(n)},e.prototype.getActionItem=function(e,t,n){return null},e}();t.WatchExpressionsActionProvider=H;var j=function(){function e(e){this.debugService=e}return e.prototype.getId=function(e,t){return t.getId()},e.prototype.hasChildren=function(e,t){if(t instanceof m.Model)return!0;var n=t;return 0!==n.reference&&!p.equalsIgnoreCase(n.value,"null")},e.prototype.getChildren=function(e,t){if(t instanceof m.Model)return o.TPromise.as(t.getWatchExpressions());var n=t;return n.getChildren(this.debugService)},e.prototype.getParent=function(e,t){return o.TPromise.as(null)},e}();t.WatchExpressionsDataSource=j;var X=function(){function e(e,t,n,o,i){this.actionRunner=t,this.messageService=n,this.debugService=o,this.contextViewService=i,this.toDispose=[],this.actionProvider=e}return e.prototype.getHeight=function(e,t){return 22},e.prototype.getTemplateId=function(t,n){return n instanceof m.Expression?e.WATCH_EXPRESSION_TEMPLATE_ID:e.VARIABLE_TEMPLATE_ID},e.prototype.renderTemplate=function(t,n,o){var i=Object.create(null);return n===e.WATCH_EXPRESSION_TEMPLATE_ID&&(i.actionBar=new h.ActionBar(o,{actionRunner:this.actionRunner}),i.actionBar.push(this.actionProvider.getExpressionActions(),{icon:!0,label:!1})),i.expression=l.append(o,L(".expression")),i.name=l.append(i.expression,L("span.name")),i.value=l.append(i.expression,L("span.value")),i},e.prototype.renderElement=function(t,n,o,i){o===e.WATCH_EXPRESSION_TEMPLATE_ID?this.renderWatchExpression(t,n,i):x(t,n,i,!0)},e.prototype.renderWatchExpression=function(e,t,o){var i=this.debugService.getViewModel().getSelectedExpression();(i instanceof m.Expression&&i.getId()===t.getId()||t instanceof m.Expression&&!t.name)&&_(this.debugService,this.contextViewService,e,t,o.expression,{initialValue:t.name,placeholder:n.localize("watchExpressionPlaceholder","Expression to watch"),ariaLabel:n.localize("watchExpressionInputAriaLabel","Type watch expression")}),o.actionBar.context=t,o.name.textContent=t.name,t.value&&(o.name.textContent+=":",I(t,o.value,!0,P),o.name.title=t.type?t.type:t.value)},e.prototype.disposeTemplate=function(t,n,o){n===e.WATCH_EXPRESSION_TEMPLATE_ID&&o.actionBar.dispose()},e.prototype.dispose=function(){this.toDispose=i.dispose(this.toDispose)},e.WATCH_EXPRESSION_TEMPLATE_ID="watchExpression",e.VARIABLE_TEMPLATE_ID="variables",e=__decorate([__param(2,T.IMessageService),__param(3,b.IDebugService),__param(4,S.IContextViewService)],e)}();t.WatchExpressionsRenderer=X;var q=function(){function e(){}return e.prototype.getAriaLabel=function(e,t){return t instanceof m.Expression?n.localize("watchExpressionAriaLabel","{0} value {1}, watch, debug",t.name,t.value):t instanceof m.Variable?n.localize("watchVariableAriaLabel","{0} value {1}, watch, debug",t.name,t.value):null},e}();t.WatchExpressionsAccessibilityProvider=q;var $=function(e){function t(t,n,o){e.call(this,t,n,o),u.isMacintosh?this.downKeyBindingDispatcher.set(r.CommonKeybindings.ENTER,this.onRename.bind(this)):this.downKeyBindingDispatcher.set(r.CommonKeybindings.F2,this.onRename.bind(this))}return __extends(t,e),t.prototype.onLeftClick=function(t,n,o){if(n instanceof m.Expression&&2===o.detail){var i=n;return 0===i.reference&&this.debugService.getViewModel().setSelectedExpression(i),!0}return e.prototype.onLeftClick.call(this,t,n,o)},t.prototype.onRename=function(e,t){var n=e.getFocus();if(n instanceof m.Expression){var o=n;return 0===o.reference&&this.debugService.getViewModel().setSelectedExpression(o),!0}return!1},t.prototype.onDelete=function(e,t){var n=e.getFocus();if(n instanceof m.Expression){var o=n;return this.debugService.removeWatchExpressions(o.getId()),!0}return!1},t}(R);t.WatchExpressionsController=$;var G=function(){function e(e){this.instantiationService=e}return e.prototype.hasActions=function(e,t){return t instanceof m.Breakpoint},e.prototype.hasSecondaryActions=function(e,t){return t instanceof m.Breakpoint||t instanceof m.ExceptionBreakpoint||t instanceof m.FunctionBreakpoint},e.prototype.getActions=function(e,t){return t instanceof m.Breakpoint?o.TPromise.as(this.getBreakpointActions()):o.TPromise.as([])},e.prototype.getBreakpointActions=function(){return[this.instantiationService.createInstance(E.RemoveBreakpointAction,E.RemoveBreakpointAction.ID,E.RemoveBreakpointAction.LABEL)]},e.prototype.getSecondaryActions=function(e,t){var n=[this.instantiationService.createInstance(E.ToggleEnablementAction,E.ToggleEnablementAction.ID,E.ToggleEnablementAction.LABEL)];return n.push(new h.Separator),(t instanceof m.Breakpoint||t instanceof m.FunctionBreakpoint)&&n.push(this.instantiationService.createInstance(E.RemoveBreakpointAction,E.RemoveBreakpointAction.ID,E.RemoveBreakpointAction.LABEL)),n.push(this.instantiationService.createInstance(E.RemoveAllBreakpointsAction,E.RemoveAllBreakpointsAction.ID,E.RemoveAllBreakpointsAction.LABEL)),n.push(new h.Separator),n.push(this.instantiationService.createInstance(E.ToggleBreakpointsActivatedAction,E.ToggleBreakpointsActivatedAction.ID,E.ToggleBreakpointsActivatedAction.ACTIVATE_LABEL)),n.push(new h.Separator),n.push(this.instantiationService.createInstance(E.EnableAllBreakpointsAction,E.EnableAllBreakpointsAction.ID,E.EnableAllBreakpointsAction.LABEL)),n.push(this.instantiationService.createInstance(E.DisableAllBreakpointsAction,E.DisableAllBreakpointsAction.ID,E.DisableAllBreakpointsAction.LABEL)),n.push(new h.Separator),n.push(this.instantiationService.createInstance(E.AddFunctionBreakpointAction,E.AddFunctionBreakpointAction.ID,E.AddFunctionBreakpointAction.LABEL)),t instanceof m.FunctionBreakpoint&&n.push(this.instantiationService.createInstance(E.RenameFunctionBreakpointAction,E.RenameFunctionBreakpointAction.ID,E.RenameFunctionBreakpointAction.LABEL)),n.push(new h.Separator),n.push(this.instantiationService.createInstance(E.ReapplyBreakpointsAction,E.ReapplyBreakpointsAction.ID,E.ReapplyBreakpointsAction.LABEL)),o.TPromise.as(n)},e.prototype.getActionItem=function(e,t,n){return null},e}();t.BreakpointsActionProvider=G;var J=function(){function e(){}return e.prototype.getId=function(e,t){return t.getId()},e.prototype.hasChildren=function(e,t){return t instanceof m.Model},e.prototype.getChildren=function(e,t){var n=t,i=n.getExceptionBreakpoints();return o.TPromise.as(i.concat(n.getFunctionBreakpoints()).concat(n.getBreakpoints()))},e.prototype.getParent=function(e,t){return o.TPromise.as(null)},e}();t.BreakpointsDataSource=J;var Q=function(){function e(e,t,n,o,i,r){this.actionProvider=e,this.actionRunner=t,this.messageService=n,this.contextService=o,this.debugService=i,this.contextViewService=r}return e.prototype.getHeight=function(e,t){return 22},e.prototype.getTemplateId=function(t,n){return n instanceof m.Breakpoint?e.BREAKPOINT_TEMPLATE_ID:n instanceof m.FunctionBreakpoint?e.FUNCTION_BREAKPOINT_TEMPLATE_ID:n instanceof m.ExceptionBreakpoint?e.EXCEPTION_BREAKPOINT_TEMPLATE_ID:null},e.prototype.renderTemplate=function(t,n,o){var i=Object.create(null);return n!==e.BREAKPOINT_TEMPLATE_ID&&n!==e.FUNCTION_BREAKPOINT_TEMPLATE_ID||(i.actionBar=new h.ActionBar(o,{actionRunner:this.actionRunner}),i.actionBar.push(this.actionProvider.getBreakpointActions(),{icon:!0,label:!1})),i.breakpoint=l.append(o,L(".breakpoint")),i.toDisposeBeforeRender=[],i.checkbox=L("input"),i.checkbox.type="checkbox",l.append(i.breakpoint,i.checkbox),i.name=l.append(i.breakpoint,L("span.name")),n===e.BREAKPOINT_TEMPLATE_ID&&(i.lineNumber=l.append(i.breakpoint,L("span.line-number")),i.filePath=l.append(i.breakpoint,L("span.file-path"))),i},e.prototype.renderElement=function(t,n,o,r){var a=this;r.toDisposeBeforeRender=i.dispose(r.toDisposeBeforeRender),r.toDisposeBeforeRender.push(l.addStandardDisposableListener(r.checkbox,"change",function(e){a.debugService.enableOrDisableBreakpoints(!n.enabled,n)})),o===e.EXCEPTION_BREAKPOINT_TEMPLATE_ID?this.renderExceptionBreakpoint(n,r):o===e.FUNCTION_BREAKPOINT_TEMPLATE_ID?this.renderFunctionBreakpoint(t,n,r):this.renderBreakpoint(t,n,r)},e.prototype.renderExceptionBreakpoint=function(e,t){t.name.textContent=e.label||e.filter+" exceptions",t.breakpoint.title=t.name.textContent,t.checkbox.checked=e.enabled},e.prototype.renderFunctionBreakpoint=function(e,t,o){var i=this.debugService.getViewModel().getSelectedFunctionBreakpoint();if(!t.name||i&&i.getId()===t.getId())_(this.debugService,this.contextViewService,e,t,o.breakpoint,{initialValue:t.name,placeholder:n.localize("functionBreakpointPlaceholder","Function to break on"),ariaLabel:n.localize("functionBreakPointInputAriaLabel","Type function breakpoint")});else{o.name.textContent=t.name,o.checkbox.checked=t.enabled,o.breakpoint.title=t.name;var r=this.debugService.getActiveSession();r&&!r.configuration.capabilities.supportsFunctionBreakpoints||!this.debugService.getModel().areBreakpointsActivated()?(e.addTraits("disabled",[t]),r&&!r.configuration.capabilities.supportsFunctionBreakpoints&&(o.breakpoint.title=n.localize("functionBreakpointsNotSupported","Function breakpoints are not supported by this debug type"))):e.removeTraits("disabled",[t])}o.actionBar.context=t},e.prototype.renderBreakpoint=function(e,t,n){this.debugService.getModel().areBreakpointsActivated()?e.removeTraits("disabled",[t]):e.addTraits("disabled",[t]),n.name.textContent=d.getPathLabel(a.basename(t.source.uri.fsPath),this.contextService),n.lineNumber.textContent=t.desiredLineNumber!==t.lineNumber?t.desiredLineNumber+" → "+t.lineNumber:""+t.lineNumber,n.filePath.textContent=d.getPathLabel(a.dirname(t.source.uri.fsPath),this.contextService),n.checkbox.checked=t.enabled,n.actionBar.context=t;var o=this.debugService.state===b.State.Running||this.debugService.state===b.State.Stopped||this.debugService.state===b.State.Initializing;o&&!t.verified?(e.addTraits("disabled",[t]),t.message&&(n.breakpoint.title=t.message)):t.condition&&(n.breakpoint.title=t.condition)},e.prototype.disposeTemplate=function(t,n,o){n!==e.BREAKPOINT_TEMPLATE_ID&&n!==e.FUNCTION_BREAKPOINT_TEMPLATE_ID||o.actionBar.dispose()},e.EXCEPTION_BREAKPOINT_TEMPLATE_ID="exceptionBreakpoint",e.FUNCTION_BREAKPOINT_TEMPLATE_ID="functionBreakpoint",e.BREAKPOINT_TEMPLATE_ID="breakpoint",e=__decorate([__param(2,T.IMessageService),__param(3,k.IWorkspaceContextService),__param(4,b.IDebugService),__param(5,S.IContextViewService)],e)}();t.BreakpointsRenderer=Q;var Y=function(){function e(e){this.contextService=e}return e.prototype.getAriaLabel=function(e,t){return t instanceof m.Breakpoint?n.localize("breakpointAriaLabel","Breakpoint line {0} {1}, breakpoints, debug",t.lineNumber,B(t.source,this.contextService)):t instanceof m.FunctionBreakpoint?n.localize("functionBreakpointAriaLabel","Function breakpoint {0}, breakpoints, debug",t.name):t instanceof m.ExceptionBreakpoint?n.localize("exceptionBreakpointAriaLabel","Exception breakpoint {0}, breakpoints, debug",t.filter):null},e=__decorate([__param(0,k.IWorkspaceContextService)],e)}();t.BreakpointsAccessibilityProvider=Y;var Z=function(e){function t(t,n,o){e.call(this,t,n,o),u.isMacintosh?this.downKeyBindingDispatcher.set(r.CommonKeybindings.ENTER,this.onRename.bind(this)):this.downKeyBindingDispatcher.set(r.CommonKeybindings.F2,this.onRename.bind(this))}return __extends(t,e),t.prototype.onLeftClick=function(t,n,o){return n instanceof m.FunctionBreakpoint&&2===o.detail?(this.debugService.getViewModel().setSelectedFunctionBreakpoint(n),!0):(n instanceof m.Breakpoint&&this.openBreakpointSource(n,o,!0),e.prototype.onLeftClick.call(this,t,n,o))},t.prototype.onRename=function(t,n){var o=t.getFocus();return o instanceof m.FunctionBreakpoint&&o.name?(this.debugService.getViewModel().setSelectedFunctionBreakpoint(o),!0):(o instanceof m.Breakpoint&&this.openBreakpointSource(o,n,!1),e.prototype.onEnter.call(this,t,n))},t.prototype.onSpace=function(t,n){e.prototype.onSpace.call(this,t,n);var o=t.getFocus();return this.debugService.enableOrDisableBreakpoints(!o.enabled,o).done(null,c.onUnexpectedError),!0},t.prototype.onDelete=function(e,t){var n=e.getFocus();if(n instanceof m.Breakpoint)return this.debugService.removeBreakpoints(n.getId()).done(null,c.onUnexpectedError),!0;if(n instanceof m.FunctionBreakpoint){var o=n;return this.debugService.removeFunctionBreakpoints(o.getId()).done(null,c.onUnexpectedError),!0}return!1},t.prototype.openBreakpointSource=function(e,t,n){if(!e.source.inMemory){var o=t&&(t.ctrlKey||t.metaKey);this.debugService.openOrRevealSource(e.source,e.lineNumber,n,o).done(null,c.onUnexpectedError)}},t}(R);t.BreakpointsController=Z});