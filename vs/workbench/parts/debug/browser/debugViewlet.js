/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},__decorate=this&&this.__decorate||function(e,t,i,s){var o,n=arguments.length,r=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,s);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r},__param=this&&this.__param||function(e,t){return function(i,s){t(i,s,e)}};define(["require","exports","vs/nls","vs/base/browser/builder","vs/base/common/winjs.base","vs/base/common/lifecycle","vs/base/browser/ui/splitview/splitview","vs/workbench/common/memento","vs/workbench/browser/viewlet","vs/workbench/parts/debug/common/debug","vs/workbench/parts/debug/browser/debugViewRegistry","vs/workbench/parts/debug/browser/debugActions","vs/workbench/parts/debug/browser/debugActionItems","vs/platform/instantiation/common/instantiation","vs/platform/progress/common/progress","vs/platform/workspace/common/workspace","vs/platform/telemetry/common/telemetry","vs/platform/storage/common/storage","vs/css!./media/debugViewlet"],function(e,t,i,s,o,n,r,c,a,p,u,l,h,g,v,f,d,w){"use strict";var b=p.IDebugService,m=s.$,S=function(e){function t(t,i,s,o,n,r){var a=this;e.call(this,p.VIEWLET_ID,t),this.progressService=i,this.debugService=s,this.instantiationService=o,this.contextService=n,this.progressRunner=null,this.viewletSettings=this.getMemento(r,c.Scope.WORKSPACE),this.toDispose=[],this.views=[],this.toDispose.push(this.debugService.onDidChangeState(function(e){a.onDebugServiceStateChange(e)}))}return __extends(t,e),t.prototype.create=function(t){var s=this;if(e.prototype.create.call(this,t),this.$el=t.div().addClass("debug-viewlet"),this.contextService.getWorkspace()){var n=this.getActionRunner();this.views=u.DebugViewRegistry.getDebugViews().map(function(e){return s.instantiationService.createInstance(e,n,s.viewletSettings)}),this.splitView=new r.SplitView(this.$el.getHTMLElement()),this.toDispose.push(this.splitView),this.views.forEach(function(e){return s.splitView.addView(e)}),this.toDispose.push(this.splitView.onFocus(function(e){s.lastFocusedView=e}))}else this.$el.append(m(['<div class="noworkspace-view">',"<p>",i.localize("noWorkspace","There is no currently opened folder."),"</p>","<p>",i.localize("pleaseRestartToDebug","Open a folder in order to start debugging."),"</p>","</div>"].join("")));return o.TPromise.as(null)},t.prototype.setVisible=function(t){var i=this;return e.prototype.setVisible.call(this,t).then(function(){return o.TPromise.join(i.views.map(function(e){return e.setVisible(t)}))})},t.prototype.layout=function(e){this.splitView&&this.splitView.layout(e.height)},t.prototype.focus=function(){return e.prototype.focus.call(this),this.lastFocusedView&&this.lastFocusedView.isExpanded()?void this.lastFocusedView.focusBody():void(this.views.length>0&&this.views[0].focusBody())},t.prototype.getActions=function(){var e=this;return this.debugService.state===p.State.Disabled?[]:(this.actions||(this.actions=[this.instantiationService.createInstance(l.StartDebugAction,l.StartDebugAction.ID,l.StartDebugAction.LABEL),this.instantiationService.createInstance(l.SelectConfigAction,l.SelectConfigAction.ID,l.SelectConfigAction.LABEL),this.instantiationService.createInstance(l.ConfigureAction,l.ConfigureAction.ID,l.ConfigureAction.LABEL),this.instantiationService.createInstance(l.ToggleReplAction,l.ToggleReplAction.ID,l.ToggleReplAction.LABEL)],this.actions.forEach(function(t){e.toDispose.push(t)})),this.actions)},t.prototype.getActionItem=function(e){return e.id===l.SelectConfigAction.ID?this.instantiationService.createInstance(h.DebugSelectActionItem,e):null},t.prototype.onDebugServiceStateChange=function(e){this.progressRunner&&this.progressRunner.done(),e===p.State.Initializing?this.progressRunner=this.progressService.show(!0):this.progressRunner=null},t.prototype.dispose=function(){this.toDispose=n.dispose(this.toDispose),e.prototype.dispose.call(this)},t.prototype.shutdown=function(){this.views.forEach(function(e){return e.shutdown()}),e.prototype.shutdown.call(this)},t=__decorate([__param(0,d.ITelemetryService),__param(1,v.IProgressService),__param(2,b),__param(3,g.IInstantiationService),__param(4,f.IWorkspaceContextService),__param(5,w.IStorageService)],t)}(a.Viewlet);t.DebugViewlet=S});