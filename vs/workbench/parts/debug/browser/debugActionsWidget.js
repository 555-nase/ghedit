/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
var __decorate=this&&this.__decorate||function(t,e,i,s){var o,n=arguments.length,r=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(n<3?o(r):n>3?o(e,i,r):o(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},__param=this&&this.__param||function(t,e){return function(i,s){e(i,s,t)}};define(["require","exports","vs/base/common/lifecycle","vs/base/common/errors","vs/base/common/severity","vs/base/browser/builder","vs/base/browser/dom","vs/base/browser/mouseEvent","vs/base/common/events","vs/base/browser/ui/actionbar/actionbar","vs/workbench/common/constants","vs/workbench/parts/debug/common/debug","vs/workbench/parts/debug/browser/debugActions","vs/platform/instantiation/common/instantiation","vs/platform/storage/common/storage","vs/platform/message/common/message","vs/platform/telemetry/common/telemetry"],function(t,e,i,s,o,n,r,a,c,u,h,p,d,g,v,b,l){"use strict";var A=p.IDebugService,m=n.$,S="debug.actionswidgetposition",D=function(){function t(t,e,i,s,o){this.messageService=t,this.telemetryService=e,this.debugService=i,this.instantiationService=s,this.storageService=o,this.$el=m().div().addClass("debug-actions-widget"),this.dragArea=m().div().addClass("drag-area"),this.$el.append(this.dragArea);var n=m().div().addClass(".action-bar-container");this.$el.append(n),this.toDispose=[],this.actionBar=new u.ActionBar(n,{orientation:u.ActionsOrientation.HORIZONTAL}),this.toDispose.push(this.actionBar),this.registerListeners(),this.hide(),this.isBuilt=!1}return t.prototype.registerListeners=function(){var t=this;this.toDispose.push(this.debugService.onDidChangeState(function(e){t.onDebugStateChange(e)})),this.toDispose.push(this.actionBar.actionRunner.addListener2(c.EventType.RUN,function(e){e.error&&!s.isPromiseCanceledError(e.error)&&t.messageService.show(o["default"].Error,e.error),t.telemetryService&&t.telemetryService.publicLog("workbenchActionExecuted",{id:e.action.id,from:"debugActionsWidget"})})),m(window).on(r.EventType.RESIZE,function(){return t.setXCoordinate()},this.toDispose),this.dragArea.on(r.EventType.MOUSE_UP,function(e){var i=new a.StandardMouseEvent(e);2===i.detail&&t.setXCoordinate(.5*window.innerWidth)}),this.dragArea.on(r.EventType.MOUSE_DOWN,function(e){var i=m(window);t.dragArea.addClass("dragged"),i.on("mousemove",function(e){var i=new a.StandardMouseEvent(e);i.preventDefault(),t.setXCoordinate(i.posx)}).once("mouseup",function(e){var s=new a.StandardMouseEvent(e);t.storageService.store(S,s.posx/window.innerWidth,v.StorageScope.WORKSPACE),t.dragArea.removeClass("dragged"),i.off("mousemove")})})},t.prototype.setXCoordinate=function(t){if(this.isVisible){t||(t=parseFloat(this.storageService.get(S,v.StorageScope.WORKSPACE,"0.5"))*window.innerWidth);var e=this.$el.getHTMLElement().clientWidth/2;t=t+e-16,t=Math.max(148,t),t=Math.min(t,window.innerWidth-e-10),this.$el.style("left",t+"px")}},t.prototype.getId=function(){return t.ID},t.prototype.onDebugStateChange=function(t){return t===p.State.Disabled||t===p.State.Inactive?this.hide():(this.actionBar.clear(),this.actionBar.push(this.getActions(this.instantiationService,this.debugService.state),{icon:!0,label:!1}),void this.show())},t.prototype.show=function(){this.isVisible||(this.isBuilt||(this.isBuilt=!0,this.$el.build(n.withElementById(h.Identifiers.WORKBENCH_CONTAINER).getHTMLElement())),this.isVisible=!0,this.$el.show(),this.setXCoordinate())},t.prototype.hide=function(){this.isVisible=!1,this.$el.hide()},t.prototype.getActions=function(t,e){var i=this;this.actions||(this.continueAction=t.createInstance(d.ContinueAction,d.ContinueAction.ID,d.ContinueAction.LABEL),this.pauseAction=t.createInstance(d.PauseAction,d.PauseAction.ID,d.PauseAction.LABEL),this.actions=[this.continueAction,t.createInstance(d.StepOverDebugAction,d.StepOverDebugAction.ID,d.StepOverDebugAction.LABEL),t.createInstance(d.StepIntoDebugAction,d.StepIntoDebugAction.ID,d.StepIntoDebugAction.LABEL),t.createInstance(d.StepOutDebugAction,d.StepOutDebugAction.ID,d.StepOutDebugAction.LABEL),t.createInstance(d.RestartDebugAction,d.RestartDebugAction.ID,d.RestartDebugAction.LABEL),t.createInstance(d.StopDebugAction,d.StopDebugAction.ID,d.StopDebugAction.LABEL)],this.actions.forEach(function(t){i.toDispose.push(t)}),this.toDispose.push(this.pauseAction),this.toDispose.push(this.continueAction)),this.actions[0]=e===p.State.Running?this.pauseAction:this.continueAction;var s=this.debugService.getActiveSession();return s&&s.configuration.capabilities.supportsStepBack?(this.stepBackAction||(this.stepBackAction=t.createInstance(d.StepBackDebugAction,d.StepBackDebugAction.ID,d.StepBackDebugAction.LABEL),this.toDispose.push(this.stepBackAction)),this.actions.slice(0,4).concat([this.stepBackAction],this.actions.slice(4))):this.actions},t.prototype.dispose=function(){this.toDispose=i.dispose(this.toDispose),this.$el&&(this.$el.destroy(),delete this.$el)},t.ID="debug.actionsWidget",t=__decorate([__param(0,b.IMessageService),__param(1,l.ITelemetryService),__param(2,A),__param(3,g.IInstantiationService),__param(4,v.IStorageService)],t)}();e.DebugActionsWidget=D});