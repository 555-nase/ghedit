/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
define(["require","exports","fs","graceful-fs","vs/base/common/winjs.base","vs/platform/files/common/files","vs/workbench/services/search/node/fileSearch","vs/workbench/services/search/node/textSearch"],function(e,n,r,t,c,i,o,a){"use strict";t.gracefulify(r);var s=function(){function e(){}return e.prototype.fileSearch=function(n){var r=new o.Engine(n);return this.doSearch(r,e.BATCH_SIZE)},e.prototype.textSearch=function(n){var r=new a.Engine(n,new o.FileWalker({rootFolders:n.rootFolders,extraFiles:n.extraFiles,includePattern:n.includePattern,excludePattern:n.excludePattern,filePattern:n.filePattern,maxFilesize:i.MAX_FILE_SIZE}));return this.doSearch(r,e.BATCH_SIZE)},e.prototype.doSearch=function(e,n){return new c.PPromise(function(r,t,c){var i=[];e.search(function(e){e&&(n?(i.push(e),n>0&&i.length>=n&&(c(i),i=[])):c(e))},function(e){c(e)},function(e,n){i.length&&c(i),e?t(e):r(n)})},function(){return e.cancel()})},e.BATCH_SIZE=500,e}();n.SearchService=s});