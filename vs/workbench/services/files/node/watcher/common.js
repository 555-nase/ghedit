/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
define(["require","exports","vs/base/common/uri","vs/base/common/paths","vs/platform/files/common/files"],function(e,t,n,i,a){"use strict";function r(e){return new a.FileChangesEvent(e.map(function(e){return{type:e.type,resource:n["default"].file(e.path)}}))}function o(e){for(var t=new p,n=0;n<e.length;n++){var i=e[n];t.processEvent(i)}return t.normalize()}t.toFileChangesEvent=r,t.normalize=o;var p=function(){function e(){this.normalized=[],this.mapPathToChange=Object.create(null)}return e.prototype.processEvent=function(e){var t=this.mapPathToChange[e.path];if(t){var n=t.type,i=e.type;n===a.FileChangeType.ADDED&&i===a.FileChangeType.DELETED?(delete this.mapPathToChange[e.path],this.normalized.splice(this.normalized.indexOf(t),1)):n===a.FileChangeType.DELETED&&i===a.FileChangeType.ADDED?t.type=a.FileChangeType.UPDATED:n===a.FileChangeType.ADDED&&i===a.FileChangeType.UPDATED||(t.type=i)}else this.normalized.push(e),this.mapPathToChange[e.path]=e},e.prototype.normalize=function(){var e=this,t=[],n=[];return this.normalized.filter(function(e){return 2===e.type||(t.push(e),!1)}).sort(function(e,t){return e.path.length-t.path.length}).filter(function(t){return!n.some(function(n){return e.isParent(t.path,n)})&&(n.push(t.path),!0)}).concat(t)},e.prototype.isParent=function(e,t){return 0===e.indexOf(t+i.nativeSep)},e}()});