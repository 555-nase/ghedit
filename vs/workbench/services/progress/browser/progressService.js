var __extends=this&&this.__extends||function(e,t){function s(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(s.prototype=t.prototype,new s)};define(["require","exports","vs/base/common/winjs.base","vs/base/common/types","vs/workbench/common/events"],function(e,t,s,r,i){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";var o=function(){function e(e,t){this._eventService=e,this.scopeId=t,this.registerListeners()}return Object.defineProperty(e.prototype,"eventService",{get:function(){return this._eventService},enumerable:!0,configurable:!0}),e.prototype.registerListeners=function(){var e=this;this.eventService.addListener2(i.EventType.COMPOSITE_CLOSED,function(t){t.compositeId===e.scopeId&&e.onScopeDeactivated()}),this.eventService.addListener2(i.EventType.COMPOSITE_OPENED,function(t){t.compositeId===e.scopeId&&e.onScopeActivated()})},e}();t.ScopedService=o;var n=function(e){function t(t,s,i,o){e.call(this,t,i),this.progressbar=s,this.isActive=o||r.isUndefinedOrNull(i),this.progressState=Object.create(null)}return __extends(t,e),t.prototype.onScopeDeactivated=function(){this.isActive=!1},t.prototype.onScopeActivated=function(){this.isActive=!0,this.progressState.done||(this.progressState.whilePromise?this.doShowWhile():this.progressState.infinite?this.progressbar.infinite().getContainer().show():(this.progressState.total&&this.progressbar.total(this.progressState.total).getContainer().show(),this.progressState.worked&&this.progressbar.worked(this.progressState.worked).getContainer().show()))},t.prototype.clearProgressState=function(){this.progressState.infinite=void 0,this.progressState.done=void 0,this.progressState.worked=void 0,this.progressState.total=void 0,this.progressState.whilePromise=void 0},t.prototype.show=function(e,t){var s,i,o=this;return e===!1||e===!0?s=e:i=e,this.clearProgressState(),this.progressState.infinite=s,this.progressState.total=i,this.isActive&&(r.isUndefinedOrNull(s)?r.isUndefinedOrNull(i)||(r.isUndefinedOrNull(t)?this.progressbar.total(i).getContainer().show():this.progressbar.total(i).getContainer().showDelayed(t)):r.isUndefinedOrNull(t)?this.progressbar.infinite().getContainer().show():this.progressbar.infinite().getContainer().showDelayed(t)),{total:function(e){o.progressState.infinite=!1,o.progressState.total=e,o.isActive&&o.progressbar.total(e)},worked:function(e){!o.isActive||o.progressbar.hasTotal()?(o.progressState.infinite=!1,o.progressState.worked?o.progressState.worked+=e:o.progressState.worked=e,o.isActive&&o.progressbar.worked(e)):(o.progressState.infinite=!0,o.progressState.worked=void 0,o.progressState.total=void 0,o.progressbar.infinite().getContainer().show())},done:function(){o.progressState.infinite=!1,o.progressState.done=!0,o.isActive&&o.progressbar.stop().getContainer().hide()}}},t.prototype.showWhile=function(e,t){var r=this,i=!!this.progressState.whilePromise;i?e=s.TPromise.join([e,this.progressState.whilePromise]):this.clearProgressState(),this.progressState.whilePromise=e;var o=function(){r.progressState.whilePromise&&r.progressState.whilePromise!==e||(r.clearProgressState(),r.isActive&&r.progressbar.stop().getContainer().hide())};return this.doShowWhile(t),e.then(o,o)},t.prototype.doShowWhile=function(e){this.isActive&&(r.isUndefinedOrNull(e)?this.progressbar.infinite().getContainer().show():this.progressbar.infinite().getContainer().showDelayed(e))},t}(o);t.WorkbenchProgressService=n});