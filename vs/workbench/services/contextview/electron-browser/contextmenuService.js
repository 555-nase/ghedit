/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
var __decorate=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},__param=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};define(["require","exports","vs/base/common/winjs.base","vs/base/common/severity","vs/base/browser/ui/actionbar/actionbar","vs/base/browser/dom","vs/platform/contextview/browser/contextView","vs/platform/telemetry/common/telemetry","vs/platform/message/common/message","vs/platform/keybinding/common/keybinding","electron"],function(e,t,n,r,o,i,a,c,s,u,l){"use strict";var m=function(){function e(e,t,n){this.messageService=e,this.telemetryService=t,this.keybindingService=n}return e.prototype.showContextMenu=function(e){var t=this;e.getActions().then(function(r){return r.length?n.TPromise.timeout(0).then(function(){var n,o,a=t.createMenu(e,r),c=e.getAnchor();if(i.isHTMLElement(c)){var s=i.getDomNodePagePosition(c);n=s.left,o=s.top+s.height}else{var u=c;n=u.x,o=u.y}var m=l.webFrame.getZoomFactor();n*=m,o*=m,a.popup(l.remote.getCurrentWindow(),Math.floor(n),Math.floor(o),-1),e.onHide&&e.onHide(void 0)}):n.TPromise.as(null)})},e.prototype.createMenu=function(e,t){var n=this,r=new l.remote.Menu;return t.forEach(function(t){if(t instanceof o.Separator)r.append(new l.remote.MenuItem({type:"separator"}));else if(t instanceof a.ContextSubMenu){var i=new l.remote.MenuItem({submenu:n.createMenu(e,t.entries),label:t.label});r.append(i)}else{var c=e.getKeyBinding?e.getKeyBinding(t):void 0,s=c&&n.keybindingService.getElectronAcceleratorFor(c),u=new l.remote.MenuItem({label:t.label,checked:!!t.checked,accelerator:s,enabled:!!t.enabled,click:function(){n.runAction(t,e)}});r.append(u)}}),r},e.prototype.runAction=function(e,t){var o=this;this.telemetryService.publicLog("workbenchActionExecuted",{id:e.id,from:"contextMenu"});var i=t.getActionsContext?t.getActionsContext():null,a=e.run(i)||n.TPromise.as(null);a.done(null,function(e){return o.messageService.show(r["default"].Error,e)})},e=__decorate([__param(0,s.IMessageService),__param(1,c.ITelemetryService),__param(2,u.IKeybindingService)],e)}();t.ContextMenuService=m});