/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
var __decorate=this&&this.__decorate||function(e,o,t,n){var r,i=arguments.length,s=i<3?o:null===n?n=Object.getOwnPropertyDescriptor(o,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,o,t,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(s=(i<3?r(s):i>3?r(o,t,s):r(o,t))||s);return i>3&&s&&Object.defineProperty(o,t,s),s},__param=this&&this.__param||function(e,o){return function(t,n){o(t,n,e)}};define(["require","exports","vs/base/common/platform","vs/base/browser/dom","vs/base/browser/dnd","vs/base/browser/builder","vs/workbench/common/constants","vs/workbench/common/editor","vs/workbench/services/viewlet/common/viewletService","vs/workbench/services/editor/common/editorService","vs/platform/storage/common/storage","vs/platform/event/common/event","vs/platform/workspace/common/workspace","vs/workbench/services/group/common/groupService","electron","fs","path"],function(e,o,t,n,r,i,s,c,d,a,p,v,u,w,f,l,h){"use strict";var m,E=f.remote.dialog;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.FILE=1]="FILE",e[e.EXTENSION=2]="EXTENSION",e[e.FOLDER=3]="FOLDER"}(m||(m={}));var y=function(){function e(e,o,t,n,r,i,s,c){this.contextService=t,this.eventService=n,this.storageService=r,this.editorService=i,this.editorGroupService=s,this.viewletService=c,this.win=e,this.windowId=e.id,this.registerListeners()}return e.prototype.registerListeners=function(){function e(){d=void 0,a&&(a.destroy(),a=void 0)}var o=this;t.platform===t.Platform.Mac&&this.editorGroupService.onEditorsChanged(function(){var e=c.asFileEditorInput(o.editorService.getActiveEditorInput(),!0),t="";e&&(t=e.getResource().fsPath),f.ipcRenderer.send("vscode:setRepresentedFilename",o.windowId,t)});var d,a;window.document.body.addEventListener(n.EventType.DRAG_OVER,function(t){n.EventHelper.stop(t),d||(d=r.extractResources(t,!0),d.some(function(e){var t=o.getFileKind(e);return t===m.FOLDER||t===m.EXTENSION})&&(a=i.$(window.document.getElementById(s.Identifiers.WORKBENCH_CONTAINER)).div({id:"monaco-workbench-drop-overlay"}).on(n.EventType.DROP,function(t){n.EventHelper.stop(t,!0),o.focus(),f.ipcRenderer.send("vscode:windowOpen",d.map(function(e){return e.fsPath})),e()}).on([n.EventType.DRAG_LEAVE,n.EventType.DRAG_END],function(){e()})))}),[n.EventType.DROP,n.EventType.DRAG_END].forEach(function(o){window.document.body.addEventListener(o,function(o){a&&o.target===a.getHTMLElement()||e()},!0)}),window.document.body.addEventListener(n.EventType.DROP,function(e){n.EventHelper.stop(e)}),window.open=function(e,o,t,n){return f.shell.openExternal(e),null};var p=window.focus,v=this;window.focus=function(){p.call(this,arguments),v.focus()}},e.prototype.getFileKind=function(e){if(".vsix"===h.extname(e.fsPath))return m.EXTENSION;var o=m.UNKNOWN;try{o=l.statSync(e.fsPath).isDirectory()?m.FOLDER:m.FILE}catch(t){}return o},e.prototype.openNew=function(){f.ipcRenderer.send("vscode:openNewWindow")},e.prototype.close=function(){this.win.close()},e.prototype.reload=function(){f.ipcRenderer.send("vscode:reloadWindow",this.windowId)},e.prototype.showMessageBox=function(e){return E.showMessageBox(this.win,e)},e.prototype.showSaveDialog=function(e,o){return o?E.showSaveDialog(this.win,e,o):E.showSaveDialog(this.win,e)},e.prototype.setFullScreen=function(e){f.ipcRenderer.send("vscode:setFullScreen",this.windowId,e)},e.prototype.openDevTools=function(){f.ipcRenderer.send("vscode:openDevTools",this.windowId)},e.prototype.setMenuBarVisibility=function(e){f.ipcRenderer.send("vscode:setMenuBarVisibility",this.windowId,e)},e.prototype.focus=function(){f.ipcRenderer.send("vscode:focusWindow",this.windowId)},e.prototype.flashFrame=function(){f.ipcRenderer.send("vscode:flashFrame",this.windowId)},e=__decorate([__param(2,u.IWorkspaceContextService),__param(3,v.IEventService),__param(4,p.IStorageService),__param(5,a.IWorkbenchEditorService),__param(6,w.IEditorGroupService),__param(7,d.IViewletService)],e)}();o.ElectronWindow=y});