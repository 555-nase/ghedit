define(["require","exports","vs/base/common/winjs.base","vs/platform/platform","vs/base/common/types","vs/base/common/collections","vs/base/browser/ui/actionbar/actionbar"],function(t,r,o,n,e,i,s){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";function c(t){if(!t.length)return t;for(var r=0;r<t.length;r++){var o=t[r];e.isUndefinedOrNull(o.order)&&(o.order=r)}t=t.sort(function(t,r){var o=t.order,n=r.order;return o<n?-1:o>n?1:0});for(var n=-1,i=0;i<t.length;i++)if(t[i].id!==s.Separator.ID){n=i;break}if(n===-1)return[];t=t.slice(n);for(var c=t.length-1;c>=0;c--){var a=t[c].id===s.Separator.ID;if(!a)break;t.splice(c,1)}for(var u=!1,p=t.length-1;p>=0;p--){var a=t[p].id===s.Separator.ID;a&&!u?t.splice(p,1):a?a&&(u=!1):u=!0}return t}var a=function(){function t(){}return t.prototype.hasActions=function(t){return!1},t.prototype.getActions=function(t){return[]},t.prototype.hasSecondaryActions=function(t){return!1},t.prototype.getSecondaryActions=function(t){return[]},t.prototype.getActionItem=function(t,r){return null},t}();r.ActionBarContributor=a,r.Scope={GLOBAL:"global",VIEWLET:"viewlet",PANEL:"panel",EDITOR:"editor",VIEWER:"viewer"};var u=function(){function t(){this.registry=n.Registry.as(r.Extensions.Actionbar)}return t.prototype.toContext=function(t,r){return{viewer:t,element:r}},t.prototype.hasActions=function(t,o){for(var n=this.toContext(t,o),e=this.registry.getActionBarContributors(r.Scope.VIEWER),i=0;i<e.length;i++){var s=e[i];if(s.hasActions(n))return!0}return!1},t.prototype.getActions=function(t,n){for(var e=[],i=this.toContext(t,n),s=this.registry.getActionBarContributors(r.Scope.VIEWER),a=0;a<s.length;a++){var u=s[a];u.hasActions(i)&&e.push.apply(e,u.getActions(i))}return o.TPromise.as(c(e))},t.prototype.hasSecondaryActions=function(t,o){for(var n=this.toContext(t,o),e=this.registry.getActionBarContributors(r.Scope.VIEWER),i=0;i<e.length;i++){var s=e[i];if(s.hasSecondaryActions(n))return!0}return!1},t.prototype.getSecondaryActions=function(t,n){for(var e=[],i=this.toContext(t,n),s=this.registry.getActionBarContributors(r.Scope.VIEWER),a=0;a<s.length;a++){var u=s[a];u.hasSecondaryActions(i)&&e.push.apply(e,u.getSecondaryActions(i))}return o.TPromise.as(c(e))},t.prototype.getActionItem=function(t,o,n){for(var e=this.registry.getActionBarContributors(r.Scope.VIEWER),i=this.toContext(t,o),s=e.length-1;s>=0;s--){var c=e[s],a=c.getActionItem(i,n);if(a)return a}return null},t}();r.ContributableActionProvider=u,r.prepareActions=c,r.Extensions={Actionbar:"workbench.contributions.actionbar"};var p=function(){function t(){this.actionBarContributorConstructors=[],this.actionBarContributorInstances={}}return t.prototype.setInstantiationService=function(t){for(this.instantiationService=t;this.actionBarContributorConstructors.length>0;){var r=this.actionBarContributorConstructors.shift();this.createActionBarContributor(r.scope,r.ctor)}},t.prototype.createActionBarContributor=function(t,r){var o=this.instantiationService.createInstance(r),n=i.lookupOrInsert(this.actionBarContributorInstances,t,[]);n.push(o)},t.prototype.getContributors=function(t){return i.lookup(this.actionBarContributorInstances,t,[])},t.prototype.getActionBarActionsForContext=function(t,r){var o=[];return this.getContributors(t).forEach(function(t){t.hasActions(r)&&o.push.apply(o,t.getActions(r))}),o},t.prototype.getSecondaryActionBarActionsForContext=function(t,r){var o=[];return this.getContributors(t).forEach(function(t){t.hasSecondaryActions(r)&&o.push.apply(o,t.getSecondaryActions(r))}),o},t.prototype.getActionItemForContext=function(t,r,o){for(var n=this.getContributors(t),e=0;e<n.length;e++){var i=n[e],s=i.getActionItem(r,o);if(s)return s}return null},t.prototype.registerActionBarContributor=function(t,r){this.instantiationService?this.createActionBarContributor(t,r):this.actionBarContributorConstructors.push({scope:t,ctor:r})},t.prototype.getActionBarContributors=function(t){return this.getContributors(t).slice(0)},t}();n.Registry.add(r.Extensions.Actionbar,new p)});