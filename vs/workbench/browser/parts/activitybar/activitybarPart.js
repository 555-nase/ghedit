/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},__decorate=this&&this.__decorate||function(e,t,i,r){var o,n=arguments.length,s=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(n<3?o(s):n>3?o(t,i,s):o(t,i))||s);return n>3&&s&&Object.defineProperty(t,i,s),s},__param=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};define(["require","exports","vs/nls","vs/base/common/winjs.base","vs/base/browser/builder","vs/base/common/errors","vs/base/browser/ui/actionbar/actionbar","vs/platform/platform","vs/workbench/common/events","vs/workbench/browser/viewlet","vs/workbench/browser/part","vs/workbench/browser/parts/activitybar/activityAction","vs/workbench/services/viewlet/common/viewletService","vs/workbench/services/part/common/partService","vs/platform/contextview/browser/contextView","vs/platform/event/common/event","vs/platform/instantiation/common/instantiation","vs/platform/message/common/message","vs/platform/telemetry/common/telemetry","vs/platform/keybinding/common/keybinding","vs/css!./media/activitybarpart"],function(e,t,i,r,o,n,s,c,a,v,l,p,h,d,w,m,u,f,y,b){"use strict";var S=function(e){function t(t,i,r,o,n,s,c,a){e.call(this,t),this.viewletService=i,this.messageService=r,this.telemetryService=o,this.eventService=n,this.contextMenuService=s,this.keybindingService=c,this.instantiationService=a,this.activityActionItems={},this.viewletIdToActions={},this.registerListeners()}return __extends(t,e),t.prototype.registerListeners=function(){var e=this;this.toUnbind.push(this.eventService.addListener2(a.EventType.COMPOSITE_OPENING,function(t){return e.onCompositeOpening(t)})),this.toUnbind.push(this.eventService.addListener2(a.EventType.COMPOSITE_CLOSED,function(t){return e.onCompositeClosed(t)}))},t.prototype.onCompositeOpening=function(e){if(this.viewletIdToActions[e.compositeId]){this.viewletIdToActions[e.compositeId].activate();for(var t in this.viewletIdToActions)this.viewletIdToActions.hasOwnProperty(t)&&t!==e.compositeId&&this.viewletIdToActions[t].deactivate()}},t.prototype.onCompositeClosed=function(e){this.viewletIdToActions[e.compositeId]&&this.viewletIdToActions[e.compositeId].deactivate()},t.prototype.showActivity=function(e,t,i){var r=this.viewletIdToActions[e];r&&(r.setBadge(t),i&&(r["class"]=i))},t.prototype.clearActivity=function(e){this.showActivity(e,null)},t.prototype.createContentArea=function(e){var t=o.$(e),i=o.$(".content").appendTo(t);return this.createViewletSwitcher(i.clone()),i},t.prototype.createViewletSwitcher=function(e){var t=this;this.viewletSwitcherBar=new s.ActionBar(e,{actionItemProvider:function(e){return t.activityActionItems[e.id]},orientation:s.ActionsOrientation.VERTICAL,ariaLabel:i.localize("activityBarAriaLabel","Active View Switcher")}),this.viewletSwitcherBar.getContainer().addClass("position-top");var r=this.viewletService.getActiveViewlet(),o=c.Registry.as(v.Extensions.Viewlets),n=o.getViewlets(),a={label:!0,icon:!0},l=function(e){var i=t.instantiationService.createInstance(_,e.id+".activity-bar-action",e),o=null,n=t.keybindingService.lookupKeybindings(e.id).map(function(e){return t.keybindingService.getLabelFor(e)});return n&&n.length&&(o=n[0]),t.activityActionItems[i.id]=new p.ActivityActionItem(i,e.name,o),t.viewletIdToActions[e.id]=i,r&&r.getId()===e.id&&i.activate(),i};this.viewletSwitcherBar.push(n.filter(function(e){return!e.isGlobal}).sort(function(e,t){return e.order-t.order}).map(l),a)},t.prototype.dispose=function(){this.viewletSwitcherBar&&(this.viewletSwitcherBar.dispose(),this.viewletSwitcherBar=null),this.globalToolBar&&(this.globalToolBar.dispose(),this.globalToolBar=null),e.prototype.dispose.call(this)},t=__decorate([__param(1,h.IViewletService),__param(2,f.IMessageService),__param(3,y.ITelemetryService),__param(4,m.IEventService),__param(5,w.IContextMenuService),__param(6,b.IKeybindingService),__param(7,u.IInstantiationService)],t)}(l.Part);t.ActivitybarPart=S;var _=function(e){function t(t,i,r,o){e.call(this,t,i.name,i.cssClass),this.viewletService=r,this.partService=o,this.lastRun=0,this.viewlet=i}return __extends(t,e),t.prototype.run=function(){var e=Date.now();if(e-this.lastRun<t.preventDoubleClickDelay)return r.TPromise.as(!0);this.lastRun=e;var i=this.partService.isSideBarHidden(),o=this.viewletService.getActiveViewlet();return!i&&o&&o.getId()===this.viewlet.id?this.partService.setSideBarHidden(!0):(this.viewletService.openViewlet(this.viewlet.id,!0).done(null,n.onUnexpectedError),this.activate()),r.TPromise.as(!0)},t.preventDoubleClickDelay=300,t=__decorate([__param(2,h.IViewletService),__param(3,d.IPartService)],t)}(p.ActivityAction)});