/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)},__decorate=this&&this.__decorate||function(e,t,o,i){var n,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,o,s):n(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s},__param=this&&this.__param||function(e,t){return function(o,i){t(o,i,e)}};define(["require","exports","vs/base/common/objects","vs/editor/browser/widget/codeEditorWidget","vs/workbench/common/events","vs/workbench/browser/parts/editor/baseEditor","vs/editor/common/config/commonEditorConfig","vs/workbench/services/workspace/common/contextService","vs/platform/storage/common/storage","vs/platform/configuration/common/configuration","vs/platform/event/common/event","vs/platform/instantiation/common/instantiation","vs/platform/message/common/message","vs/platform/telemetry/common/telemetry","vs/workbench/services/editor/common/editorService","vs/editor/common/services/modeService","vs/workbench/services/themes/common/themeService"],function(e,t,o,i,n,r,s,a,c,p,u,h,d,f,g,v,l){"use strict";var m=function(e){function t(t,o,i,r,s,a,c,p,u,h,d){var f=this;e.call(this,t,o),this._instantiationService=i,this._contextService=r,this._storageService=s,this._messageService=a,this.configurationService=c,this._eventService=p,this._editorService=u,this._modeService=h,this._themeService=d,this._hasPendingConfigurationChange=!1,this.toUnbind.push(this._eventService.addListener2(n.EventType.WORKBENCH_OPTIONS_CHANGED,function(e){return f.handleConfigurationChangeEvent()})),this.toUnbind.push(this.configurationService.onDidUpdateConfiguration(function(e){return f.handleConfigurationChangeEvent(e.config)})),this.toUnbind.push(d.onDidThemeChange(function(e){return f.handleConfigurationChangeEvent()}))}return __extends(t,e),Object.defineProperty(t.prototype,"instantiationService",{get:function(){return this._instantiationService},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contextService",{get:function(){return this._contextService},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"storageService",{get:function(){return this._storageService},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"messageService",{get:function(){return this._messageService},enumerable:!0,configurable:!0}),t.prototype.handleConfigurationChangeEvent=function(e){this.isVisible()?this.applyConfiguration(e):this._hasPendingConfigurationChange=!0},t.prototype.consumePendingConfigurationChangeEvent=function(){this._hasPendingConfigurationChange&&(this.applyConfiguration(this.configurationService.getConfiguration()),this._hasPendingConfigurationChange=!1)},t.prototype.applyConfiguration=function(e){if(this.editorControl)if(e){var t=this.getCodeEditorOptions();e=o.clone(e),o.assign(e[s.EditorConfiguration.EDITOR_SECTION],t),s.EditorConfiguration.apply(e,this.editorControl)}else this.editorControl.updateOptions(this.getCodeEditorOptions())},t.prototype.getCodeEditorOptions=function(){var e={overviewRulerLanes:3,glyphMargin:!0,lineNumbersMinChars:3,theme:this._themeService.getTheme()};return o.mixin(e,this.contextService.getOptions().editor)},Object.defineProperty(t.prototype,"eventService",{get:function(){return this._eventService},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editorService",{get:function(){return this._editorService},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editorContainer",{get:function(){return this._editorContainer},enumerable:!0,configurable:!0}),t.prototype.createEditor=function(e){this._editorContainer=e,this.editorControl=this.createEditorControl(e),this.applyConfiguration(this.configurationService.getConfiguration())},t.prototype.createEditorControl=function(e){return this._instantiationService.createInstance(i.CodeEditorWidget,e.getHTMLElement(),this.getCodeEditorOptions())},t.prototype.setInput=function(t,o){var i=this;return e.prototype.setInput.call(this,t,o).then(function(){i.editorControl.updateOptions(i.getCodeEditorOptions())})},t.prototype.setEditorVisible=function(t,o){void 0===o&&(o=null),t?(this.consumePendingConfigurationChangeEvent(),this.editorControl.onVisible()):this.editorControl.onHide(),e.prototype.setEditorVisible.call(this,t,o)},t.prototype.focus=function(){this.editorControl.focus()},t.prototype.layout=function(e){this.editorControl.layout(e)},t.prototype.getControl=function(){return this.editorControl},t.prototype.getSelection=function(){return this.editorControl.getSelection()},t.prototype.dispose=function(){this.editorControl.destroy(),e.prototype.dispose.call(this)},t=__decorate([__param(1,f.ITelemetryService),__param(2,h.IInstantiationService),__param(3,a.IWorkspaceContextService),__param(4,c.IStorageService),__param(5,d.IMessageService),__param(6,p.IConfigurationService),__param(7,u.IEventService),__param(8,g.IWorkbenchEditorService),__param(9,v.IModeService),__param(10,l.IThemeService)],t)}(r.BaseEditor);t.BaseTextEditor=m});