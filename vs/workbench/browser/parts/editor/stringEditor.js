var __extends=this&&this.__extends||function(t,e){function o(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)},__decorate=this&&this.__decorate||function(t,e,o,r){var i,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(n<3?i(a):n>3?i(e,o,a):i(e,o))||a);return n>3&&a&&Object.defineProperty(e,o,a),a},__param=this&&this.__param||function(t,e){return function(o,r){e(o,r,t)}};define(["require","exports","vs/base/common/winjs.base","vs/nls","vs/base/common/types","vs/workbench/common/editor/textEditorModel","vs/workbench/common/editor/untitledEditorInput","vs/workbench/browser/parts/editor/textEditor","vs/workbench/common/events","vs/platform/telemetry/common/telemetry","vs/workbench/services/workspace/common/contextService","vs/platform/storage/common/storage","vs/platform/configuration/common/configuration","vs/platform/event/common/event","vs/platform/instantiation/common/instantiation","vs/platform/message/common/message","vs/workbench/services/editor/common/editorService","vs/editor/common/services/modeService","vs/workbench/services/themes/common/themeService"],function(t,e,o,r,i,n,a,s,c,l,p,d,u,v,m,h,f,g,_){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";var E=function(t){function e(o,r,i,n,a,s,l,p,d,u){var v=this;t.call(this,e.ID,o,r,i,n,a,s,l,p,d,u),this.mapResourceToEditorViewState=Object.create(null),this.toUnbind.push(this.eventService.addListener2(c.EventType.UNTITLED_FILE_SAVED,function(t){return v.onUntitledSavedEvent(t)}))}return __extends(e,t),e.prototype.onUntitledSavedEvent=function(t){delete this.mapResourceToEditorViewState[t.resource.toString()]},e.prototype.getTitle=function(){return this.input?this.input.getName():r.localize("textEditor","Text Editor")},e.prototype.setInput=function(e,r){var s=this,c=this.getInput();t.prototype.setInput.call(this,e,r);var l=r&&r.forceOpen;if(!l&&e.matches(c)){var p=r;return p&&i.isFunction(p.apply)&&p.apply(this.getControl()),o.TPromise.as(null)}return c instanceof a.UntitledEditorInput&&(this.mapResourceToEditorViewState[c.getResource().toString()]=this.getControl().saveViewState()),this.editorService.resolveEditorModel(e,!0).then(function(t){if(!(t instanceof n.BaseTextEditorModel))return o.TPromise.wrapError("Invalid editor input. String editor requires a model instance of BaseTextEditorModel.");if(!s.getInput()||s.getInput()!==e)return null;var c=s.getControl(),l=t.textEditorModel;c.setModel(l);var p=!1,d=r;if(d&&i.isFunction(d.apply)&&(p=d.apply(c)),!p&&e instanceof a.UntitledEditorInput){var u=s.mapResourceToEditorViewState[e.getResource().toString()];u&&c.restoreViewState(u)}c.updateOptions(s.getCodeEditorOptions())})},e.prototype.getCodeEditorOptions=function(){var e=t.prototype.getCodeEditorOptions.call(this),o=this.getInput(),i=o instanceof a.UntitledEditorInput,n=!i;e.readOnly=n;var s,c=o&&o.getName();return s=n?c?r.localize("readonlyEditorWithInputAriaLabel","{0}. Readonly text editor.",c):r.localize("readonlyEditorAriaLabel","Readonly text editor."):c?r.localize("untitledFileEditorWithInputAriaLabel","{0}. Untitled file text editor.",c):r.localize("untitledFileEditorAriaLabel","Untitled file text editor."),e.ariaLabel=s,e},e.prototype.revealLastLine=function(){var t=this.getControl(),e=t.getModel();if(e){var o=e.getLineCount();t.revealLine(o)}},e.prototype.clearInput=function(){this.input instanceof a.UntitledEditorInput&&(this.mapResourceToEditorViewState[this.input.getResource().toString()]=this.getControl().saveViewState()),this.getControl().setModel(null),t.prototype.clearInput.call(this)},e.ID="workbench.editors.stringEditor",e=__decorate([__param(0,l.ITelemetryService),__param(1,m.IInstantiationService),__param(2,p.IWorkspaceContextService),__param(3,d.IStorageService),__param(4,h.IMessageService),__param(5,u.IConfigurationService),__param(6,v.IEventService),__param(7,f.IWorkbenchEditorService),__param(8,g.IModeService),__param(9,_.IThemeService)],e)}(s.BaseTextEditor);e.StringEditor=E});