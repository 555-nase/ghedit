var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},__decorate=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},__param=this&&this.__param||function(e,t){return function(r,o){t(r,o,e)}};define(["require","exports","vs/base/common/winjs.base","vs/base/common/async","vs/workbench/common/editor","vs/workbench/common/editor/resourceEditorModel","vs/base/common/events","vs/platform/instantiation/common/instantiation","vs/editor/common/services/modelService"],function(e,t,r,o,n,i,s,c,a){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";var u=function(e){function t(t,r,o,n,i){e.call(this),this.modelService=n,this.instantiationService=i,this.name=t,this.description=r,this.resource=o}return __extends(t,e),t.registerResourceContentProvider=function(e,r){var o=t.registry[e];return o?o.unshift(r):(o=[r],t.registry[e]=o),{dispose:function(){var o=t.registry[e],n=o.indexOf(r);n>=0&&(o.splice(n,1),0===o.length&&delete t.registry[e])}}},t.getOrCreateModel=function(e,n){var i=e.getModel(n);if(i)return r.TPromise.as(i);var s=t.loadingModels[n.toString()];if(!s){var c=t.registry[n.scheme];if(!c)return r.TPromise.wrapError("No model with uri '"+n+"' nor a resolver for the scheme '"+n.scheme+"'.");t.loadingModels[n.toString()]=s=new r.TPromise(function(e,t){var i,s;o.sequence(c.map(function(e){return function(){if(!i){var t=e.provideTextContent(n);return t?t.then(function(e){i=e},function(e){s=e}):r.TPromise.wrapError("No resolver for the scheme '"+n.scheme+"' found.")}}})).then(function(){!i&&s?t(s):e(i)},t)},function(){}),s.then(function(){return delete t.loadingModels[n.toString()]},function(){return delete t.loadingModels[n.toString()]})}return s},t.prototype.getTypeId=function(){return t.ID},t.prototype.getName=function(){return this.name},t.prototype.getDescription=function(){return this.description},t.prototype.resolve=function(e){var o=this;return this.cachedModel?r.TPromise.as(this.cachedModel):t.getOrCreateModel(this.modelService,this.resource).then(function(){var e=o.instantiationService.createInstance(i.ResourceEditorModel,o.resource),t=e.addListener2(s.EventType.DISPOSE,function(){o.cachedModel=null,t.dispose(),o.dispose()});return e.load().then(function(e){return o.cachedModel=e,o.cachedModel})})},t.prototype.matches=function(r){if(e.prototype.matches.call(this,r)===!0)return!0;if(r instanceof t){var o=r;return o.resource.toString()===this.resource.toString()}return!1},t.prototype.dispose=function(){this.cachedModel&&(this.cachedModel.dispose(),this.cachedModel=null),e.prototype.dispose.call(this)},t.loadingModels=Object.create(null),t.registry=Object.create(null),t.ID="workbench.editors.resourceEditorInput",t=__decorate([__param(3,a.IModelService),__param(4,c.IInstantiationService)],t)}(n.EditorInput);t.ResourceEditorInput=u});