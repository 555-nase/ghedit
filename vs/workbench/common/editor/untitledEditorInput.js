var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},__decorate=this&&this.__decorate||function(e,t,i,o){var r,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(s=(n<3?r(s):n>3?r(t,i,s):r(t,i))||s);return n>3&&s&&Object.defineProperty(t,i,s),s},__param=this&&this.__param||function(e,t){return function(i,o){t(i,o,e)}};define(["require","exports","vs/base/common/winjs.base","vs/base/common/mime","vs/base/common/labels","vs/base/common/paths","vs/workbench/common/editor","vs/workbench/common/editor/untitledEditorModel","vs/platform/instantiation/common/instantiation","vs/platform/lifecycle/common/lifecycle","vs/platform/workspace/common/workspace","vs/editor/common/services/modeService","vs/base/common/lifecycle","vs/platform/event/common/event","vs/workbench/common/events","vs/workbench/parts/files/common/files"],function(e,t,i,o,r,n,s,c,a,h,d,u,p,l,f,m){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";var v=function(e){function t(t,i,o,r,n,s,c,a,h){e.call(this),this.instantiationService=r,this.lifecycleService=n,this.contextService=s,this.modeService=c,this.textFileService=a,this.eventService=h,this.resource=t,this.hasAssociatedFilePath=i,this.modeId=o,this.toUnbind=[],this.registerListeners()}return __extends(t,e),t.prototype.registerListeners=function(){var e=this;this.toUnbind.push(this.eventService.addListener2(f.EventType.UNTITLED_FILE_SAVED,function(t){return e.onDirtyStateChange(t)})),this.toUnbind.push(this.eventService.addListener2(f.EventType.UNTITLED_FILE_DIRTY,function(t){return e.onDirtyStateChange(t)}))},t.prototype.onDirtyStateChange=function(e){e.resource.toString()===this.resource.toString()&&this._onDidChangeDirty.fire()},t.prototype.getTypeId=function(){return t.ID},t.prototype.getResource=function(){return this.resource},t.prototype.getName=function(){return this.hasAssociatedFilePath?n.basename(this.resource.fsPath):this.resource.fsPath},t.prototype.getDescription=function(){return this.hasAssociatedFilePath?r.getPathLabel(n.dirname(this.resource.fsPath),this.contextService):null},t.prototype.isDirty=function(){return this.cachedModel&&this.cachedModel.isDirty()},t.prototype.confirmSave=function(){return this.textFileService.confirmSave([this.resource])},t.prototype.save=function(){return this.textFileService.save(this.resource)},t.prototype.revert=function(){return this.cachedModel.revert(),this.dispose(),i.TPromise.as(!0)},t.prototype.suggestFileName=function(){if(!this.hasAssociatedFilePath){var e=this.getMime();if(e&&e!==o.MIME_TEXT)return o.suggestFilename(e,this.getName())}return this.getName()},t.prototype.getMime=function(){return this.cachedModel?this.modeService.getMimeForMode(this.cachedModel.getModeId()):null},t.prototype.getEncoding=function(){return this.cachedModel?this.cachedModel.getEncoding():null},t.prototype.setEncoding=function(e,t){this.cachedModel&&this.cachedModel.setEncoding(e)},t.prototype.resolve=function(e){var t=this;if(this.cachedModel)return i.TPromise.as(this.cachedModel);var o=this.createModel();return o.load().then(function(e){return t.cachedModel=e,t.cachedModel})},t.prototype.createModel=function(){var e="",t=this.modeId;if(!t&&this.hasAssociatedFilePath){var i=o.guessMimeTypes(this.resource.fsPath)[0];o.isUnspecific(i)||(t=i)}return this.instantiationService.createInstance(c.UntitledEditorModel,e,t||o.MIME_TEXT,this.resource,this.hasAssociatedFilePath)},t.prototype.matches=function(i){if(e.prototype.matches.call(this,i)===!0)return!0;if(i instanceof t){var o=i;return o.resource.toString()===this.resource.toString()}return!1},t.prototype.dispose=function(){p.dispose(this.toUnbind),this.cachedModel&&(this.cachedModel.dispose(),this.cachedModel=null),e.prototype.dispose.call(this)},t.ID="workbench.editors.untitledEditorInput",t.SCHEMA="untitled",t=__decorate([__param(3,a.IInstantiationService),__param(4,h.ILifecycleService),__param(5,d.IWorkspaceContextService),__param(6,u.IModeService),__param(7,m.ITextFileService),__param(8,l.IEventService)],t)}(s.UntitledEditorInput);t.UntitledEditorInput=v});