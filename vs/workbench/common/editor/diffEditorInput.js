var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)};define(["require","exports","vs/nls","vs/base/common/winjs.base","vs/base/common/types","vs/base/common/labels","vs/base/common/mime","vs/base/common/events","vs/workbench/common/editor","vs/workbench/common/editor/textEditorModel","vs/workbench/common/editor/diffEditorModel","vs/workbench/common/editor/textDiffEditorModel","vs/base/common/lifecycle"],function(t,e,i,o,n,r,s,d,c,p,a,u,h){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";function f(t,e,o){var n=r.getPathLabel(t.fsPath,o),s=r.getPathLabel(e.fsPath,o);return i.localize("compareLabels","{0} â†” {1}",n,s)}var l=function(t){function e(e,i,o,n,r){t.call(this,o,n),this.name=e,this.description=i,this.forceOpenAsBinary=r,this._toUnbind=[],this.registerListeners()}return __extends(e,t),e.prototype.registerListeners=function(){var t=this;this._toUnbind.push(this.originalInput.addListener2(d.EventType.DISPOSE,function(){t.isDisposed()||t.dispose()})),this._toUnbind.push(this.modifiedInput.addListener2(d.EventType.DISPOSE,function(){t.isDisposed()||t.dispose()})),this._toUnbind.push(this.modifiedInput.onDidChangeDirty(function(){return t._onDidChangeDirty.fire()}))},Object.defineProperty(e.prototype,"toUnbind",{get:function(){return this._toUnbind},enumerable:!0,configurable:!0}),e.prototype.getTypeId=function(){return e.ID},e.prototype.getName=function(){return this.name},e.prototype.getDescription=function(){return this.description},e.prototype.setOriginalInput=function(t){this.originalInput=t},e.prototype.setModifiedInput=function(t){this.modifiedInput=t},e.prototype.resolve=function(t){var e,i=this;return e=this.cachedModel&&!t?o.TPromise.as(this.cachedModel):this.createModel(t),e.then(function(t){return i.cachedModel&&i.cachedModel.dispose(),i.cachedModel=t,i.cachedModel})},e.prototype.getPreferredEditorId=function(t){var e=this.forceOpenAsBinary||this.isBinary(this.originalInput)||this.isBinary(this.modifiedInput);return e?"workbench.editors.binaryResourceDiffEditor":"workbench.editors.textDiffEditor"},e.prototype.isBinary=function(t){var e,i=t;return n.isFunction(i.getMime)&&(e=i.getMime()),e&&s.isBinaryMime(e)},e.prototype.createModel=function(t){return o.TPromise.join([this.originalInput.resolve(t),this.modifiedInput.resolve(t)]).then(function(t){var e=t[0],i=t[1];return i instanceof p.BaseTextEditorModel&&e instanceof p.BaseTextEditorModel?new u.TextDiffEditorModel(e,i):new a.DiffEditorModel(e,i)})},e.prototype.supportsSplitEditor=function(){return!1},e.prototype.matches=function(i){if(t.prototype.matches.call(this,i)===!0)return!0;if(i){if(!(i instanceof e))return!1;var o=i;return this.originalInput.matches(o.originalInput)&&this.modifiedInput.matches(o.modifiedInput)}return!1},e.prototype.dispose=function(){this._toUnbind=h.dispose(this._toUnbind),this.cachedModel&&(this.cachedModel.dispose(),this.cachedModel=null),t.prototype.dispose.call(this)},e.ID="workbench.editors.diffEditorInput",e}(c.BaseDiffEditorInput);e.DiffEditorInput=l,e.toDiffLabel=f});