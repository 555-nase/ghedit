var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},__decorate=this&&this.__decorate||function(e,t,n,s){var o,i=arguments.length,r=i<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(i<3?o(r):i>3?o(t,n,r):o(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r},__param=this&&this.__param||function(e,t){return function(n,s){t(n,s,e)}};define(["require","exports","vs/base/common/severity","vs/platform/extensions/common/abstractExtensionService","vs/platform/extensions/common/extensionsRegistry","vs/platform/message/common/message","vs/workbench/services/thread/common/threadService","vs/platform/workspace/common/workspace","./extHost.protocol"],function(e,t,n,s,o,i,r,a,c){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";function u(e){return(e.source?"["+e.source+"]: ":"")+e.message}var h=function(e){function t(){e.call(this,!0)}return __extends(t,e),t}(s.ActivatedExtension),_=function(e){function t(){e.call(this,!1)}return __extends(t,e),t}(s.ActivatedExtension),p=function(e){function t(t,n,s){var i=this;e.call(this,!1);var r=t.getConfiguration();this._isDev=!r.env.isBuilt||!!r.env.extensionDevelopmentPath,this._messageService=s,this._threadService=n,this._proxy=this._threadService.get(c.ExtHostContext.ExtHostExtensionService),this._extensionsStatus={},o.ExtensionsRegistry.handleExtensionPoints(function(e){return i._handleMessage(e)})}return __extends(t,e),t.prototype._handleMessage=function(e){this._showMessage(e.type,u(e)),this._extensionsStatus[e.source]||(this._extensionsStatus[e.source]={messages:[]}),this._extensionsStatus[e.source].messages.push(e)},t.prototype.$localShowMessage=function(e,t){var s=!1;if(e!==n["default"].Error&&e!==n["default"].Warning||this._isDev&&(this._messageService.show(e,t),s=!0),!s)switch(e){case n["default"].Error:console.error(t);break;case n["default"].Warning:console.warn(t);break;default:console.log(t)}},t.prototype.getExtensionsStatus=function(){return this._extensionsStatus},t.prototype._showMessage=function(e,t){this._proxy.$localShowMessage(e,t),this.$localShowMessage(e,t)},t.prototype._createFailedExtension=function(){return new h},t.prototype._actualActivateExtension=function(e){var t=this;return this._proxy.$activateExtension(e).then(function(n){return t._activatedExtensions[e.id]})},t.prototype.$onExtensionHostReady=function(e,t){var n=this;o.ExtensionsRegistry.registerExtensions(e),t.forEach(function(e){return n._handleMessage(e)}),this._triggerOnReady()},t.prototype.$onExtensionActivated=function(e){this._activatedExtensions[e]=new _},t.prototype.$onExtensionActivationFailed=function(e){this._activatedExtensions[e]=new h},t=__decorate([__param(0,a.IWorkspaceContextService),__param(1,r.IThreadService),__param(2,i.IMessageService)],t)}(s.AbstractExtensionService);t.MainProcessExtensionService=p});