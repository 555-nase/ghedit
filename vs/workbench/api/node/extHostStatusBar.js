define(["require","exports","vs/platform/statusbar/common/statusbar","./extHostTypes","./extHost.protocol"],function(t,e,i,s,n){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";var o=function(){function t(e,i,n){void 0===i&&(i=s.StatusBarAlignment.Left),this._id=t.ID_GEN++,this._proxy=e,this._alignment=i,this._priority=n}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alignment",{get:function(){return this._alignment},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"priority",{get:function(){return this._priority},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(t){this._text=t,this.update()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tooltip",{get:function(){return this._tooltip},set:function(t){this._tooltip=t,this.update()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t,this.update()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"command",{get:function(){return this._command},set:function(t){this._command=t,this.update()},enumerable:!0,configurable:!0}),t.prototype.show=function(){this._visible=!0,this.update()},t.prototype.hide=function(){this._visible=!1,this._proxy.$dispose(this.id)},t.prototype.update=function(){var t=this;!this._disposed&&this._visible&&(this._timeoutHandle&&clearTimeout(this._timeoutHandle),this._timeoutHandle=setTimeout(function(){t._timeoutHandle=null,t._proxy.$setEntry(t.id,t.text,t.tooltip,t.command,t.color,t._alignment===s.StatusBarAlignment.Left?i.StatusbarAlignment.LEFT:i.StatusbarAlignment.RIGHT,t._priority)},0))},t.prototype.dispose=function(){this.hide(),this._disposed=!0},t.ID_GEN=0,t}();e.ExtHostStatusBarEntry=o;var r=function(){function t(t){this._messages=[],this._item=t.createStatusBarEntry(s.StatusBarAlignment.Left,Number.MIN_VALUE)}return t.prototype.dispose=function(){this._messages.length=0,this._item.dispose()},t.prototype.setMessage=function(t){var e=this,i={message:t};return this._messages.unshift(i),this._update(),new s.Disposable(function(){var t=e._messages.indexOf(i);t>=0&&(e._messages.splice(t,1),e._update())})},t.prototype._update=function(){this._messages.length>0?(this._item.text=this._messages[0].message,this._item.show()):this._item.hide()},t}(),u=function(){function t(t){this._proxy=t.get(n.MainContext.MainThreadStatusBar),this._statusMessage=new r(this)}return t.prototype.createStatusBarEntry=function(t,e){return new o(this._proxy,t,e)},t.prototype.setStatusBarMessage=function(t,e){var i,n=this._statusMessage.setMessage(t);return"number"==typeof e?i=setTimeout(function(){return n.dispose()},e):"undefined"!=typeof e&&e.then(function(){return n.dispose()},function(){return n.dispose()}),new s.Disposable(function(){n.dispose(),clearTimeout(i)})},t}();e.ExtHostStatusBar=u});