var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},__decorate=this&&this.__decorate||function(e,t,r,o){var c,i=arguments.length,n=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(c=e[s])&&(n=(i<3?c(n):i>3?c(t,r,n):c(t,r))||n);return i>3&&n&&Object.defineProperty(t,r,n),n},__param=this&&this.__param||function(e,t){return function(r,o){t(r,o,e)}};define(["require","exports","vs/base/common/errors","vs/platform/search/common/search","vs/platform/workspace/common/workspace","vs/platform/event/common/event","vs/workbench/services/editor/common/editorService","vs/workbench/parts/files/common/files","vs/editor/common/services/bulkEdit","vs/base/common/winjs.base","./extHost.protocol"],function(e,t,r,o,c,i,n,s,a,u,p){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";var v=function(e){function t(t,r,o,c,i){e.call(this),this._activeSearches=Object.create(null),this._searchService=t,this._workspace=r.getWorkspace(),this._textFileService=o,this._editorService=c,this._eventService=i}return __extends(t,e),t.prototype.$startSearch=function(e,t,c,i){var n=this;if(this._workspace){var s=this._searchService.search({folderResources:[this._workspace.resource],type:o.QueryType.File,maxResults:c,includePattern:(p={},p[e]=!0,p),excludePattern:(v={},v[t]=!0,v)}).then(function(e){return e.results.map(function(e){return e.resource})},function(e){if(!r.isPromiseCanceledError(e))return u.TPromise.wrapError(e)});this._activeSearches[i]=s;var a=function(){return delete n._activeSearches[i]};return s.done(a,a),s;var p,v}},t.prototype.$cancelSearch=function(e){var t=this._activeSearches[e];if(t)return delete this._activeSearches[e],t.cancel(),u.TPromise.as(!0)},t.prototype.$saveAll=function(e){return this._textFileService.saveAll(e).then(function(e){return e.results.every(function(e){return e.success===!0})})},t.prototype.$applyWorkspaceEdit=function(e){var t,r=this._editorService.getActiveEditor();if(r){var o=r.getControl();"function"==typeof o.getEditorType&&(t=o)}return a.bulkEdit(this._eventService,this._editorService,t,e).then(function(){return!0})},t=__decorate([__param(0,o.ISearchService),__param(1,c.IWorkspaceContextService),__param(2,s.ITextFileService),__param(3,n.IWorkbenchEditorService),__param(4,i.IEventService)],t)}(p.MainThreadWorkspaceShape);t.MainThreadWorkspace=v});