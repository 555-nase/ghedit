var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};define(["require","exports","vs/base/common/types","vs/base/common/winjs.base","vs/workbench/api/node/extHostTypes","vs/workbench/api/node/extHostTypeConverters","vs/base/common/objects","./extHost.protocol"],function(t,e,n,o,r,i,s,a){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";var c=function(t){function e(e,n){t.call(this),this._commands=Object.create(null),this._extHostEditors=n,this._proxy=e.get(a.MainContext.MainThreadCommands)}return __extends(e,t),e.prototype.registerCommand=function(t,e,n,o){var i=this;if(!t.trim().length)throw new Error("invalid id");if(this._commands[t])throw new Error("command with id already exists");return this._commands[t]={callback:e,thisArg:n,description:o},this._proxy.$registerCommand(t),new r.Disposable(function(){return delete i._commands[t]})},e.prototype.executeCommand=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return this._commands[t]?this.$executeContributedCommand.apply(this,[t].concat(e)):(e=s.cloneAndChange(e,function(t){return t instanceof r.Position?i.fromPosition(t):t instanceof r.Range?i.fromRange(t):t instanceof r.Location?i.location.from(t):Array.isArray(t)?void 0:t}),this._proxy.$executeCommand(t,e))},e.prototype.$executeContributedCommand=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];var r=this._commands[t];if(!r)return Promise.reject("Contributed command '"+t+"' does not exist.");var i=r.callback,s=r.thisArg,a=r.description;if(a)for(var c=0;c<a.args.length;c++)try{n.validateConstraint(e[c],a.args[c].constraint)}catch(m){return Promise.reject("Running the contributed command:'"+t+"' failed. Illegal argument '"+a.args[c].name+"' - "+a.args[c].description)}try{var d=i.apply(s,e);return Promise.resolve(d)}catch(m){return Promise.reject("Running the contributed command:'"+t+"' failed.")}},e.prototype.getCommands=function(t){return void 0===t&&(t=!1),this._proxy.$getCommands().then(function(e){return t&&(e=e.filter(function(t){return"_"!==t[0]})),e})},e.prototype.$getContributedCommandHandlerDescriptions=function(){var t=Object.create(null);for(var e in this._commands){var n=this._commands[e].description;n&&(t[e]=n)}return o.TPromise.as(t)},e}(a.ExtHostCommandsShape);e.ExtHostCommands=c});