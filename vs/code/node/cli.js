/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
define(["require","exports","child_process","vs/base/common/winjs.base","vs/base/common/objects","vs/code/node/argv","vs/platform/package"],function(e,n,o,s,r,t,i){"use strict";function c(e){return e["list-extensions"]||!!e["install-extension"]||!!e["uninstall-extension"]}function a(n){var a=t.parseArgs(n);if(a.help)console.log(t.buildHelpMessage(i["default"].version));else if(a.version)console.log(i["default"].version);else{if(c(a)){var u=new s.TPromise(function(n){return e(["vs/code/node/cliProcessMain"],n)});return u.then(function(e){return e.main(a)})}var l=r.assign({},process.env,{VSCODE_CLI:"1",ELECTRON_NO_ATTACH_CONSOLE:"1"});delete l.ATOM_SHELL_INTERNAL_RUN_AS_NODE;var f={detached:!0,env:l};a.verbose||(f.stdio="ignore");var v=o.spawn(process.execPath,n,f);if(a.verbose&&(v.stdout.on("data",function(e){return console.log(e.toString("utf8").trim())}),v.stderr.on("data",function(e){return console.log(e.toString("utf8").trim())})),a.wait||a.verbose)return new s.TPromise(function(e){return v.once("exit",function(){return e(null)})})}return s.TPromise.as(null)}n.main=a,a(process.argv.slice(2)).then(function(){return process.exit(0)}).then(null,function(e){console.error(e.stack?e.stack:e),process.exit(1)})});