define(["require","exports","vs/base/common/strings","vs/base/common/paths","vs/base/common/map"],function(e,r,t,n,a){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";function i(e){switch(e){case 0:return"";case 1:return p+"*?";default:return"(?:"+l+"|"+p+"+"+l+"|"+l+p+"+)*?"}}function u(e,r){if(!e)return[];for(var t,n=[],a=!1,i=!1,u="",s=0;s<e.length;s++){switch(t=e[s]){case r:if(!a&&!i){n.push(u),u="";continue}break;case"{":a=!0;break;case"}":a=!1;break;case"[":i=!0;break;case"]":i=!1}u+=t}return u&&n.push(u),n}function s(e){if(!e)return"";var r="",n=u(e,"/");if(n.every(function(e){return"**"===e}))r=".*";else{var a=!1;n.forEach(function(e,c){if("**"===e)return void(a||(r+=i(2),a=!0));for(var o,f=!1,v="",h=!1,b="",g=0;g<e.length;g++)if(o=e[g],"}"!==o&&f)v+=o;else if("]"!==o&&h){var m=void 0;switch(o){case"-":m=o;break;case"^":m=o;break;default:m=t.escapeRegExpCharacters(o)}b+=m}else switch(o){case"{":f=!0;continue;case"[":h=!0;continue;case"}":var w=u(v,","),T="(?:"+w.map(function(e){return s(e)}).join("|")+")";r+=T,f=!1,v="";break;case"]":r+="["+b+"]",h=!1,b="";break;case"?":r+=p;continue;case"*":r+=i(1);continue;default:r+=t.escapeRegExpCharacters(o)}c<n.length-1&&"**"!==n[c+1]&&(r+=l),a=!1})}return r}function c(e){if(!e)return null;e=e.trim();var r=w.get(e);return r?(r.regexp&&(r.regexp.lastIndex=0),r):(r=Object.create(null),b.test(e)?r.trivia=h.T1:g.test(e)?r.trivia=h.T2:m.test(e)?r.trivia=h.T3:r.regexp=o("^"+s(e)+"$"),w.set(e,r),r)}function o(e){try{return new RegExp(e)}catch(r){return/.^/}}function f(e,r,n){if(!e||!r)return!1;if("string"==typeof e){var a=c(e);if(!a)return!1;if(a.trivia===h.T1)return t.endsWith(r,e.substr(4));if(a.trivia===h.T2){var i=e.substr(3);return r===i||t.endsWith(r,"/"+i)||t.endsWith(r,"\\"+i)}return a.trivia===h.T3?e.slice(1,-1).split(",").some(function(e){return f(e,r)}):a.regexp.test(r)}return v(e,r,n)}function v(e,r,a){for(var i,u=Object.getOwnPropertyNames(e),s=function(s){var c=u[s],o=e[c];if(o===!1)return"continue";if(f(c,r)){if("boolean"==typeof o)return{value:c};if(o&&"string"==typeof o.when){if(!a||!a.length)return"continue";i||(i=t.rtrim(n.basename(r),n.extname(r)));var v=o,l=v.when.replace("$(basename)",i);return a.some(function(e){return e===l})?{value:c}:"continue"}return{value:c}}},c=0;c<u.length;c++){var o=s(c);if("object"==typeof o)return o.value}return null}var l="[/\\\\]",p="[^/\\\\]";r.splitGlobAware=u;var h,b=/^\*\*\/\*\.[\w\.-]+$/,g=/^\*\*\/[\w\.-]+$/,m=/^{\*\*\/\*\.[\w\.-]+(,\*\*\/\*\.[\w\.-]+)*}$/;!function(e){e[e.T1=0]="T1",e[e.T2=1]="T2",e[e.T3=2]="T3"}(h||(h={}));var w=new a.LinkedMap(1e4);r.match=f});