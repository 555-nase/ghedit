define(["require","exports","vs/nls","vs/base/common/objects","vs/base/common/platform","vs/base/common/types","vs/base/common/arrays","vs/base/common/strings"],function(e,r,t,n,o,s,i,a){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";function l(e){r.errorHandler.setUnexpectedErrorHandler(e)}function c(e){h(e)||r.errorHandler.onUnexpectedError(e)}function u(e){return e.then(null,c)}function d(e){if(e instanceof Error){var r=e.name,t=e.message,n=e.stacktrace||e.stack;return{$isError:!0,name:r,message:t,stack:n}}return e}function f(e,r){var t=new k(e);return r?t.verboseMessage:t.message}function p(e,r){return e.message?r&&(e.stack||e.stacktrace)?t.localize("stackTrace.format","{0}: {1}",m(e),e.stack||e.stacktrace):m(e):t.localize("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function m(e){return"string"==typeof e.code&&"number"==typeof e.errno&&"string"==typeof e.syscall?t.localize("nodeExceptionMessage","A system error occured ({0})",e.message):e.message}function g(e,r){if(void 0===e&&(e=null),void 0===r&&(r=!1),!e)return t.localize("error.defaultMessage","An unknown error occurred. Please consult the log for more details.");if(Array.isArray(e)){var n=i.coalesce(e),o=g(n[0],r);return n.length>1?t.localize("error.moreErrors","{0} ({1} errors in total)",o,n.length):o}if(s.isString(e))return e;if(!s.isUndefinedOrNull(e.status))return f(e,r);if(e.detail){var a=e.detail;if(a.error){if(a.error&&!s.isUndefinedOrNull(a.error.status))return f(a.error,r);if(!s.isArray(a.error))return p(a.error,r);for(var l=0;l<a.error.length;l++)if(a.error[l]&&!s.isUndefinedOrNull(a.error[l].status))return f(a.error[l],r)}if(a.exception)return s.isUndefinedOrNull(a.exception.status)?p(a.exception,r):f(a.exception,r)}return e.stack?p(e,r):e.message?e.message:t.localize("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function h(e){return e instanceof Error&&e.name===H&&e.message===H}function E(){var e=new Error(H);return e.name=e.message,e}function y(){return new Error(t.localize("notImplementedError","Not Implemented"))}function v(e){return e?new Error(t.localize("illegalArgumentError","Illegal argument: {0}",e)):new Error(t.localize("illegalArgumentError2","Illegal argument"))}function x(e){return e?new Error(t.localize("illegalStateError","Illegal state: {0}",e)):new Error(t.localize("illegalStateError2","Illegal state"))}function T(e){return e?new Error("readonly property '"+e+" cannot be changed'"):new Error("readonly property cannot be changed")}function b(e){return o.isWeb?new Error(t.localize("loaderError","Failed to load a required file. Either you are no longer connected to the internet or the server you are connected to is offline. Please refresh the browser to try again.")):new Error(t.localize("loaderErrorNative","Failed to load a required file. Please restart the application to try again. Details: {0}",JSON.stringify(e)))}function w(e,r){void 0===r&&(r={});var t=new Error(e);return s.isNumber(r.severity)&&(t.severity=r.severity),r.actions&&(t.actions=r.actions),t}var z=function(){function e(){this.listeners=[],this.unexpectedErrorHandler=function(e){o.setTimeout(function(){if(e.stack)throw new Error(e.message+"\n\n"+e.stack);throw e},0)}}return e.prototype.addListener=function(e){var r=this;return this.listeners.push(e),function(){r._removeListener(e)}},e.prototype.emit=function(e){this.listeners.forEach(function(r){r(e)})},e.prototype._removeListener=function(e){this.listeners.splice(this.listeners.indexOf(e),1)},e.prototype.setUnexpectedErrorHandler=function(e){this.unexpectedErrorHandler=e},e.prototype.getUnexpectedErrorHandler=function(){return this.unexpectedErrorHandler},e.prototype.onUnexpectedError=function(e){this.unexpectedErrorHandler(e),this.emit(e)},e}();r.ErrorHandler=z,r.errorHandler=new z,r.setUnexpectedErrorHandler=l,r.onUnexpectedError=c,r.onUnexpectedPromiseError=u,r.transformErrorForSerialization=d;var k=function(){function e(e){this.status=e.status,this.statusText=e.statusText,this.name="ConnectionError";try{this.responseText=e.responseText}catch(r){this.responseText=""}if(this.errorMessage=null,this.errorCode=null,this.errorObject=null,this.responseText)try{var t=JSON.parse(this.responseText);this.errorMessage=t.message,this.errorCode=t.code,this.errorObject=t}catch(n){}}return Object.defineProperty(e.prototype,"message",{get:function(){return this.connectionErrorToMessage(this,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verboseMessage",{get:function(){return this.connectionErrorToMessage(this,!0)},enumerable:!0,configurable:!0}),e.prototype.connectionErrorDetailsToMessage=function(e,r){var n=e.errorCode,o=e.errorMessage;return null!==n&&null!==o?t.localize({key:"message",comment:["{0} represents the error message","{1} represents the error code"]},"{0}. Error code: {1}",a.rtrim(o,"."),n):null!==o?o:r&&null!==e.responseText?e.responseText:null},e.prototype.connectionErrorToMessage=function(e,r){var n=this.connectionErrorDetailsToMessage(e,r);return 401===e.status?null!==n?t.localize({key:"error.permission.verbose",comment:["{0} represents detailed information why the permission got denied"]},"Permission Denied (HTTP {0})",n):t.localize("error.permission","Permission Denied"):n?n:e.status>0&&null!==e.statusText?r&&null!==e.responseText&&e.responseText.length>0?t.localize("error.http.verbose","{0} (HTTP {1}: {2})",e.statusText,e.status,e.responseText):t.localize("error.http","{0} (HTTP {1})",e.statusText,e.status):r&&null!==e.responseText&&e.responseText.length>0?t.localize("error.connection.unknown.verbose","Unknown Connection Error ({0})",e.responseText):t.localize("error.connection.unknown","An unknown connection error occurred. Either you are no longer connected to the internet or the server you are connected to is offline.")},e}();r.ConnectionError=k,n.derive(Error,k),r.toErrorMessage=g;var H="Canceled";r.isPromiseCanceledError=h,r.canceled=E,r.notImplemented=y,r.illegalArgument=v,r.illegalState=x,r.readonly=T,r.loaderError=b,r.create=w});