define(["require","exports","./json"],function(n,e,t){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";function r(n,e){return n.substring(0,e.offset)+e.content+n.substring(e.offset+e.length)}function a(n,e){for(var t=e.length-1;t>=0;t--)n=r(n,e[t]);return n}function i(n,e,r){function a(){return k+o(x,y+v)}function i(){var n=g.scan();for(T=!1;n===t.SyntaxKind.Trivia||n===t.SyntaxKind.LineBreakTrivia;)T=T||n===t.SyntaxKind.LineBreakTrivia,n=g.scan();return n}function d(e,t,r){n.substring(t,r)!==e&&m.push({offset:t,length:r-t,content:e})}var y,u,K,S;if(e){for(K=e.offset,S=K+e.length;K>0&&!c(n,K-1);)K--;var l=t.createScanner(n,!0);l.setPosition(S),l.scan(),S=l.getPosition(),u=n.substring(K,S),y=f(u,0,r)}else u=n,K=0,S=n.length,y=0;var x,k=s(r,n),T=!1,v=0;x=r.insertSpaces?o(" ",r.tabSize):"\t";var g=t.createScanner(u,!1),m=[],h=i();if(h!==t.SyntaxKind.EOF){var O=g.getTokenOffset()+K,b=o(x,y);d(b,K,O)}for(;h!==t.SyntaxKind.EOF;){for(var p=g.getTokenOffset()+g.getTokenLength()+K,B=i(),C="";!T&&(B===t.SyntaxKind.LineCommentTrivia||B===t.SyntaxKind.BlockCommentTrivia);){var L=g.getTokenOffset()+K;d(" ",p,L),p=g.getTokenOffset()+g.getTokenLength()+K,C=B===t.SyntaxKind.LineCommentTrivia?a():"",B=i()}if(B===t.SyntaxKind.CloseBraceToken)h!==t.SyntaxKind.OpenBraceToken&&(v--,C=a());else if(B===t.SyntaxKind.CloseBracketToken)h!==t.SyntaxKind.OpenBracketToken&&(v--,C=a());else if(B!==t.SyntaxKind.EOF){switch(h){case t.SyntaxKind.OpenBracketToken:case t.SyntaxKind.OpenBraceToken:v++,C=a();break;case t.SyntaxKind.CommaToken:case t.SyntaxKind.LineCommentTrivia:C=a();break;case t.SyntaxKind.BlockCommentTrivia:C=T?a():" ";break;case t.SyntaxKind.ColonToken:C=" ";break;case t.SyntaxKind.NullKeyword:case t.SyntaxKind.TrueKeyword:case t.SyntaxKind.FalseKeyword:case t.SyntaxKind.NumericLiteral:B!==t.SyntaxKind.NullKeyword&&B!==t.SyntaxKind.FalseKeyword&&B!==t.SyntaxKind.NumericLiteral||(C=" ")}!T||B!==t.SyntaxKind.LineCommentTrivia&&B!==t.SyntaxKind.BlockCommentTrivia||(C=a())}var w=g.getTokenOffset()+K;d(C,p,w),h=B}return m}function o(n,e){for(var t="",r=0;r<e;r++)t+=n;return t}function f(n,e,t){for(var r=0,a=0,i=t.tabSize||4;r<n.length;){var o=n.charAt(r);if(" "===o)a++;else{if("\t"!==o)break;a+=i}r++}return Math.floor(a/i)}function s(n,e){for(var t=0;t<e.length;t++){var r=e.charAt(t);if("\r"===r)return t+1<e.length&&"\n"===e.charAt(t+1)?"\r\n":"\r";if("\n"===r)return"\n"}return n&&n.eol||"\n"}function c(n,e){return"\r\n".indexOf(n.charAt(e))!==-1}e.applyEdit=r,e.applyEdits=a,e.format=i});