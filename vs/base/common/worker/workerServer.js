define(["require","exports","vs/base/common/errors","vs/base/common/marshalling","vs/base/common/worker/workerProtocol"],function(e,r,t,s,n){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";function o(e){return new i(e)}var i=function(){function r(e){this._postSerializedMessage=e,this._workerId=0,this._requestHandler=null,this._bindConsole()}return r.prototype._bindConsole=function(){self.console={log:this._sendPrintMessage.bind(this,n.PrintType.LOG),debug:this._sendPrintMessage.bind(this,n.PrintType.DEBUG),info:this._sendPrintMessage.bind(this,n.PrintType.INFO),warn:this._sendPrintMessage.bind(this,n.PrintType.WARN),error:this._sendPrintMessage.bind(this,n.PrintType.ERROR)},t.setUnexpectedErrorHandler(function(e){self.console.error(e)})},r.prototype._sendPrintMessage=function(e){for(var r=[],s=1;s<arguments.length;s++)r[s-1]=arguments[s];var o=r.map(function(e){return e instanceof Error?t.transformErrorForSerialization(e):e}),i={monacoWorker:!0,from:this._workerId,req:"0",type:n.MessageType.PRINT,level:e,payload:1===o.length?o[0]:o};this._postMessage(i)},r.prototype._sendReply=function(e,r,s){var o={monacoWorker:!0,from:this._workerId,req:"0",id:e,type:n.MessageType.REPLY,action:r,payload:s instanceof Error?t.transformErrorForSerialization(s):s};this._postMessage(o)},r.prototype.loadModule=function(e,r,t){self.require([e],function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];r(e[0])},t)},r.prototype.onmessage=function(e){this._onmessage(s.parse(e))},r.prototype._postMessage=function(e){this._postSerializedMessage(s.stringify(e))},r.prototype._onmessage=function(r){var t=this,s=this._sendReply.bind(this,r.id,n.ReplyType.COMPLETE),o=this._sendReply.bind(this,r.id,n.ReplyType.ERROR),i=this._sendReply.bind(this,r.id,n.ReplyType.PROGRESS);switch(r.type){case n.MessageType.INITIALIZE:this._workerId=r.payload.id;var a=r.payload.loaderConfiguration;if(a){"undefined"!=typeof a.baseUrl&&delete a.baseUrl,"undefined"!=typeof a.paths&&"undefined"!=typeof a.paths.vs&&delete a.paths.vs;var d=a["vs/nls"];d&&d.pseudo&&e(["vs/nls"],function(e){e.setPseudoTranslation(d.pseudo)}),a.catchError=!0,self.require.config(a)}this.loadModule(r.payload.moduleId,function(e){t._requestHandler=e.value,s()},o);break;default:this._handleMessage(r,s,o,i)}},r.prototype._handleMessage=function(e,r,s,n){if(!this._requestHandler)return void s("Request handler not loaded");var o=this._requestHandler[e.type];if("function"!=typeof o)return void s("Handler does not have method "+e.type);try{o.call(this._requestHandler,this,r,s,n,e.payload)}catch(i){s(t.transformErrorForSerialization(i))}},r}();r.WorkerServer=i,r.create=o});