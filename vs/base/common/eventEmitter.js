var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)};define(["require","exports","vs/base/common/errors"],function(t,e,i){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";function n(t){try{return t()}catch(e){i.onUnexpectedError(e)}}function r(t,e){try{return t(e)}catch(n){i.onUnexpectedError(n)}}var s=function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this._type=t,this._data=e}return t.prototype.getType=function(){return this._type},t.prototype.getData=function(){return this._data},t}();e.EmitterEvent=s;var o=function(){function t(t){if(void 0===t&&(t=null),this._listeners={},this._bulkListeners=[],this._collectedEvents=[],this._deferredCnt=0,t){this._allowedEventTypes={};for(var e=0;e<t.length;e++)this._allowedEventTypes[t[e]]=!0}else this._allowedEventTypes=null}return t.prototype.dispose=function(){this._listeners={},this._bulkListeners=[],this._collectedEvents=[],this._deferredCnt=0,this._allowedEventTypes=null},t.prototype.addListener=function(t,e){if("*"===t)throw new Error("Use addBulkListener(listener) to register your listener!");if(this._allowedEventTypes&&!this._allowedEventTypes.hasOwnProperty(t))throw new Error("This object will never emit this event type!");this._listeners.hasOwnProperty(t)?this._listeners[t].push(e):this._listeners[t]=[e];var i=this;return{dispose:function(){i&&(i._removeListener(t,e),i=null,e=null)}}},t.prototype.addListener2=function(t,e){return this.addListener(t,e)},t.prototype.addOneTimeDisposableListener=function(t,e){var i=this.addListener(t,function(t){i.dispose(),e(t)});return i},t.prototype.addBulkListener=function(t){var e=this;return this._bulkListeners.push(t),{dispose:function(){e._removeBulkListener(t)}}},t.prototype.addBulkListener2=function(t){return this.addBulkListener(t)},t.prototype.addEmitter=function(t){var e=this;return t.addBulkListener2(function(t){var i=t;0===e._deferredCnt?e._emitEvents(i):e._collectedEvents.push.apply(e._collectedEvents,i)})},t.prototype.addEmitter2=function(t){return this.addEmitter(t)},t.prototype._removeListener=function(t,e){if(this._listeners.hasOwnProperty(t))for(var i=this._listeners[t],n=0,r=i.length;n<r;n++)if(i[n]===e){i.splice(n,1);break}},t.prototype._removeBulkListener=function(t){for(var e=0,i=this._bulkListeners.length;e<i;e++)if(this._bulkListeners[e]===t){this._bulkListeners.splice(e,1);break}},t.prototype._emitToSpecificTypeListeners=function(t,e){if(this._listeners.hasOwnProperty(t))for(var i=this._listeners[t].slice(0),n=0,s=i.length;n<s;n++)r(i[n],e)},t.prototype._emitToBulkListeners=function(t){for(var e=this._bulkListeners.slice(0),i=0,n=e.length;i<n;i++)r(e[i],t)},t.prototype._emitEvents=function(t){this._bulkListeners.length>0&&this._emitToBulkListeners(t);for(var e=0,i=t.length;e<i;e++){var n=t[e];this._emitToSpecificTypeListeners(n.getType(),n.getData())}},t.prototype.emit=function(t,e){if(void 0===e&&(e={}),this._allowedEventTypes&&!this._allowedEventTypes.hasOwnProperty(t))throw new Error("Cannot emit this event type because it wasn't white-listed!");if(this._listeners.hasOwnProperty(t)||0!==this._bulkListeners.length){var i=new s(t,e);0===this._deferredCnt?this._emitEvents([i]):this._collectedEvents.push(i)}},t.prototype.deferredEmit=function(t){this._deferredCnt=this._deferredCnt+1;var e=n(t);return this._deferredCnt=this._deferredCnt-1,0===this._deferredCnt&&this._emitCollected(),e},t.prototype._emitCollected=function(){var t=this._collectedEvents;this._collectedEvents=[],t.length>0&&this._emitEvents(t)},t}();e.EventEmitter=o;var l=function(){function t(t,e){this.target=t,this.arg=e}return t}(),h=function(t){function e(e){void 0===e&&(e=null),t.call(this,e),this._emitQueue=[]}return __extends(e,t),e.prototype._emitToSpecificTypeListeners=function(t,e){if(this._listeners.hasOwnProperty(t))for(var i=this._listeners[t],n=0,r=i.length;n<r;n++)this._emitQueue.push(new l(i[n],e))},e.prototype._emitToBulkListeners=function(t){for(var e=this._bulkListeners,i=0,n=e.length;i<n;i++)this._emitQueue.push(new l(e[i],t))},e.prototype._emitEvents=function(e){for(t.prototype._emitEvents.call(this,e);this._emitQueue.length>0;){var i=this._emitQueue.shift();r(i.target,i.arg)}},e}(o);e.OrderGuaranteeEventEmitter=h});