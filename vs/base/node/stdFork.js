/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
define(["require","exports","path","os","net","child_process","vs/base/common/uri"],function(n,e,r,t,o,c,i){"use strict";function s(n){for(var e=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],r="",t=0;t<n;t++){var o=Math.floor(e.length*Math.random());r+=e[o]}return r}function a(){var n="vscode-"+s(40);return"win32"===process.platform?"\\\\.\\pipe\\"+n+"-sock":r.join(t.tmpdir(),n+".sock")}function f(n,e,r,t){var o={};for(var c in n)o[c]=n[c];return o.STDIN_PIPE_NAME=e,o.STDOUT_PIPE_NAME=r,o.STDERR_PIPE_NAME=t,o.ATOM_SHELL_INTERNAL_RUN_AS_NODE="1",o}function u(e,r,t,s){var u,v=!1,l=function(n){v||(v=!0,s(null,n))},d=function(n){v||(v=!0,s(n,null))},_=a(),p=a(),E=a(),A=f(t.env||process.env,_,p,E),N=o.createServer(function(n){u.stderr=n});N.listen(E);var S=o.createServer(function(n){n.once("data",function(e){u.stdin=o.connect(_),u.stdout=n,l(u)})});S.listen(p);var P=!1,h=function(){P||(P=!0,S.close(),N.close())},M=i["default"].parse(n.toUrl("./stdForkStart.js")).fsPath;u=c.fork(M,[e].concat(r),{silent:!0,cwd:t.cwd,env:A,execArgv:t.execArgv}),u.once("error",function(n){h(),d(n)}),u.once("exit",function(n){h(),d(n)}),process.once("exit",h)}e.fork=u});