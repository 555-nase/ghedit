var __extends=this&&this.__extends||function(o,t){function e(){this.constructor=o}for(var s in t)t.hasOwnProperty(s)&&(o[s]=t[s]);o.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)};define(["require","exports","vs/base/common/lifecycle","vs/base/browser/dom","vs/base/browser/iframe","vs/base/browser/mouseEvent"],function(o,t,e,s,n,i){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";function r(o,t){var e=new i.StandardMouseEvent(t);return e.preventDefault(),{leftButton:e.leftButton,posx:e.posx,posy:e.posy}}t.standardMouseMoveMerger=r;var a=function(o){function t(){o.call(this),this.hooks=[],this.mouseMoveEventMerger=null,this.mouseMoveCallback=null,this.onStopCallback=null}return __extends(t,o),t.prototype.dispose=function(){this.stopMonitoring(!1),o.prototype.dispose.call(this)},t.prototype.stopMonitoring=function(o){if(this.isMonitoring()){this.hooks=e.dispose(this.hooks),this.mouseMoveEventMerger=null,this.mouseMoveCallback=null;var t=this.onStopCallback;this.onStopCallback=null,o&&t()}},t.prototype.isMonitoring=function(){return this.hooks.length>0},t.prototype.startMonitoring=function(o,t,e){var r=this;if(!this.isMonitoring()){this.mouseMoveEventMerger=o,this.mouseMoveCallback=t,this.onStopCallback=e;for(var a=n.IframeUtils.getSameOriginWindowChain(),u=0;u<a.length;u++)this.hooks.push(s.addDisposableThrottledListener(a[u].window.document,"mousemove",function(o){return r.mouseMoveCallback(o)},function(o,t){return r.mouseMoveEventMerger(o,t)})),this.hooks.push(s.addDisposableListener(a[u].window.document,"mouseup",function(o){return r.stopMonitoring(!0)}));if(n.IframeUtils.hasDifferentOriginAncestor()){var l=a[a.length-1];this.hooks.push(s.addDisposableListener(l.window.document,"mouseout",function(o){var t=new i.StandardMouseEvent(o);"html"===t.target.tagName.toLowerCase()&&r.stopMonitoring(!0)})),this.hooks.push(s.addDisposableListener(l.window.document,"mouseover",function(o){var t=new i.StandardMouseEvent(o);"html"===t.target.tagName.toLowerCase()&&r.stopMonitoring(!0)})),this.hooks.push(s.addDisposableListener(l.window.document.body,"mouseleave",function(o){r.stopMonitoring(!0)}))}}},t}(e.Disposable);t.GlobalMouseMoveMonitor=a});