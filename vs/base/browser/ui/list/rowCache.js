/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
define(["require","exports","vs/base/browser/dom"],function(e,t,o){"use strict";function l(e){var t=e.getAttribute("last-scroll-time");return t?parseInt(t,10):0}function r(e){try{e.parentElement.removeChild(e)}catch(t){}}var i=function(){function e(e){this.renderers=e,this.cache=Object.create(null),this.scrollingRow=null}return e.prototype.alloc=function(e){var t=this.getTemplateCache(e).pop();if(!t){var l=o.emmet(".monaco-list-row"),r=this.renderers[e],i=r.renderTemplate(l);t={domNode:l,templateId:e,templateData:i}}return t},e.prototype.release=function(e){if(e){var t=l(e.domNode);if(!t)return r(e.domNode),void this.getTemplateCache(e.templateId).push(e);if(this.scrollingRow){var i=l(this.scrollingRow.domNode);if(i>t)return r(e.domNode),void this.getTemplateCache(e.templateId).push(e);this.scrollingRow.domNode.parentElement&&(r(this.scrollingRow.domNode),o.removeClass(this.scrollingRow.domNode,"scrolling"),this.getTemplateCache(this.scrollingRow.templateId).push(this.scrollingRow))}this.scrollingRow=e,o.addClass(this.scrollingRow.domNode,"scrolling")}},e.prototype.getTemplateCache=function(e){return this.cache[e]||(this.cache[e]=[])},e.prototype.garbageCollect=function(){var e=this;if(this.cache&&Object.keys(this.cache).forEach(function(t){e.cache[t].forEach(function(o){var l=e.renderers[t];l.disposeTemplate(o.templateData),o.domNode=null,o.templateData=null}),delete e.cache[t]}),this.scrollingRow){var t=this.renderers[this.scrollingRow.templateId];t.disposeTemplate(this.scrollingRow.templateData),this.scrollingRow=null}},e.prototype.dispose=function(){this.garbageCollect(),this.cache=null,this.renderers=null},e}();t.RowCache=i});