/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
define(["require","exports"],function(t,r){"use strict";function e(t,r){if(t.start>=r.end||r.start>=t.end)return null;var e=Math.max(t.start,r.start),n=Math.min(t.end,r.end);return n-e<=0?null:{start:e,end:n}}function n(t){return t.end-t.start<=0}function i(t,r){var e=[],i={start:t.start,end:Math.min(r.start,t.end)},s={start:Math.max(r.end,t.start),end:t.end};return n(i)||e.push(i),n(s)||e.push(s),e}function s(t,r){for(var e=t.start;e<t.end;e++)r(e)}function a(t,r){for(var n=[],i=0,s=r;i<s.length;i++){var a=s[i];if(!(t.start>=a.range.end)){if(t.end<a.range.start)break;var u=e(t,a.range);u&&n.push({range:u,size:a.size})}}return n}function u(t,r){var e=t.start,n=t.end;return{start:e+r,end:n+r}}function o(t){for(var r=[],e=null,n=0,i=t;n<i.length;n++){var s=i[n],a=s.range.start,u=s.range.end,o=s.size;e&&o===e.size?e.range.end=u:(e={range:{start:a,end:u},size:o},r.push(e))}return r}function f(){for(var t=[],r=0;r<arguments.length;r++)t[r-0]=arguments[r];return o(t.reduce(function(t,r){return t.concat(r)},[]))}r.intersect=e,r.isEmpty=n,r.relativeComplement=i,r.each=s,r.groupIntersect=a,r.consolidate=o;var g=function(){function t(){this.groups=[],this._size=0}return t.prototype.splice=function(t,r){for(var e=[],n=2;n<arguments.length;n++)e[n-2]=arguments[n];var i=e.length-r,s=a({start:0,end:t},this.groups),o=a({start:t+r,end:Number.POSITIVE_INFINITY},this.groups).map(function(t){return{range:u(t.range,i),size:t.size}}),g=e.map(function(r,e){return{range:{start:t+e,end:t+e+1},size:r.size}});this.groups=f(s,g,o),this._size=this.groups.reduce(function(t,r){return t+r.size*(r.range.end-r.range.start)},0)},Object.defineProperty(t.prototype,"count",{get:function(){var t=this.groups.length;return t?this.groups[t-1].range.end:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),t.prototype.indexAt=function(t){if(t<0)return-1;for(var r=0,e=0,n=0,i=this.groups;n<i.length;n++){var s=i[n],a=s.range.end-s.range.start,u=e+a*s.size;if(t<u)return r+Math.floor((t-e)/s.size);r+=a,e=u}return r},t.prototype.indexAfter=function(t){return Math.min(this.indexAt(t)+1,this.count)},t.prototype.positionAt=function(t){if(t<0)return-1;for(var r=0,e=0,n=0,i=this.groups;n<i.length;n++){var s=i[n],a=s.range.end-s.range.start,u=e+a;if(t<u)return r+(t-e)*s.size;r+=a*s.size,e=u}return-1},t.prototype.dispose=function(){this.groups=null},t}();r.RangeMap=g});