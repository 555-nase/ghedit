/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
var __extends=this&&this.__extends||function(t,n){function o(){this.constructor=t}for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)};define(["require","exports","vs/nls","vs/base/common/winjs.base","vs/base/browser/builder","vs/base/common/types","vs/base/common/actions","vs/base/browser/ui/actionbar/actionbar","vs/base/browser/ui/dropdown/dropdown","vs/css!./toolbar"],function(t,n,o,e,i,r,s,c,a){"use strict";n.CONTEXT="context.toolbar";var u=function(){function t(t,n,o){var e=this;void 0===o&&(o={orientation:c.ActionsOrientation.HORIZONTAL}),this.options=o,this.toggleMenuAction=new l(function(){return e.toggleMenuActionItem&&e.toggleMenuActionItem.show()});var r=document.createElement("div");r.className="monaco-toolbar",t.appendChild(r),this.actionBar=new c.ActionBar(i.$(r),{orientation:o.orientation,ariaLabel:o.ariaLabel,actionItemProvider:function(t){return t.id===l.ID?(e.toggleMenuActionItem&&e.toggleMenuActionItem.dispose(),e.toggleMenuActionItem=new d(t,t.menuActions,n,e.options.actionItemProvider,e.actionRunner,e.options.getKeyBinding,"toolbar-toggle-more"),e.toggleMenuActionItem.setActionContext(e.actionBar.context),e.toggleMenuActionItem):o.actionItemProvider?o.actionItemProvider(t):null}})}return Object.defineProperty(t.prototype,"actionRunner",{get:function(){return this.actionBar.actionRunner},set:function(t){this.actionBar.actionRunner=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"context",{set:function(t){this.actionBar.context=t,this.toggleMenuActionItem&&this.toggleMenuActionItem.setActionContext(t)},enumerable:!0,configurable:!0}),t.prototype.getContainer=function(){return this.actionBar.getContainer()},t.prototype.setAriaLabel=function(t){this.actionBar.setAriaLabel(t)},t.prototype.setActions=function(t,n){var o=this;return function(){var e=t?t.slice(0):[];o.hasSecondaryActions=n&&n.length>0,o.hasSecondaryActions&&(o.toggleMenuAction.menuActions=n.slice(0),e.push(o.toggleMenuAction)),o.actionBar.clear(),o.actionBar.push(e,{icon:!0,label:!1})}},t.prototype.addPrimaryAction=function(t){var n=this;return function(){if(n.hasSecondaryActions){var o=n.actionBar.length();n.actionBar.push(t,{icon:!0,label:!1,index:o})}else n.actionBar.push(t,{icon:!0,label:!1})}},t.prototype.dispose=function(){this.actionBar.dispose(),this.toggleMenuAction.dispose(),this.toggleMenuActionItem&&this.toggleMenuActionItem.dispose()},t}();n.ToolBar=u;var l=function(t){function n(e){t.call(this,n.ID,o.localize("more","More"),null,!0),this.toggleDropdownMenu=e}return __extends(n,t),n.prototype.run=function(){return this.toggleDropdownMenu(),e.TPromise.as(!0)},Object.defineProperty(n.prototype,"menuActions",{get:function(){return this._menuActions},set:function(t){this._menuActions=t},enumerable:!0,configurable:!0}),n.ID="toolbar.toggle.more",n}(s.Action),d=function(t){function n(n,o,e,i,r,s,c){t.call(this,null,n),this.menuActionsOrProvider=o,this.contextMenuProvider=e,this.actionItemProvider=i,this.actionRunner=r,this.keybindings=s,this.clazz=c}return __extends(n,t),n.prototype.render=function(t){var n=this,o=function(t){return n.builder=i.$("a.action-label").attr({tabIndex:"0",role:"button","aria-haspopup":"true",title:n._action.label||"","class":n.clazz}),n.builder.appendTo(t),null},e={contextMenuProvider:this.contextMenuProvider,labelRenderer:o};r.isArray(this.menuActionsOrProvider)?e.actions=this.menuActionsOrProvider:e.actionProvider=this.menuActionsOrProvider,this.dropdownMenu=new a.DropdownMenu(t,e),this.dropdownMenu.menuOptions={actionItemProvider:this.actionItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.keybindings,context:this._context},this.toUnbind=this.addEmitter2(this.dropdownMenu)},n.prototype.setActionContext=function(n){t.prototype.setActionContext.call(this,n),this.dropdownMenu&&(this.dropdownMenu.menuOptions.context=n)},n.prototype.show=function(){this.dropdownMenu&&this.dropdownMenu.show()},n.prototype.dispose=function(){this.toUnbind.dispose(),this.dropdownMenu.dispose(),t.prototype.dispose.call(this)},n}(c.BaseActionItem);n.DropdownMenuActionItem=d});