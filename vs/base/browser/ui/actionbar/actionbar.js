/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)};define(["require","exports","vs/nls","vs/base/common/lifecycle","vs/base/browser/builder","vs/base/common/platform","vs/base/common/actions","vs/base/browser/dom","vs/base/common/events","vs/base/common/types","vs/base/common/eventEmitter","vs/base/browser/touch","vs/base/browser/keyboardEvent","vs/base/common/keyCodes","vs/css!./actionbar"],function(t,e,i,o,s,n,c,r,a,u,d,h,l,p){"use strict";var f=function(t){function e(e,i){var o=this;t.call(this),this._callOnDispose=[],this._context=e||this,this._action=i,i instanceof c.Action&&this._callOnDispose.push(i.onDidChange(function(t){o.builder&&o._handleActionChangeEvent(t)}))}return __extends(e,t),e.prototype._handleActionChangeEvent=function(t){void 0!==t.enabled&&this._updateEnabled(),void 0!==t.checked&&this._updateChecked(),void 0!==t["class"]&&this._updateClass(),void 0!==t.label&&(this._updateLabel(),this._updateTooltip()),void 0!==t.tooltip&&this._updateTooltip()},Object.defineProperty(e.prototype,"callOnDispose",{get:function(){return this._callOnDispose},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"actionRunner",{get:function(){return this._actionRunner},set:function(t){this._actionRunner=t},enumerable:!0,configurable:!0}),e.prototype.getAction=function(){return this._action},e.prototype.isEnabled=function(){return this._action.enabled},e.prototype.setActionContext=function(t){this._context=t},e.prototype.render=function(t){var e=this;this.builder=s.$(t),this.gesture=new h.Gesture(t),this.builder.on(r.EventType.CLICK,function(t){return e.onClick(t)}),this.builder.on(h.EventType.Tap,function(t){return e.onClick(t)}),n.isMacintosh&&this.builder.on(r.EventType.CONTEXT_MENU,function(t){return e.onClick(t)}),this.builder.on(r.EventType.MOUSE_DOWN,function(t){r.EventHelper.stop(t),0===t.button&&e._action.enabled&&e.builder.addClass("active")}),this.builder.on([r.EventType.MOUSE_UP,r.EventType.MOUSE_OUT],function(t){r.EventHelper.stop(t),0===t.button&&e._action.enabled&&e.builder.removeClass("active")})},e.prototype.onClick=function(t){r.EventHelper.stop(t,!0);var e;u.isUndefinedOrNull(this._context)?e=t:(e=this._context,e.event=t),this._actionRunner.run(this._action,e)},e.prototype.focus=function(){this.builder&&this.builder.domFocus()},e.prototype.blur=function(){this.builder&&this.builder.domBlur()},e.prototype._updateEnabled=function(){},e.prototype._updateLabel=function(){},e.prototype._updateTooltip=function(){},e.prototype._updateClass=function(){},e.prototype._updateChecked=function(){},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.builder&&(this.builder.destroy(),this.builder=null),this.gesture&&(this.gesture.dispose(),this.gesture=null),this._callOnDispose=o.dispose(this._callOnDispose)},e}(d.EventEmitter);e.BaseActionItem=f;var m=function(t){function e(i,o){t.call(this,e.ID,i,i?"separator text":"separator"),this.checked=!1,this.enabled=!1,this.order=o}return __extends(e,t),e.ID="vs.actions.separator",e}(c.Action);e.Separator=m;var b=function(t){function e(e,i,o){void 0===o&&(o={}),t.call(this,e,i),this.options=o,this.options.icon=void 0!==o.icon&&o.icon,this.options.label=void 0===o.label||o.label,this.cssClass=""}return __extends(e,t),e.prototype.render=function(e){t.prototype.render.call(this,e),this.$e=s.$("a.action-label").appendTo(this.builder),this.$e.attr({role:"button"}),this.options.label&&this.options.keybinding&&s.$("span.keybinding").text(this.options.keybinding).appendTo(this.builder),this._updateClass(),this._updateLabel(),this._updateTooltip(),this._updateEnabled(),this._updateChecked()},e.prototype.focus=function(){t.prototype.focus.call(this),this.$e.domFocus()},e.prototype._updateLabel=function(){this.options.label&&this.$e.text(this.getAction().label)},e.prototype._updateTooltip=function(){var t=null;this.getAction().tooltip?t=this.getAction().tooltip:!this.options.label&&this.getAction().label&&this.options.icon&&(t=this.getAction().label,this.options.keybinding&&(t=i.localize({key:"titleLabel",comment:["action title","action keybinding"]},"{0} ({1})",t,this.options.keybinding))),t&&this.$e.attr({title:t})},e.prototype._updateClass=function(){this.cssClass&&this.$e.removeClass(this.cssClass),this.options.icon?(this.cssClass=this.getAction()["class"],this.$e.addClass("icon"),this.cssClass&&this.$e.addClass(this.cssClass),this._updateEnabled()):this.$e.removeClass("icon")},e.prototype._updateEnabled=function(){this.getAction().enabled?(this.builder.removeClass("disabled"),this.$e.removeClass("disabled"),this.$e.attr({tabindex:0})):(this.builder.addClass("disabled"),this.$e.addClass("disabled"),r.removeTabIndexAndUpdateFocus(this.$e.getHTMLElement()))},e.prototype._updateChecked=function(){this.getAction().checked?this.$e.addClass("checked"):this.$e.removeClass("checked")},e}(f);e.ActionItem=b,function(t){t[t.HORIZONTAL=1]="HORIZONTAL",t[t.VERTICAL=2]="VERTICAL"}(e.ActionsOrientation||(e.ActionsOrientation={}));var v=e.ActionsOrientation,y={orientation:v.HORIZONTAL,context:null},_=function(t){function e(e,i){var o=this;void 0===i&&(i=y),t.call(this),this.options=i,this._context=i.context,this.toDispose=[],this._actionRunner=this.options.actionRunner,this._actionRunner||(this._actionRunner=new c.ActionRunner,this.toDispose.push(this._actionRunner)),this.toDispose.push(this.addEmitter2(this._actionRunner)),this.items=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar",i.animated!==!1&&r.addClass(this.domNode,"animated");var n=this.options.orientation===v.VERTICAL;n&&(this.domNode.className+=" vertical"),s.$(this.domNode).on(r.EventType.KEY_DOWN,function(t){var e=new l.StandardKeyboardEvent(t),i=!0;e.equals(n?p.CommonKeybindings.UP_ARROW:p.CommonKeybindings.LEFT_ARROW)?o.focusPrevious():e.equals(n?p.CommonKeybindings.DOWN_ARROW:p.CommonKeybindings.RIGHT_ARROW)?o.focusNext():e.equals(p.CommonKeybindings.ESCAPE)?o.cancel():e.equals(p.CommonKeybindings.ENTER)||e.equals(p.CommonKeybindings.SPACE)||(i=!1),i&&(e.preventDefault(),e.stopPropagation())}),s.$(this.domNode).on(r.EventType.CONTEXT_MENU,function(t){t.preventDefault(),t.stopPropagation()}),s.$(this.domNode).on(r.EventType.KEY_UP,function(t){var e=new l.StandardKeyboardEvent(t);e.equals(p.CommonKeybindings.ENTER)||e.equals(p.CommonKeybindings.SPACE)?(o.doTrigger(e),e.preventDefault(),e.stopPropagation()):(e.equals(p.CommonKeybindings.TAB)||e.equals(p.CommonKeybindings.SHIFT_TAB))&&o.updateFocusedItem()}),this.focusTracker=r.trackFocus(this.domNode),this.focusTracker.addBlurListener(function(){document.activeElement!==o.domNode&&r.isAncestor(document.activeElement,o.domNode)||(o.emit(r.EventType.BLUR,{}),o.focusedItem=void 0)}),this.focusTracker.addFocusListener(function(){return o.updateFocusedItem()}),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.actionsList.setAttribute("role","toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),e=e instanceof s.Builder?e.getHTMLElement():e,e.appendChild(this.domNode)}return __extends(e,t),e.prototype.setAriaLabel=function(t){t?this.actionsList.setAttribute("aria-label",t):this.actionsList.removeAttribute("aria-label")},e.prototype.updateFocusedItem=function(){for(var t=0;t<this.actionsList.children.length;t++){var e=this.actionsList.children[t];if(r.isAncestor(document.activeElement,e)){this.focusedItem=t;break}}},Object.defineProperty(e.prototype,"context",{get:function(){return this._context},set:function(t){this._context=t,this.items.forEach(function(e){return e.setActionContext(t)})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"actionRunner",{get:function(){return this._actionRunner},set:function(t){t&&(this._actionRunner=t,this.items.forEach(function(e){return e.actionRunner=t}))},enumerable:!0,configurable:!0}),e.prototype.getContainer=function(){return s.$(this.domNode)},e.prototype.push=function(t,e){var i=this;void 0===e&&(e={}),Array.isArray(t)||(t=[t]);var o=u.isNumber(e.index)?e.index:null;t.forEach(function(t){var s=document.createElement("li");s.className="action-item",s.setAttribute("role","presentation");var n=null;i.options.actionItemProvider&&(n=i.options.actionItemProvider(t)),n||(n=new b(i.context,t,e)),n.actionRunner=i._actionRunner,n.setActionContext(i.context),i.addEmitter2(n),n.render(s),null===o||o<0||o>=i.actionsList.children.length?i.actionsList.appendChild(s):i.actionsList.insertBefore(s,i.actionsList.children[o++]),i.items.push(n)})},e.prototype.clear=function(){for(var t;t=this.items.pop();)t.dispose();s.$(this.actionsList).empty()},e.prototype.length=function(){return this.items.length},e.prototype.isEmpty=function(){return 0===this.items.length},e.prototype.onContentsChange=function(){this.emit(a.EventType.CONTENTS_CHANGED)},e.prototype.focus=function(t){t&&"undefined"==typeof this.focusedItem&&(this.focusedItem=0),this.updateFocus()},e.prototype.focusNext=function(){"undefined"==typeof this.focusedItem&&(this.focusedItem=this.items.length-1);var t,e=this.focusedItem;do this.focusedItem=(this.focusedItem+1)%this.items.length,t=this.items[this.focusedItem];while(this.focusedItem!==e&&!t.isEnabled());this.focusedItem!==e||t.isEnabled()||(this.focusedItem=void 0),this.updateFocus()},e.prototype.focusPrevious=function(){"undefined"==typeof this.focusedItem&&(this.focusedItem=0);var t,e=this.focusedItem;do this.focusedItem=this.focusedItem-1,this.focusedItem<0&&(this.focusedItem=this.items.length-1),t=this.items[this.focusedItem];while(this.focusedItem!==e&&!t.isEnabled());this.focusedItem!==e||t.isEnabled()||(this.focusedItem=void 0),this.updateFocus()},e.prototype.updateFocus=function(){if("undefined"==typeof this.focusedItem)return void this.domNode.focus();for(var t=0;t<this.items.length;t++){var e=this.items[t],i=e;t===this.focusedItem?u.isFunction(i.focus)&&i.focus():u.isFunction(i.blur)&&i.blur()}},e.prototype.doTrigger=function(t){if("undefined"!=typeof this.focusedItem){var e=this.items[this.focusedItem],i=null===e._context||void 0===e._context?t:e._context;this.run(e._action,i).done()}},e.prototype.cancel=function(){document.activeElement instanceof HTMLElement&&document.activeElement.blur(),this.emit(a.EventType.CANCEL)},e.prototype.run=function(t,e){return this._actionRunner.run(t,e)},e.prototype.dispose=function(){null!==this.items&&this.clear(),this.items=null,this.focusTracker&&(this.focusTracker.dispose(),this.focusTracker=null),this.toDispose=o.dispose(this.toDispose),this.getContainer().destroy(),t.prototype.dispose.call(this)},e}(d.EventEmitter);e.ActionBar=_;var E=function(t){function e(e,i,o,s){t.call(this,e,i),this.select=document.createElement("select"),this.select.className="action-bar-select",this.options=o,this.selected=s,this.toDispose=[],this.registerListeners()}return __extends(e,t),e.prototype.setOptions=function(t,e){this.options=t,e>=0?this.selected=e:(this.selected<0||this.selected>this.options.length)&&(this.selected=0),this.doSetOptions()},e.prototype.registerListeners=function(){var t=this;this.toDispose.push(r.addStandardDisposableListener(this.select,"change",function(e){t.actionRunner.run(t._action,t.getActionContext(e.target.value)).done()}))},e.prototype.getActionContext=function(t){return t},e.prototype.focus=function(){this.select&&this.select.focus()},e.prototype.blur=function(){this.select&&this.select.blur()},e.prototype.render=function(t){r.addClass(t,"select-container"),t.appendChild(this.select),this.doSetOptions()},e.prototype.getSelected=function(){return this.options&&this.selected>=0&&this.selected<this.options.length?this.options[this.selected]:null},e.prototype.doSetOptions=function(){var t=this;this.select.options.length=0,this.options.forEach(function(e){t.select.add(t.createOption(e))}),this.selected>=0&&(this.select.selectedIndex=this.selected,this.select.title=this.options[this.selected])},e.prototype.createOption=function(t){var e=document.createElement("option");return e.value=t,e.text=t,e},e.prototype.dispose=function(){this.toDispose=o.dispose(this.toDispose),t.prototype.dispose.call(this)},e}(f);e.SelectActionItem=E});