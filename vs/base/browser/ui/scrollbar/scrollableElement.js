var __extends=this&&this.__extends||function(e,o){function t(){this.constructor=e}for(var s in o)o.hasOwnProperty(s)&&(e[s]=o[s]);e.prototype=null===o?Object.create(o):(t.prototype=o.prototype,new t)};define(["require","exports","vs/base/browser/browser","vs/base/browser/dom","vs/base/common/platform","vs/base/browser/mouseEvent","vs/base/browser/ui/scrollbar/horizontalScrollbar","vs/base/browser/ui/scrollbar/verticalScrollbar","vs/base/common/lifecycle","vs/base/common/scrollable","vs/base/browser/ui/widget","vs/base/common/async","vs/base/browser/styleMutator","vs/base/common/event","vs/css!./media/scrollbars"],function(e,o,t,s,i,l,r,n,a,h,d,c,u,_){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";function p(e){var o={canUseTranslate3d:e.canUseTranslate3d&&t.canUseTranslate3d,lazyRender:"undefined"!=typeof e.lazyRender&&e.lazyRender,className:"undefined"!=typeof e.className?e.className:"",useShadows:"undefined"==typeof e.useShadows||e.useShadows,handleMouseWheel:"undefined"==typeof e.handleMouseWheel||e.handleMouseWheel,flipAxes:"undefined"!=typeof e.flipAxes&&e.flipAxes,scrollYToX:"undefined"!=typeof e.scrollYToX&&e.scrollYToX,mouseWheelScrollSensitivity:"undefined"!=typeof e.mouseWheelScrollSensitivity?e.mouseWheelScrollSensitivity:1,arrowSize:"undefined"!=typeof e.arrowSize?e.arrowSize:11,listenOnDomNode:"undefined"!=typeof e.listenOnDomNode?e.listenOnDomNode:null,horizontal:"undefined"!=typeof e.horizontal?e.horizontal:h.ScrollbarVisibility.Auto,horizontalScrollbarSize:"undefined"!=typeof e.horizontalScrollbarSize?e.horizontalScrollbarSize:10,horizontalSliderSize:"undefined"!=typeof e.horizontalSliderSize?e.horizontalSliderSize:0,horizontalHasArrows:"undefined"!=typeof e.horizontalHasArrows&&e.horizontalHasArrows,vertical:"undefined"!=typeof e.vertical?e.vertical:h.ScrollbarVisibility.Auto,verticalScrollbarSize:"undefined"!=typeof e.verticalScrollbarSize?e.verticalScrollbarSize:10,verticalHasArrows:"undefined"!=typeof e.verticalHasArrows&&e.verticalHasArrows,verticalSliderSize:"undefined"!=typeof e.verticalSliderSize?e.verticalSliderSize:0,saveLastScrollTimeOnClassName:"undefined"!=typeof e.saveLastScrollTimeOnClassName?e.saveLastScrollTimeOnClassName:null};return o.horizontalSliderSize="undefined"!=typeof e.horizontalSliderSize?e.horizontalSliderSize:o.horizontalScrollbarSize,o.verticalSliderSize="undefined"!=typeof e.verticalSliderSize?e.verticalSliderSize:o.verticalScrollbarSize,i.isMacintosh&&(o.className+=" mac"),o}var m=500,S=50,f=function(e){function o(o,t){var s=this;e.call(this),this._onScroll=this._register(new _.Emitter),this.onScroll=this._onScroll.event,o.style.overflow="hidden",this._options=p(t),this._scrollable=this._register(new h.Scrollable),this._register(this._scrollable.onScroll(function(e){s._onDidScroll(e),s._onScroll.fire(e)}));var i={onMouseWheel:function(e){return s._onMouseWheel(e)},onDragStart:function(){return s._onDragStart()},onDragEnd:function(){return s._onDragEnd()}};this._verticalScrollbar=this._register(new n.VerticalScrollbar(this._scrollable,this._options,i)),this._horizontalScrollbar=this._register(new r.HorizontalScrollbar(this._scrollable,this._options,i)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(o),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows&&(this._leftShadowDomNode=u.createFastDomNode(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=u.createFastDomNode(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=u.createFastDomNode(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow top-left-corner"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,function(e){return s._onMouseOver(e)}),this.onnonbubblingmouseout(this._listenOnDomNode,function(e){return s._onMouseOut(e)}),this._hideTimeout=this._register(new c.TimeoutTimer),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0}return __extends(o,e),o.prototype.dispose=function(){this._mouseWheelToDispose=a.dispose(this._mouseWheelToDispose),e.prototype.dispose.call(this)},o.prototype.getDomNode=function(){return this._domNode},o.prototype.getOverviewRulerLayoutInfo=function(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}},o.prototype.delegateVerticalScrollbarMouseDown=function(e){this._verticalScrollbar.delegateMouseDown(e)},o.prototype.updateState=function(e){this._scrollable.updateState(e)},o.prototype.getWidth=function(){return this._scrollable.getWidth()},o.prototype.getScrollWidth=function(){return this._scrollable.getScrollWidth()},o.prototype.getScrollLeft=function(){return this._scrollable.getScrollLeft()},o.prototype.getHeight=function(){return this._scrollable.getHeight()},o.prototype.getScrollHeight=function(){return this._scrollable.getScrollHeight()},o.prototype.getScrollTop=function(){return this._scrollable.getScrollTop()},o.prototype.updateClassName=function(e){this._options.className=e,i.isMacintosh&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className},o.prototype.updateOptions=function(e){var o=p(e);this._options.handleMouseWheel=o.handleMouseWheel,this._options.mouseWheelScrollSensitivity=o.mouseWheelScrollSensitivity,this._setListeningToMouseWheel(this._options.handleMouseWheel),this._shouldRender=this._horizontalScrollbar.setCanUseTranslate3d(o.canUseTranslate3d)||this._shouldRender,this._shouldRender=this._verticalScrollbar.setCanUseTranslate3d(o.canUseTranslate3d)||this._shouldRender,this._options.lazyRender||this._render()},o.prototype._setListeningToMouseWheel=function(e){var o=this,t=this._mouseWheelToDispose.length>0;if(t!==e&&(this._mouseWheelToDispose=a.dispose(this._mouseWheelToDispose),e)){var i=function(e){var t=new l.StandardMouseWheelEvent(e);o._onMouseWheel(t)};this._mouseWheelToDispose.push(s.addDisposableListener(this._listenOnDomNode,"mousewheel",i)),this._mouseWheelToDispose.push(s.addDisposableListener(this._listenOnDomNode,"DOMMouseScroll",i))}},o.prototype._onMouseWheel=function(e){if(i.isMacintosh&&e.browserEvent&&this._options.saveLastScrollTimeOnClassName){var o=e.browserEvent.target;if(o&&1===o.nodeType){var t=s.findParentWithClass(o,this._options.saveLastScrollTimeOnClassName);t&&t.setAttribute("last-scroll-time",String((new Date).getTime()))}}var l=-1,r=-1;if(e.deltaY||e.deltaX){var n=e.deltaY*this._options.mouseWheelScrollSensitivity,a=e.deltaX*this._options.mouseWheelScrollSensitivity;if(this._options.flipAxes&&(n=a,a=n),this._options.scrollYToX&&!a&&(a=n,n=0),i.isMacintosh&&(n&&Math.abs(a)<.2&&(a=0),Math.abs(n)>.5*Math.abs(a)&&(a=0)),n){var h=this._scrollable.getScrollTop();l=this._verticalScrollbar.validateScrollPosition((l!==-1?l:h)-S*n),l===h&&(l=-1)}if(a){var d=this._scrollable.getScrollLeft();r=this._horizontalScrollbar.validateScrollPosition((r!==-1?r:d)-S*a),r===d&&(r=-1)}l===-1&&r===-1||(l!==-1&&(this._shouldRender=this._verticalScrollbar.setDesiredScrollPosition(l)||this._shouldRender,l=-1),r!==-1&&(this._shouldRender=this._horizontalScrollbar.setDesiredScrollPosition(r)||this._shouldRender,r=-1))}e.preventDefault(),e.stopPropagation()},o.prototype._onDidScroll=function(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._reveal(),this._options.lazyRender||this._render()},o.prototype.renderNow=function(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()},o.prototype._render=function(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){var e=this._scrollable.getScrollTop()>0,o=this._scrollable.getScrollLeft()>0;this._leftShadowDomNode.setClassName("shadow"+(o?" left":"")),this._topShadowDomNode.setClassName("shadow"+(e?" top":"")),this._topLeftShadowDomNode.setClassName("shadow top-left-corner"+(e?" top":"")+(o?" left":""))}},o.prototype._onDragStart=function(){this._isDragging=!0,this._reveal()},o.prototype._onDragEnd=function(){this._isDragging=!1,this._hide()},o.prototype._onMouseOut=function(e){this._mouseIsOver=!1,this._hide()},o.prototype._onMouseOver=function(e){this._mouseIsOver=!0,this._reveal()},o.prototype._reveal=function(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()},o.prototype._hide=function(){this._mouseIsOver||this._isDragging||(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())},o.prototype._scheduleHide=function(){var e=this;this._hideTimeout.cancelAndSet(function(){return e._hide()},m)},o}(d.Widget);o.ScrollableElement=f;var v=function(e){function o(o,t){var s=this;e.call(this,o,t),this._element=o,this.onScroll(function(e){e.scrollTopChanged&&(s._element.scrollTop=e.scrollTop),e.scrollLeftChanged&&(s._element.scrollLeft=e.scrollLeft)}),this.scanDomNode()}return __extends(o,e),o.prototype.scanDomNode=function(){this.updateState({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,scrollLeft:this._element.scrollLeft,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight,scrollTop:this._element.scrollTop})},o}(f);o.DomScrollableElement=v});