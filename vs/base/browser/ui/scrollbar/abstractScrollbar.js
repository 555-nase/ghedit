var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};define(["require","exports","vs/base/common/platform","vs/base/browser/dom","vs/base/browser/mouseEvent","vs/base/browser/globalMouseMoveMonitor","vs/base/browser/ui/widget","vs/base/browser/styleMutator","vs/base/browser/ui/scrollbar/scrollbarArrow","vs/base/browser/ui/scrollbar/scrollbarVisibilityController"],function(e,t,o,s,i,r,l,n,d,a){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";var h=140,c=function(e){function t(t){var o=this;e.call(this),this._canUseTranslate3d=t.canUseTranslate3d,this._lazyRender=t.lazyRender,this._host=t.host,this._scrollable=t.scrollable,this._scrollbarState=t.scrollbarState,this._visibilityController=this._register(new a.ScrollbarVisibilityController(t.visibility,"visible scrollbar "+t.extraScrollbarClassName,"invisible scrollbar "+t.extraScrollbarClassName)),this._mouseMoveMonitor=this._register(new r.GlobalMouseMoveMonitor),this._shouldRender=!0,this.domNode=n.createFastDomNode(document.createElement("div")),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this.onmousedown(this.domNode.domNode,function(e){return o._domNodeMouseDown(e)})}return __extends(t,e),t.prototype._createArrow=function(e){var t=this._register(new d.ScrollbarArrow(e));this.domNode.domNode.appendChild(t.bgDomNode),this.domNode.domNode.appendChild(t.domNode)},t.prototype._createSlider=function(e,t,o,s){var i=this;this.slider=n.createFastDomNode(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(t),this.slider.setWidth(o),this.slider.setHeight(s),this.domNode.domNode.appendChild(this.slider.domNode),this.onmousedown(this.slider.domNode,function(e){return i._sliderMouseDown(e)})},t.prototype.setCanUseTranslate3d=function(e){return this._canUseTranslate3d=e,!0},t.prototype._onElementSize=function(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender},t.prototype._onElementScrollSize=function(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender},t.prototype._onElementScrollPosition=function(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender},t.prototype.beginReveal=function(){this._visibilityController.setShouldBeVisible(!0)},t.prototype.beginHide=function(){this._visibilityController.setShouldBeVisible(!1)},t.prototype.render=function(){this._shouldRender&&(this._shouldRender=!1,this._canUseTranslate3d?this.domNode.setTransform("translate3d(0px, 0px, 0px)"):this.domNode.setTransform(""),this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))},t.prototype._domNodeMouseDown=function(e){e.target===this.domNode.domNode&&this._onMouseDown(e)},t.prototype.delegateMouseDown=function(e){var t=new i.StandardMouseEvent(e),o=this.domNode.domNode.getClientRects()[0].top,s=o+this._scrollbarState.getSliderPosition(),r=o+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),l=this._sliderMousePosition(t);s<=l&&l<=r?this._sliderMouseDown(t):this._onMouseDown(t)},t.prototype._onMouseDown=function(e){var t=s.getDomNodePagePosition(this.domNode.domNode),o=this._mouseDownRelativePosition(e,t)-this._scrollbarState.getArrowSize()-this._scrollbarState.getSliderSize()/2;this.setDesiredScrollPosition(this._scrollbarState.convertSliderPositionToScrollPosition(o)),this._sliderMouseDown(e)},t.prototype._sliderMouseDown=function(e){var t=this;if(e.leftButton){var s=this._sliderOrthogonalMousePosition(e),i=this._getScrollPosition(),l=this._sliderMousePosition(e)-this._scrollbarState.getSliderPosition();this.slider.toggleClassName("active",!0),this._mouseMoveMonitor.startMonitoring(r.standardMouseMoveMerger,function(e){var r=t._sliderOrthogonalMousePosition(e),n=Math.abs(r-s);if(o.isWindows&&n>h)t.setDesiredScrollPosition(i);else{var d=t._sliderMousePosition(e)-l;t.setDesiredScrollPosition(t._scrollbarState.convertSliderPositionToScrollPosition(d))}},function(){t.slider.toggleClassName("active",!1),t._host.onDragEnd()}),e.preventDefault(),this._host.onDragStart()}},t.prototype.validateScrollPosition=function(e){return this._scrollbarState.validateScrollPosition(e)},t.prototype.setDesiredScrollPosition=function(e){e=this.validateScrollPosition(e);var t=this._getScrollPosition();this._setScrollPosition(e);var o=this._getScrollPosition();return t!==o&&(this._onElementScrollPosition(this._getScrollPosition()),!0)},t}(l.Widget);t.AbstractScrollbar=c});