var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};define(["require","exports","vs/nls","vs/base/common/winjs.base","vs/base/common/actions","vs/base/common/platform","vs/base/common/errors","vs/base/browser/dom","vs/base/common/keyCodes"],function(e,t,n,o,r,i,a,u,s){/*---------------------------------------------------------------------------------------------
     *  Copyright (c) Microsoft Corporation. All rights reserved.
     *  Licensed under the MIT License. See License.txt in the project root for license information.
     *--------------------------------------------------------------------------------------------*/
"use strict";var c=function(){function e(){}return e.prototype.getHeight=function(e,t){return 20},e.prototype.getTemplateId=function(e,t){return"legacy"},e.prototype.renderTemplate=function(e,t,n){return{root:n,element:null,previousCleanupFn:null}},e.prototype.renderElement=function(e,t,n,o){for(o.previousCleanupFn&&o.previousCleanupFn(e,o.element);o.root&&o.root.firstChild;)o.root.removeChild(o.root.firstChild);o.element=t,o.previousCleanupFn=this.render(e,t,o.root)},e.prototype.disposeTemplate=function(e,t,n){n.previousCleanupFn&&n.previousCleanupFn(e,n.element),n.root=null,n.element=null,n.previousCleanupFn=null},e.prototype.render=function(e,t,n,o){return n.textContent=""+t,null},e}();t.LegacyRenderer=c,function(e){e[e.ON_MOUSE_DOWN=0]="ON_MOUSE_DOWN",e[e.ON_MOUSE_UP=1]="ON_MOUSE_UP"}(t.ClickBehavior||(t.ClickBehavior={}));var l=t.ClickBehavior,p=function(){function e(){this._arr=[]}return e.prototype.set=function(e,t){this._arr.push({keybinding:e,callback:t})},e.prototype.dispatch=function(e){for(var t=this._arr.length-1;t>=0;t--){var n=this._arr[t];if(e===n.keybinding)return n.callback}return null},e}();t.KeybindingDispatcher=p;var g=function(){function e(e){var t=this;void 0===e&&(e={clickBehavior:l.ON_MOUSE_UP}),this.options=e,this.downKeyBindingDispatcher=new p,this.downKeyBindingDispatcher.set(s.CommonKeybindings.SPACE,function(e,n){return t.onSpace(e,n)}),this.downKeyBindingDispatcher.set(s.CommonKeybindings.UP_ARROW,function(e,n){return t.onUp(e,n)}),this.downKeyBindingDispatcher.set(s.CommonKeybindings.PAGE_UP,function(e,n){return t.onPageUp(e,n)}),this.downKeyBindingDispatcher.set(s.CommonKeybindings.DOWN_ARROW,function(e,n){return t.onDown(e,n)}),this.downKeyBindingDispatcher.set(s.CommonKeybindings.PAGE_DOWN,function(e,n){return t.onPageDown(e,n)}),this.downKeyBindingDispatcher.set(s.CommonKeybindings.LEFT_ARROW,function(e,n){return t.onLeft(e,n)}),this.downKeyBindingDispatcher.set(s.CommonKeybindings.RIGHT_ARROW,function(e,n){return t.onRight(e,n)}),this.downKeyBindingDispatcher.set(s.CommonKeybindings.ESCAPE,function(e,n){return t.onEscape(e,n)}),this.upKeyBindingDispatcher=new p,this.upKeyBindingDispatcher.set(s.CommonKeybindings.ENTER,this.onEnter.bind(this)),this.upKeyBindingDispatcher.set(s.CommonKeybindings.CTRLCMD_ENTER,this.onEnter.bind(this))}return e.prototype.onMouseDown=function(e,t,n,o){if(void 0===o&&(o="mouse"),this.options.clickBehavior===l.ON_MOUSE_DOWN&&n.leftButton){if(n.target){if(n.target.tagName&&"input"===n.target.tagName.toLowerCase())return!1;if(u.findParentWithClass(n.target,"monaco-action-bar","row"))return!1}return this.onLeftClick(e,t,n,o)}return!1},e.prototype.onClick=function(e,t,n){var o=i.isMacintosh;return o&&n.ctrlKey?(n.preventDefault(),n.stopPropagation(),!1):!n.middleButton&&((!n.target||!n.target.tagName||"input"!==n.target.tagName.toLowerCase())&&((this.options.clickBehavior!==l.ON_MOUSE_DOWN||!n.leftButton)&&this.onLeftClick(e,t,n)))},e.prototype.onLeftClick=function(e,t,n,o){void 0===o&&(o="mouse");var r={origin:o,originalEvent:n};if(e.getInput()===t)e.clearFocus(r),e.clearSelection(r);else{var i=n&&n.browserEvent&&"mousedown"===n.browserEvent.type;i||n.preventDefault(),n.stopPropagation(),e.DOMFocus(),e.setSelection([t],r),e.setFocus(t,r),e.isExpanded(t)?e.collapse(t).done(null,a.onUnexpectedError):e.expand(t).done(null,a.onUnexpectedError)}return!0},e.prototype.onContextMenu=function(e,t,n){return(!n.target||!n.target.tagName||"input"!==n.target.tagName.toLowerCase())&&(n&&(n.preventDefault(),n.stopPropagation()),!1)},e.prototype.onTap=function(e,t,n){var o=n.initialTarget;return(!o||!o.tagName||"input"!==o.tagName.toLowerCase())&&this.onLeftClick(e,t,n,"touch")},e.prototype.onKeyDown=function(e,t){return this.onKey(this.downKeyBindingDispatcher,e,t)},e.prototype.onKeyUp=function(e,t){return this.onKey(this.upKeyBindingDispatcher,e,t)},e.prototype.onKey=function(e,t,n){var o=e.dispatch(n.asKeybinding());return!(!o||!o(t,n))&&(n.preventDefault(),n.stopPropagation(),!0)},e.prototype.onUp=function(e,t){var n={origin:"keyboard",originalEvent:t};return e.getHighlight()?e.clearHighlight(n):(e.focusPrevious(1,n),e.reveal(e.getFocus()).done(null,a.onUnexpectedError)),!0},e.prototype.onPageUp=function(e,t){var n={origin:"keyboard",originalEvent:t};return e.getHighlight()?e.clearHighlight(n):(e.focusPreviousPage(n),e.reveal(e.getFocus()).done(null,a.onUnexpectedError)),!0},e.prototype.onDown=function(e,t){var n={origin:"keyboard",originalEvent:t};return e.getHighlight()?e.clearHighlight(n):(e.focusNext(1,n),e.reveal(e.getFocus()).done(null,a.onUnexpectedError)),!0},e.prototype.onPageDown=function(e,t){var n={origin:"keyboard",originalEvent:t};return e.getHighlight()?e.clearHighlight(n):(e.focusNextPage(n),e.reveal(e.getFocus()).done(null,a.onUnexpectedError)),!0},e.prototype.onLeft=function(e,t){var n={origin:"keyboard",originalEvent:t};if(e.getHighlight())e.clearHighlight(n);else{var o=e.getFocus();e.collapse(o).then(function(t){if(o&&!t)return e.focusParent(n),e.reveal(e.getFocus())}).done(null,a.onUnexpectedError)}return!0},e.prototype.onRight=function(e,t){var n={origin:"keyboard",originalEvent:t};if(e.getHighlight())e.clearHighlight(n);else{var o=e.getFocus();e.expand(o).then(function(t){if(o&&!t)return e.focusFirstChild(n),e.reveal(e.getFocus())}).done(null,a.onUnexpectedError)}return!0},e.prototype.onEnter=function(e,t){var n={origin:"keyboard",originalEvent:t};if(e.getHighlight())return!1;var o=e.getFocus();return o&&e.setSelection([o],n),!0},e.prototype.onSpace=function(e,t){if(e.getHighlight())return!1;var n=e.getFocus();return n&&e.toggleExpansion(n),!0},e.prototype.onEscape=function(e,t){var n={origin:"keyboard",originalEvent:t};return e.getHighlight()?(e.clearHighlight(n),!0):e.getSelection().length?(e.clearSelection(n),!0):!!e.getFocus()&&(e.clearFocus(n),!0)},e}();t.DefaultController=g;var h=function(){function e(){}return e.prototype.getDragURI=function(e,t){return null},e.prototype.onDragStart=function(e,t,n){},e.prototype.onDragOver=function(e,t,n,o){return null},e.prototype.drop=function(e,t,n,o){},e}();t.DefaultDragAndDrop=h;var f=function(){function e(){}return e.prototype.isVisible=function(e,t){return!0},e}();t.DefaultFilter=f;var d=function(){function e(){}return e.prototype.compare=function(e,t,n){return 0},e}();t.DefaultSorter=d;var v=function(){function e(){}return e.prototype.getAriaLabel=function(e,t){return null},e}();t.DefaultAccessibilityProvider=v;var y=function(e){function t(t,o){e.call(this,"vs.tree.collapse",n.localize("collapse","Collapse"),"monaco-tree-action collapse-all",o),this.viewer=t}return __extends(t,e),t.prototype.run=function(e){return this.viewer.getHighlight()?o.TPromise.as(null):(this.viewer.collapseAll(),this.viewer.clearSelection(),this.viewer.clearFocus(),this.viewer.DOMFocus(),this.viewer.focusFirst(),o.TPromise.as(null))},t}(r.Action);t.CollapseAllAction=y});