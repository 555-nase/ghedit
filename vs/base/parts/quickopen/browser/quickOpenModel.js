/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};define(["require","exports","vs/nls","vs/base/common/winjs.base","vs/base/common/types","vs/base/common/filters","vs/base/common/strings","vs/base/common/paths","vs/base/common/comparers","vs/base/browser/ui/actionbar/actionbar","vs/base/parts/tree/browser/treeDefaults","vs/base/browser/ui/highlightedlabel/highlightedLabel","vs/base/browser/dom","vs/base/common/scorer"],function(t,e,n,r,i,o,s,a,c,l,u,p,h,g){"use strict";var d=0,y=function(){function t(t){void 0===t&&(t=[]),this.id=(d++).toString(),this.labelHighlights=t,this.descriptionHighlights=[]}return t.prototype.getId=function(){return this.id},t.prototype.getLabel=function(){return null},t.prototype.getAriaLabel=function(){return this.getLabel()},t.prototype.getDetail=function(){return null},t.prototype.getIcon=function(){return null},t.prototype.getDescription=function(){return null},t.prototype.getResource=function(){return null},t.prototype.getExtraClass=function(){return null},t.prototype.isHidden=function(){return this.hidden},t.prototype.setHidden=function(t){this.hidden=t},t.prototype.setHighlights=function(t,e,n){this.labelHighlights=t,this.descriptionHighlights=e,this.detailHighlights=n},t.prototype.getHighlights=function(){return[this.labelHighlights,this.descriptionHighlights,this.detailHighlights]},t.prototype.run=function(t,e){return!1},t.compare=function(t,e,n){n&&(n=s.stripWildcards(n).toLowerCase());var r=t.getHighlights()[0]||[],i=e.getHighlights()[0]||[];if(r.length&&!i.length)return-1;if(!r.length&&i.length)return 1;var o=t.getLabel(),a=e.getLabel();if(o===a){var l=t.getResource(),u=e.getResource();l&&u&&(o=l.fsPath,a=u.fsPath)}return c.compareAnything(o,a,n)},t.compareByScore=function(t,e,n,r,i){var o=t.getLabel(),s=e.getLabel(),a=c.compareByPrefix(o,s,n);if(a)return a;var l=g.score(o,n,i),u=g.score(s,n,i);if(l!==u)return l>u?-1:1;var p=t.getResource(),h=e.getResource();if(p&&h){var d=g.score(p.fsPath,n,i),y=g.score(h.fsPath,n,i);if(d!==y)return d>y?-1:1}return o.length!==s.length?o.length<s.length?-1:1:p&&h&&p.fsPath.length!==h.fsPath.length?p.fsPath.length<h.fsPath.length?-1:1:o===s&&p&&h?c.compareAnything(p.fsPath,h.fsPath,r):c.compareAnything(o,s,r)},t.highlight=function(t,e,n){void 0===n&&(n=!1);var r=[],i=[],c=s.stripWildcards(e),l=t.getLabel(),u=t.getDescription();if(t.getResource())if(e.toLowerCase()===t.getResource().fsPath.toLowerCase())r.push({start:0,end:l.length}),i.push({start:0,end:u.length});else if(n||e.indexOf(a.nativeSep)>=0){var p=o.matchesFuzzy(e,l,n);if(p)r=p;else{var h=u?u+a.nativeSep:"",g=h.length,d=o.matchesFuzzy(e,h+l,n);d||e===c||(d=o.matchesFuzzy(c,h+l,n)),d&&d.forEach(function(t){t.start<g&&t.end>g?(r.push({start:0,end:t.end-g}),i.push({start:t.start,end:g})):t.start>=g?r.push({start:t.start-g,end:t.end-g}):i.push(t)})}}else r=o.matchesFuzzy(e,l);else r=o.matchesFuzzy(e,l);return{labelHighlights:r,descriptionHighlights:i}},t}();e.QuickOpenEntry=y;var f=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.getHeight=function(){return 0},e.prototype.render=function(t,e,n){return null},e}(y);e.QuickOpenEntryItem=f;var b=function(t){function e(e,n,r){t.call(this),this.entry=e,this.groupLabel=n,this.withBorder=r}return __extends(e,t),e.prototype.getGroupLabel=function(){return this.groupLabel},e.prototype.setGroupLabel=function(t){this.groupLabel=t},e.prototype.showBorder=function(){return this.withBorder},e.prototype.setShowBorder=function(t){this.withBorder=t},e.prototype.getLabel=function(){return this.entry?this.entry.getLabel():t.prototype.getLabel.call(this)},e.prototype.getAriaLabel=function(){return this.entry?this.entry.getAriaLabel():t.prototype.getAriaLabel.call(this)},e.prototype.getDetail=function(){return this.entry?this.entry.getDetail():t.prototype.getDetail.call(this)},e.prototype.getResource=function(){return this.entry?this.entry.getResource():t.prototype.getResource.call(this)},e.prototype.getIcon=function(){return this.entry?this.entry.getIcon():t.prototype.getIcon.call(this)},e.prototype.getDescription=function(){return this.entry?this.entry.getDescription():t.prototype.getDescription.call(this)},e.prototype.getEntry=function(){return this.entry},e.prototype.getHighlights=function(){return this.entry?this.entry.getHighlights():t.prototype.getHighlights.call(this)},e.prototype.getExtraClass=function(){return this.entry?this.entry.getExtraClass():t.prototype.getExtraClass.call(this)},e.prototype.isHidden=function(){return this.entry?this.entry.isHidden():t.prototype.isHidden.call(this)},e.prototype.setHighlights=function(e,n,r){this.entry?this.entry.setHighlights(e,n,r):t.prototype.setHighlights.call(this,e,n,r)},e.prototype.setHidden=function(e){this.entry?this.entry.setHidden(e):t.prototype.setHidden.call(this,e)},e.prototype.run=function(e,n){return this.entry?this.entry.run(e,n):t.prototype.run.call(this,e,n)},e}(y);e.QuickOpenEntryGroup=b;var m="quickOpenEntry",v="quickOpenEntryGroup",H="quickOpenEntryItem",L=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.getTemplateId=function(t,e){return H},e.prototype.render=function(e,n,r,i){return n instanceof f?n.render(e,r,i):t.prototype.render.call(this,e,n,r,i)},e}(u.LegacyRenderer),C=function(){function t(){}return t.prototype.hasActions=function(t,e){return!1},t.prototype.getActions=function(t,e){return r.TPromise.as(null)},t.prototype.hasSecondaryActions=function(t,e){return!1},t.prototype.getSecondaryActions=function(t,e){return r.TPromise.as(null)},t.prototype.getActionItem=function(t,e,n){return null},t}(),E=function(){function t(t,e){void 0===t&&(t=new C),void 0===e&&(e=null),this.actionProvider=t,this.actionRunner=e,this.entryItemRenderer=new L}return t.prototype.getHeight=function(t){return t instanceof f?t.getHeight():t.getDetail()?44:22},t.prototype.getTemplateId=function(t){return t instanceof f?H:t instanceof b?v:m},t.prototype.renderTemplate=function(t,e){if(t===H)return this.entryItemRenderer.renderTemplate(null,t,e);var n;t===v&&(n=document.createElement("div"),h.addClass(n,"results-group"),e.appendChild(n)),h.addClass(e,"actions");var r=document.createElement("div");h.addClass(r,"sub-content"),e.appendChild(r);var i=document.createElement("div");h.addClass(i,"primary-action-bar"),e.appendChild(i);var o=new l.ActionBar(i,{actionRunner:this.actionRunner}),s=document.createElement("div");h.addClass(s,"quick-open-entry"),r.appendChild(s);var a=document.createElement("span");s.appendChild(a);var c=new p.HighlightedLabel(s),u=document.createElement("span");s.appendChild(u),h.addClass(u,"quick-open-entry-description");var g=new p.HighlightedLabel(u),d=document.createElement("div");s.appendChild(d),h.addClass(d,"quick-open-entry-meta");var y=new p.HighlightedLabel(d);return{container:e,entry:s,icon:a,label:c,detail:y,description:g,group:n,actionBar:o}},t.prototype.renderElement=function(t,e,n){if(e===H)return void this.entryItemRenderer.renderElement(null,t,e,n);var r=n;if(this.actionProvider.hasActions(null,t)?h.addClass(r.container,"has-actions"):h.removeClass(r.container,"has-actions"),r.actionBar.context=t,this.actionProvider.getActions(null,t).then(function(t){r.actionBar.isEmpty()&&t&&t.length>0?r.actionBar.push(t,{icon:!0,label:!1}):r.actionBar.isEmpty()||t&&0!==t.length||r.actionBar.clear()}),t instanceof b){var i=t;i.showBorder()?h.addClass(r.container,"results-group-separator"):h.removeClass(r.container,"results-group-separator");var o=i.getGroupLabel()||"";n.group.textContent=o}if(t instanceof y){var s=t.getHighlights(),a=s[0],c=s[1],l=s[2],u=t.getExtraClass();u?h.addClass(r.entry,u):r.entry.className="quick-open-entry";var p=t.getIcon()?"quick-open-entry-icon "+t.getIcon():"";r.icon.className=p,r.label.set(t.getLabel(),a||[]),r.detail.set(t.getDetail(),l),r.description.set(t.getDescription(),c||[]),r.description.element.title=t.getDescription()}},t.prototype.disposeTemplate=function(t,e){if(t===H)this.entryItemRenderer.disposeTemplate(null,t,e);else{var n=e;n.actionBar.dispose(),n.actionBar=null,n.container=null,n.entry=null,n.description.dispose(),n.description=null,n.detail.dispose(),n.detail=null,n.group=null,n.icon=null,n.label.dispose(),n.label=null}},t}(),_=function(){function t(t,e){void 0===t&&(t=[]),void 0===e&&(e=new C),this._entries=t,this._dataSource=this,this._renderer=new E(e),this._filter=this,this._runner=this,this._accessibilityProvider=this}return Object.defineProperty(t.prototype,"entries",{get:function(){return this._entries},set:function(t){this._entries=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataSource",{get:function(){return this._dataSource},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderer",{get:function(){return this._renderer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filter",{get:function(){return this._filter},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"runner",{get:function(){return this._runner},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"accessibilityProvider",{get:function(){return this._accessibilityProvider},enumerable:!0,configurable:!0}),t.prototype.addEntries=function(t){i.isArray(t)&&(this._entries=this._entries.concat(t))},t.prototype.setEntries=function(t){i.isArray(t)&&(this._entries=t)},t.prototype.getEntries=function(t){return t?this._entries.filter(function(t){return!t.isHidden()}):this._entries},t.prototype.getId=function(t){return t.getId()},t.prototype.getLabel=function(t){return t.getLabel()},t.prototype.getAriaLabel=function(t){var e=t.getAriaLabel();return e?n.localize("quickOpenAriaLabelEntry","{0}, picker",t.getAriaLabel()):n.localize("quickOpenAriaLabel","picker")},t.prototype.isVisible=function(t){return!t.isHidden()},t.prototype.run=function(t,e,n){return t.run(e,n)},t}();e.QuickOpenModel=_});