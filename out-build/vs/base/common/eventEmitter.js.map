{"version":3,"file":"vs/base/common/eventEmitter.js","sourceRoot":"file:///Users/darrin/src/vscode/src","sources":["vs/base/common/eventEmitter.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\n\nimport Errors = require('vs/base/common/errors');\nimport Lifecycle = require('vs/base/common/lifecycle');\n\nexport interface IEmitterEvent {\n\tgetType():string;\n\tgetData():any;\n}\n\nexport class EmitterEvent implements IEmitterEvent {\n\n\tprivate _type:string;\n\tprivate _data:any;\n\tprivate _emitterType:string;\n\n\tconstructor(eventType:string=null, data:any=null, emitterType:string=null) {\n\t\tthis._type = eventType;\n\t\tthis._data = data;\n\t\tthis._emitterType = emitterType;\n\t}\n\n\tpublic getType():string {\n\t\treturn this._type;\n\t}\n\n\tpublic getData():any {\n\t\treturn this._data;\n\t}\n\n\tpublic getEmitterType():string {\n\t\treturn this._emitterType;\n\t}\n}\n\nexport interface ListenerCallback {\n\t(value:any):void;\n}\n\nexport interface IBulkListenerCallback {\n\t(value:IEmitterEvent[]):void;\n}\n\nexport interface ListenerUnbind {\n\t():void;\n}\n\nexport interface IEventEmitter extends Lifecycle.IDisposable {\n\taddListener(eventType:string, listener:ListenerCallback):ListenerUnbind;\n\taddListener2(eventType:string, listener:ListenerCallback):Lifecycle.IDisposable;\n\taddOneTimeListener(eventType:string, listener:ListenerCallback):ListenerUnbind;\n\n\taddBulkListener(listener:IBulkListenerCallback):ListenerUnbind;\n\taddBulkListener2(listener:IBulkListenerCallback):Lifecycle.IDisposable;\n\n\taddEmitter(eventEmitter:IEventEmitter, emitterType?:string):ListenerUnbind;\n\taddEmitter2(eventEmitter:IEventEmitter, emitterType?:string):Lifecycle.IDisposable;\n\n\taddEmitterTypeListener(eventType:string, emitterType:string, listener:ListenerCallback):ListenerUnbind;\n\temit(eventType:string, data?:any):void;\n}\n\nexport interface IListenersMap {\n\t[key:string]:ListenerCallback[];\n}\n\nexport class EventEmitter implements IEventEmitter {\n\n\tprotected _listeners:IListenersMap;\n\tprotected _bulkListeners:ListenerCallback[];\n\tprivate _collectedEvents:EmitterEvent[];\n\tprivate _deferredCnt:number;\n\tprivate _allowedEventTypes:{[eventType:string]:boolean;};\n\n\tconstructor(allowedEventTypes:string[] = null) {\n\t\tthis._listeners = {};\n\t\tthis._bulkListeners = [];\n\t\tthis._collectedEvents = [];\n\t\tthis._deferredCnt = 0;\n\t\tif (allowedEventTypes) {\n\t\t\tthis._allowedEventTypes = {};\n\t\t\tfor (var i = 0; i < allowedEventTypes.length; i++) {\n\t\t\t\tthis._allowedEventTypes[allowedEventTypes[i]] = true;\n\t\t\t}\n\t\t} else {\n\t\t\tthis._allowedEventTypes = null;\n\t\t}\n\t}\n\n\tpublic dispose(): void {\n\t\tthis._listeners = {};\n\t\tthis._bulkListeners = [];\n\t\tthis._collectedEvents = [];\n\t\tthis._deferredCnt = 0;\n\t\tthis._allowedEventTypes = null;\n\t}\n\n\tpublic addListener(eventType:string, listener:ListenerCallback):ListenerUnbind {\n\t\tif (eventType === '*') {\n\t\t\tthrow new Error('Use addBulkListener(listener) to register your listener!');\n\t\t}\n\n\t\tif (this._allowedEventTypes && !this._allowedEventTypes.hasOwnProperty(eventType)) {\n\t\t\tthrow new Error('This object will never emit this event type!');\n\t\t}\n\n\t\tif (this._listeners.hasOwnProperty(eventType)) {\n\t\t\tthis._listeners[eventType].push(listener);\n\t\t} else {\n\t\t\tthis._listeners[eventType] = [listener];\n\t\t}\n\n\t\tvar bound = this;\n\t\treturn () => {\n\t\t\tif (!bound) {\n\t\t\t\t// Already called\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tbound._removeListener(eventType, listener);\n\n\t\t\t// Prevent leakers from holding on to the event emitter\n\t\t\tbound = null;\n\t\t\tlistener = null;\n\t\t};\n\t}\n\n\tpublic addListener2(eventType:string, listener:ListenerCallback):Lifecycle.IDisposable {\n\t\tvar dispose = this.addListener(eventType, listener);\n\t\treturn {\n\t\t\tdispose: dispose\n\t\t};\n\t}\n\n\tpublic on(eventType:string, listener:ListenerCallback):ListenerUnbind {\n\t\treturn this.addListener(eventType, listener);\n\t}\n\n\tpublic addOneTimeListener(eventType:string, listener:ListenerCallback):ListenerUnbind {\n\t\tvar unbind:ListenerUnbind = this.addListener(eventType, function(value:any) {\n\t\t\tunbind();\n\t\t\tlistener(value);\n\t\t});\n\t\treturn unbind;\n\t}\n\n\tpublic addOneTimeDisposableListener(eventType:string, listener:ListenerCallback):Lifecycle.IDisposable {\n\t\tvar dispose = this.addOneTimeListener(eventType, listener);\n\t\treturn {\n\t\t\tdispose: dispose\n\t\t};\n\t}\n\n\tpublic addBulkListener(listener:IBulkListenerCallback):ListenerUnbind {\n\n\t\tthis._bulkListeners.push(listener);\n\n\t\treturn () => {\n\t\t\tthis._removeBulkListener(listener);\n\t\t};\n\t}\n\n\tpublic addBulkListener2(listener:IBulkListenerCallback):Lifecycle.IDisposable {\n\t\tvar dispose = this.addBulkListener(listener);\n\t\treturn {\n\t\t\tdispose: dispose\n\t\t};\n\t}\n\n\tpublic addEmitter(eventEmitter:IEventEmitter, emitterType:string=null):ListenerUnbind {\n\t\treturn eventEmitter.addBulkListener((events:IEmitterEvent[]):void => {\n\t\t\tvar newEvents = events;\n\n\t\t\tif (emitterType) {\n\t\t\t\t// If the emitter has an emitterType, recreate events\n\t\t\t\tnewEvents = [];\n\t\t\t\tfor (var i = 0, len = events.length; i < len; i++) {\n\t\t\t\t\tnewEvents.push(new EmitterEvent(events[i].getType(), events[i].getData(), emitterType));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this._deferredCnt === 0) {\n\t\t\t\tthis._emitEvents(<EmitterEvent[]>newEvents);\n\t\t\t} else {\n\t\t\t\t// Collect for later\n\t\t\t\tthis._collectedEvents.push.apply(this._collectedEvents, newEvents);\n\t\t\t}\n\t\t});\n\t}\n\n\tpublic addEmitter2(eventEmitter:IEventEmitter, emitterType?:string):Lifecycle.IDisposable {\n\t\tvar dispose = this.addEmitter(eventEmitter, emitterType);\n\t\treturn {\n\t\t\tdispose: dispose\n\t\t};\n\t}\n\n\tpublic addEmitterTypeListener(eventType:string, emitterType:string, listener:ListenerCallback):ListenerUnbind {\n\t\tif (emitterType) {\n\t\t\tif (eventType === '*') {\n\t\t\t\tthrow new Error('Bulk listeners cannot specify an emitter type');\n\t\t\t}\n\n\t\t\treturn this.addListener(eventType + '/' + emitterType, listener);\n\t\t} else {\n\t\t\treturn this.addListener(eventType, listener);\n\t\t}\n\t}\n\n\tprivate _removeListener(eventType:string, listener:ListenerCallback): void {\n\t\tif (this._listeners.hasOwnProperty(eventType)) {\n\t\t\tvar listeners = this._listeners[eventType];\n\t\t\tfor (var i = 0, len = listeners.length; i < len; i++) {\n\t\t\t\tif (listeners[i] === listener) {\n\t\t\t\t\tlisteners.splice(i, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t}\n\n\tprivate _removeBulkListener(listener:IBulkListenerCallback): void {\n\t\tfor (var i = 0, len = this._bulkListeners.length; i < len; i++) {\n\t\t\tif (this._bulkListeners[i] === listener) {\n\t\t\t\tthis._bulkListeners.splice(i, 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _emitToSpecificTypeListeners(eventType:string, data:any): void {\n\t\tif (this._listeners.hasOwnProperty(eventType)) {\n\t\t\tvar listeners = this._listeners[eventType].slice(0);\n\t\t\tfor (var i = 0, len = listeners.length; i < len; i++) {\n\t\t\t\tsafeInvoke1Arg(listeners[i], data);\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _emitToBulkListeners(events:EmitterEvent[]): void {\n\t\tvar bulkListeners = this._bulkListeners.slice(0);\n\t\tfor (var i = 0, len = bulkListeners.length; i < len; i++) {\n\t\t\tsafeInvoke1Arg(bulkListeners[i], events);\n\t\t}\n\t}\n\n\tprotected _emitEvents(events:EmitterEvent[]): void {\n\t\tif (this._bulkListeners.length > 0) {\n\t\t\tthis._emitToBulkListeners(events);\n\t\t}\n\t\tfor (var i = 0, len = events.length; i < len; i++) {\n\t\t\tvar e = events[i];\n\n\t\t\tthis._emitToSpecificTypeListeners(e.getType(), e.getData());\n\t\t\tif (e.getEmitterType()) {\n\t\t\t\tthis._emitToSpecificTypeListeners(e.getType() + '/' + e.getEmitterType(), e.getData());\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic emit(eventType:string, data:any={}):void {\n\t\tif (this._allowedEventTypes && !this._allowedEventTypes.hasOwnProperty(eventType)) {\n\t\t\tthrow new Error('Cannot emit this event type because it wasn\\'t white-listed!');\n\t\t}\n\t\t// Early return if no listeners would get this\n\t\tif (!this._listeners.hasOwnProperty(eventType) && this._bulkListeners.length === 0) {\n\t\t\treturn;\n\t\t}\n\t\tvar emitterEvent = new EmitterEvent(eventType, data);\n\n\t\tif (this._deferredCnt === 0) {\n\t\t\tthis._emitEvents([emitterEvent]);\n\t\t} else {\n\t\t\t// Collect for later\n\t\t\tthis._collectedEvents.push(emitterEvent);\n\t\t}\n\t}\n\n\tpublic deferredEmit(callback:()=>any):any {\n\t\tthis._deferredCnt = this._deferredCnt + 1;\n\t\tvar result: any = safeInvokeNoArg(callback);\n\t\tthis._deferredCnt = this._deferredCnt - 1;\n\n\t\tif (this._deferredCnt === 0) {\n\t\t\tthis._emitCollected();\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate _emitCollected(): void {\n\t\t// Flush collected events\n\t\tvar events = this._collectedEvents;\n\t\tthis._collectedEvents = [];\n\n\t\tif (events.length > 0) {\n\t\t\tthis._emitEvents(events);\n\t\t}\n\t}\n}\n\nclass EmitQueueElement {\n\tpublic target: Function;\n\tpublic arg: any;\n\n\tconstructor(target: Function, arg: any) {\n\t\tthis.target = target;\n\t\tthis.arg = arg;\n\t}\n}\n\n/**\n * Same as EventEmitter, but guarantees events are delivered in order to each listener\n */\nexport class OrderGuaranteeEventEmitter extends EventEmitter {\n\n\tprivate _emitQueue: EmitQueueElement[];\n\n\tconstructor(allowedEventTypes:string[] = null) {\n\t\tsuper(allowedEventTypes);\n\t\tthis._emitQueue = [];\n\t}\n\n\tprotected _emitToSpecificTypeListeners(eventType:string, data:any): void {\n\t\tif (this._listeners.hasOwnProperty(eventType)) {\n\t\t\tlet listeners = this._listeners[eventType];\n\t\t\tfor (let i = 0, len = listeners.length; i < len; i++) {\n\t\t\t\tthis._emitQueue.push(new EmitQueueElement(listeners[i], data));\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _emitToBulkListeners(events:EmitterEvent[]): void {\n\t\tlet bulkListeners = this._bulkListeners;\n\t\tfor (let i = 0, len = bulkListeners.length; i < len; i++) {\n\t\t\tthis._emitQueue.push(new EmitQueueElement(bulkListeners[i], events));\n\t\t}\n\t}\n\n\tprotected _emitEvents(events:EmitterEvent[]): void {\n\t\tsuper._emitEvents(events);\n\n\t\twhile (this._emitQueue.length > 0) {\n\t\t\tlet queueElement = this._emitQueue.shift();\n\t\t\tsafeInvoke1Arg(queueElement.target, queueElement.arg);\n\t\t}\n\t}\n}\n\nfunction safeInvokeNoArg(func:Function): any {\n\ttry {\n\t\treturn func();\n\t} catch(e) {\n\t\tErrors.onUnexpectedError(e);\n\t}\n}\n\nfunction safeInvoke1Arg(func:Function, arg1:any): any {\n\ttry {\n\t\treturn func(arg1);\n\t} catch(e) {\n\t\tErrors.onUnexpectedError(e);\n\t}\n}\n"]}