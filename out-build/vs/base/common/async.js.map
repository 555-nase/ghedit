{"version":3,"file":"vs/base/common/async.js","sourceRoot":"file:///Users/darrin/src/vscode/src","sources":["vs/base/common/async.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\n\nimport * as errors from 'vs/base/common/errors';\nimport { Promise, TPromise, ValueCallback, ErrorCallback, ProgressCallback } from 'vs/base/common/winjs.base';\nimport * as platform from 'vs/base/common/platform';\nimport {CancellationToken, CancellationTokenSource} from 'vs/base/common/cancellation';\nimport {Disposable} from 'vs/base/common/lifecycle';\n\nfunction isThenable<T>(obj: any): obj is Thenable<T> {\n\treturn obj && typeof (<Thenable<any>>obj).then === 'function';\n}\n\nexport function asWinJsPromise<T>(callback: (token: CancellationToken) => T | Thenable<T>): TPromise<T> {\n\tlet source = new CancellationTokenSource();\n\treturn new TPromise<T>((resolve, reject) => {\n\t\tlet item = callback(source.token);\n\t\tif (isThenable<T>(item)) {\n\t\t\titem.then(resolve, reject);\n\t\t} else {\n\t\t\tresolve(item);\n\t\t}\n\t}, () => {\n\t\tsource.cancel();\n\t});\n}\n\nexport interface ITask<T> {\n\t(): T;\n}\n\n/**\n * A helper to prevent accumulation of sequential async tasks.\n *\n * Imagine a mail man with the sole task of delivering letters. As soon as\n * a letter submitted for delivery, he drives to the destination, delivers it\n * and returns to his base. Imagine that during the trip, N more letters were submitted.\n * When the mail man returns, he picks those N letters and delivers them all in a\n * single trip. Even though N+1 submissions occurred, only 2 deliveries were made.\n *\n * The throttler implements this via the queue() method, by providing it a task\n * factory. Following the example:\n *\n * \t\tvar throttler = new Throttler();\n * \t\tvar letters = [];\n *\n * \t\tfunction letterReceived(l) {\n * \t\t\tletters.push(l);\n * \t\t\tthrottler.queue(() => { return makeTheTrip(); });\n * \t\t}\n */\nexport class Throttler {\n\n\tprivate activePromise: Promise;\n\tprivate queuedPromise: Promise;\n\tprivate queuedPromiseFactory: ITask<Promise>;\n\n\tconstructor() {\n\t\tthis.activePromise = null;\n\t\tthis.queuedPromise = null;\n\t\tthis.queuedPromiseFactory = null;\n\t}\n\n\tpublic queue<T>(promiseFactory: ITask<TPromise<T>>): TPromise<T> {\n\t\tif (this.activePromise) {\n\t\t\tthis.queuedPromiseFactory = promiseFactory;\n\n\t\t\tif (!this.queuedPromise) {\n\t\t\t\tconst onComplete = () => {\n\t\t\t\t\tthis.queuedPromise = null;\n\n\t\t\t\t\tconst result = this.queue(this.queuedPromiseFactory);\n\t\t\t\t\tthis.queuedPromiseFactory = null;\n\n\t\t\t\t\treturn result;\n\t\t\t\t};\n\n\t\t\t\tthis.queuedPromise = new Promise((c, e, p) => {\n\t\t\t\t\tthis.activePromise.then(onComplete, onComplete, p).done(c);\n\t\t\t\t}, () => {\n\t\t\t\t\tthis.activePromise.cancel();\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn new Promise((c, e, p) => {\n\t\t\t\tthis.queuedPromise.then(c, e, p);\n\t\t\t}, () => {\n\t\t\t\t// no-op\n\t\t\t});\n\t\t}\n\n\t\tthis.activePromise = promiseFactory();\n\n\t\treturn new Promise((c, e, p) => {\n\t\t\tthis.activePromise.done((result: any) => {\n\t\t\t\tthis.activePromise = null;\n\t\t\t\tc(result);\n\t\t\t}, (err: any) => {\n\t\t\t\tthis.activePromise = null;\n\t\t\t\te(err);\n\t\t\t}, p);\n\t\t}, () => {\n\t\t\tthis.activePromise.cancel();\n\t\t});\n\t}\n}\n\n/**\n * A helper to delay execution of a task that is being requested often.\n *\n * Following the throttler, now imagine the mail man wants to optimize the number of\n * trips proactively. The trip itself can be long, so the he decides not to make the trip\n * as soon as a letter is submitted. Instead he waits a while, in case more\n * letters are submitted. After said waiting period, if no letters were submitted, he\n * decides to make the trip. Imagine that N more letters were submitted after the first\n * one, all within a short period of time between each other. Even though N+1\n * submissions occurred, only 1 delivery was made.\n *\n * The delayer offers this behavior via the trigger() method, into which both the task\n * to be executed and the waiting period (delay) must be passed in as arguments. Following\n * the example:\n *\n * \t\tvar delayer = new Delayer(WAITING_PERIOD);\n * \t\tvar letters = [];\n *\n * \t\tfunction letterReceived(l) {\n * \t\t\tletters.push(l);\n * \t\t\tdelayer.trigger(() => { return makeTheTrip(); });\n * \t\t}\n */\nexport class Delayer<T> {\n\n\tprivate timeout: number;\n\tprivate completionPromise: Promise;\n\tprivate onSuccess: ValueCallback;\n\tprivate task: ITask<T>;\n\n\tconstructor(public defaultDelay: number) {\n\t\tthis.timeout = null;\n\t\tthis.completionPromise = null;\n\t\tthis.onSuccess = null;\n\t\tthis.task = null;\n\t}\n\n\tpublic trigger(task: ITask<T>, delay: number = this.defaultDelay): TPromise<T> {\n\t\tthis.task = task;\n\t\tthis.cancelTimeout();\n\n\t\tif (!this.completionPromise) {\n\t\t\tthis.completionPromise = new Promise((c) => {\n\t\t\t\tthis.onSuccess = c;\n\t\t\t}, () => {\n\t\t\t\t// no-op\n\t\t\t}).then(() => {\n\t\t\t\tthis.completionPromise = null;\n\t\t\t\tthis.onSuccess = null;\n\t\t\t\tconst task = this.task;\n\t\t\t\tthis.task = null;\n\n\t\t\t\treturn task();\n\t\t\t});\n\t\t}\n\n\t\tthis.timeout = setTimeout(() => {\n\t\t\tthis.timeout = null;\n\t\t\tthis.onSuccess(null);\n\t\t}, delay);\n\n\t\treturn this.completionPromise;\n\t}\n\n\tpublic isTriggered(): boolean {\n\t\treturn this.timeout !== null;\n\t}\n\n\tpublic cancel(): void {\n\t\tthis.cancelTimeout();\n\n\t\tif (this.completionPromise) {\n\t\t\tthis.completionPromise.cancel();\n\t\t\tthis.completionPromise = null;\n\t\t}\n\t}\n\n\tprivate cancelTimeout(): void {\n\t\tif (this.timeout !== null) {\n\t\t\tclearTimeout(this.timeout);\n\t\t\tthis.timeout = null;\n\t\t}\n\t}\n}\n\n/**\n * A helper to delay execution of a task that is being requested often, while\n * preventing accumulation of consecutive executions, while the task runs.\n *\n * Simply combine the two mail man strategies from the Throttler and Delayer\n * helpers, for an analogy.\n */\nexport class ThrottledDelayer<T> extends Delayer<TPromise<T>> {\n\n\tprivate throttler: Throttler;\n\n\tconstructor(defaultDelay: number) {\n\t\tsuper(defaultDelay);\n\n\t\tthis.throttler = new Throttler();\n\t}\n\n\tpublic trigger(promiseFactory: ITask<TPromise<T>>, delay?: number): Promise {\n\t\treturn super.trigger(() => this.throttler.queue(promiseFactory), delay);\n\t}\n}\n\n/**\n * Similar to the ThrottledDelayer, except it also guarantees that the promise\n * factory doesn't get called more often than every `minimumPeriod` milliseconds.\n */\nexport class PeriodThrottledDelayer<T> extends ThrottledDelayer<T> {\n\n\tprivate minimumPeriod: number;\n\tprivate periodThrottler: Throttler;\n\n\tconstructor(defaultDelay: number, minimumPeriod: number = 0) {\n\t\tsuper(defaultDelay);\n\n\t\tthis.minimumPeriod = minimumPeriod;\n\t\tthis.periodThrottler = new Throttler();\n\t}\n\n\tpublic trigger(promiseFactory: ITask<TPromise<T>>, delay?: number): Promise {\n\t\treturn super.trigger(() => {\n\t\t\treturn this.periodThrottler.queue(() => {\n\t\t\t\treturn Promise.join([\n\t\t\t\t\tTPromise.timeout(this.minimumPeriod),\n\t\t\t\t\tpromiseFactory()\n\t\t\t\t]).then(r => r[1]);\n\t\t\t});\n\t\t}, delay);\n\t}\n}\n\nexport class PromiseSource<T> {\n\n\tprivate _value: TPromise<T>;\n\tprivate _completeCallback: Function;\n\tprivate _errorCallback: Function;\n\n\tconstructor() {\n\t\tthis._value = new TPromise<T>((c, e) => {\n\t\t\tthis._completeCallback = c;\n\t\t\tthis._errorCallback = e;\n\t\t});\n\t}\n\n\tget value(): TPromise<T> {\n\t\treturn this._value;\n\t}\n\n\tcomplete(value?: T): void {\n\t\tthis._completeCallback(value);\n\t}\n\n\terror(err?: any): void {\n\t\tthis._errorCallback(err);\n\t}\n}\n\nexport class ShallowCancelThenPromise<T> extends TPromise<T> {\n\n\tconstructor(outer: TPromise<T>) {\n\n\t\tlet completeCallback: ValueCallback,\n\t\t\terrorCallback: ErrorCallback,\n\t\t\tprogressCallback: ProgressCallback;\n\n\t\tsuper((c, e, p) => {\n\t\t\tcompleteCallback = c;\n\t\t\terrorCallback = e;\n\t\t\tprogressCallback = p;\n\t\t}, () => {\n\t\t\t// cancel this promise but not the\n\t\t\t// outer promise\n\t\t\terrorCallback(errors.canceled());\n\t\t});\n\n\t\touter.then(completeCallback, errorCallback, progressCallback);\n\t}\n}\n\n/**\n * Returns a new promise that joins the provided promise. Upon completion of\n * the provided promise the provided function will always be called. This\n * method is comparable to a try-finally code block.\n * @param promise a promise\n * @param f a function that will be call in the success and error case.\n */\nexport function always<T>(promise: TPromise<T>, f: Function): TPromise<T> {\n\treturn new TPromise<T>((c, e, p) => {\n\t\tpromise.done((result) => {\n\t\t\ttry {\n\t\t\t\tf(result);\n\t\t\t} catch (e1) {\n\t\t\t\terrors.onUnexpectedError(e1);\n\t\t\t}\n\t\t\tc(result);\n\t\t}, (err) => {\n\t\t\ttry {\n\t\t\t\tf(err);\n\t\t\t} catch (e1) {\n\t\t\t\terrors.onUnexpectedError(e1);\n\t\t\t}\n\t\t\te(err);\n\t\t}, (progress) => {\n\t\t\tp(progress);\n\t\t});\n\t}, () => {\n\t\tpromise.cancel();\n\t});\n}\n\n/**\n * Runs the provided list of promise factories in sequential order. The returned\n * promise will complete to an array of results from each promise.\n */\nexport function sequence<T>(promiseFactory: ITask<TPromise<T>>[]): TPromise<T[]> {\n\tconst results: T[] = [];\n\n\t// reverse since we start with last element using pop()\n\tpromiseFactory = promiseFactory.reverse();\n\n\tfunction next(): Promise {\n\t\tif (promiseFactory.length) {\n\t\t\treturn promiseFactory.pop()();\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfunction thenHandler(result: any): Promise {\n\t\tif (result) {\n\t\t\tresults.push(result);\n\t\t}\n\n\t\tconst n = next();\n\t\tif (n) {\n\t\t\treturn n.then(thenHandler);\n\t\t}\n\n\t\treturn TPromise.as(results);\n\t}\n\n\treturn TPromise.as(null).then(thenHandler);\n}\n\nexport interface IFunction<A, R> {\n\t(...args: A[]): R;\n}\n\nexport function once<A, R>(fn: IFunction<A, R>): IFunction<A, R> {\n\tconst _this = this;\n\tlet didCall = false;\n\tlet result: R;\n\n\treturn function() {\n\t\tif (didCall) {\n\t\t\treturn result;\n\t\t}\n\n\t\tdidCall = true;\n\t\tresult = fn.apply(_this, arguments);\n\n\t\treturn result;\n\t};\n}\n\ninterface ILimitedTaskFactory {\n\tfactory: ITask<Promise>;\n\tc: ValueCallback;\n\te: ErrorCallback;\n\tp: ProgressCallback;\n}\n\n/**\n * A helper to queue N promises and run them all with a max degree of parallelism. The helper\n * ensures that at any time no more than M promises are running at the same time.\n */\nexport class Limiter<T> {\n\tprivate runningPromises: number;\n\tprivate maxDegreeOfParalellism: number;\n\tprivate outstandingPromises: ILimitedTaskFactory[];\n\n\tconstructor(maxDegreeOfParalellism: number) {\n\t\tthis.maxDegreeOfParalellism = maxDegreeOfParalellism;\n\t\tthis.outstandingPromises = [];\n\t\tthis.runningPromises = 0;\n\t}\n\n\tpublic queue(promiseFactory: ITask<Promise>): Promise;\n\tpublic queue(promiseFactory: ITask<TPromise<T>>): TPromise<T> {\n\t\treturn new TPromise<T>((c, e, p) => {\n\t\t\tthis.outstandingPromises.push({\n\t\t\t\tfactory: promiseFactory,\n\t\t\t\tc: c,\n\t\t\t\te: e,\n\t\t\t\tp: p\n\t\t\t});\n\n\t\t\tthis.consume();\n\t\t});\n\t}\n\n\tprivate consume(): void {\n\t\twhile (this.outstandingPromises.length && this.runningPromises < this.maxDegreeOfParalellism) {\n\t\t\tconst iLimitedTask = this.outstandingPromises.shift();\n\t\t\tthis.runningPromises++;\n\n\t\t\tconst promise = iLimitedTask.factory();\n\t\t\tpromise.done(iLimitedTask.c, iLimitedTask.e, iLimitedTask.p);\n\t\t\tpromise.done(() => this.consumed(), () => this.consumed());\n\t\t}\n\t}\n\n\tprivate consumed(): void {\n\t\tthis.runningPromises--;\n\t\tthis.consume();\n\t}\n}\n\nexport class TimeoutTimer extends Disposable {\n\tprivate _token: platform.TimeoutToken;\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis._token = -1;\n\t}\n\n\tpublic dispose(): void {\n\t\tthis.cancel();\n\t\tsuper.dispose();\n\t}\n\n\tpublic cancel(): void {\n\t\tif (this._token !== -1) {\n\t\t\tplatform.clearTimeout(this._token);\n\t\t\tthis._token = -1;\n\t\t}\n\t}\n\n\tpublic cancelAndSet(runner: () => void, timeout:number): void {\n\t\tthis.cancel();\n\t\tthis._token = platform.setTimeout(() => {\n\t\t\tthis._token = -1;\n\t\t\trunner();\n\t\t}, timeout);\n\t}\n\n\tpublic setIfNotSet(runner: () => void, timeout: number): void {\n\t\tif (this._token !== -1) {\n\t\t\t// timer is already set\n\t\t\treturn;\n\t\t}\n\t\tthis._token = platform.setTimeout(() => {\n\t\t\tthis._token = -1;\n\t\t\trunner();\n\t\t}, timeout);\n\t}\n}\n\nexport class IntervalTimer extends Disposable {\n\n\tprivate _token: platform.IntervalToken;\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis._token = -1;\n\t}\n\n\tpublic dispose(): void {\n\t\tthis.cancel();\n\t\tsuper.dispose();\n\t}\n\n\tpublic cancel(): void {\n\t\tif (this._token !== -1) {\n\t\t\tplatform.clearInterval(this._token);\n\t\t\tthis._token = -1;\n\t\t}\n\t}\n\n\tpublic cancelAndSet(runner: () => void, interval:number): void {\n\t\tthis.cancel();\n\t\tthis._token = platform.setInterval(() => {\n\t\t\trunner();\n\t\t}, interval);\n\t}\n}\n\nexport class RunOnceScheduler {\n\n\tprivate timeoutToken: platform.TimeoutToken;\n\tprivate runner: () => void;\n\tprivate timeout: number;\n\tprivate timeoutHandler: () => void;\n\n\tconstructor(runner: () => void, timeout: number) {\n\t\tthis.timeoutToken = -1;\n\t\tthis.runner = runner;\n\t\tthis.timeout = timeout;\n\t\tthis.timeoutHandler = this.onTimeout.bind(this);\n\t}\n\n\t/**\n\t * Dispose RunOnceScheduler\n\t */\n\tpublic dispose(): void {\n\t\tthis.cancel();\n\t\tthis.runner = null;\n\t}\n\n\t/**\n\t * Cancel current scheduled runner (if any).\n\t */\n\tpublic cancel(): void {\n\t\tif (this.isScheduled()) {\n\t\t\tplatform.clearTimeout(this.timeoutToken);\n\t\t\tthis.timeoutToken = -1;\n\t\t}\n\t}\n\n\t/**\n\t * Replace runner. If there is a runner already scheduled, the new runner will be called.\n\t */\n\tpublic setRunner(runner: () => void): void {\n\t\tthis.runner = runner;\n\t}\n\n\t/**\n\t * Set timeout. This change will only impact new schedule calls.\n\t */\n\tpublic setTimeout(timeout: number): void {\n\t\tthis.timeout = timeout;\n\t}\n\n\t/**\n\t * Cancel previous runner (if any) & schedule a new runner.\n\t */\n\tpublic schedule(): void {\n\t\tthis.cancel();\n\t\tthis.timeoutToken = platform.setTimeout(this.timeoutHandler, this.timeout);\n\t}\n\n\t/**\n\t * Returns true if scheduled.\n\t */\n\tpublic isScheduled(): boolean {\n\t\treturn this.timeoutToken !== -1;\n\t}\n\n\tprivate onTimeout() {\n\t\tthis.timeoutToken = -1;\n\t\tif (this.runner) {\n\t\t\tthis.runner();\n\t\t}\n\t}\n}\n\nexport function nfcall(fn: Function, ...args: any[]): Promise;\nexport function nfcall<T>(fn: Function, ...args: any[]): TPromise<T>;\nexport function nfcall(fn: Function, ...args: any[]): any {\n\treturn new Promise((c, e) => fn(...args, (err, result) => err ? e(err) : c(result)));\n}\n\nexport function ninvoke(thisArg: any, fn: Function, ...args: any[]): Promise;\nexport function ninvoke<T>(thisArg: any, fn: Function, ...args: any[]): TPromise<T>;\nexport function ninvoke(thisArg: any, fn: Function, ...args: any[]): any {\n\treturn new Promise((c, e) => fn.call(thisArg, ...args, (err, result) => err ? e(err) : c(result)));\n}\n"]}