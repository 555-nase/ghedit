{"version":3,"sources":["vs/workbench/parts/files/browser/views/workingFilesView.ts"],"names":[],"mappings":"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","file":"vs/workbench/parts/files/browser/views/workingFilesView.js","sourceRoot":"file:///Users/darrin/src/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\n\nimport nls = require('vs/nls');\nimport {TPromise} from 'vs/base/common/winjs.base';\nimport {Builder, $} from 'vs/base/browser/builder';\nimport {ITree} from 'vs/base/parts/tree/browser/tree';\nimport {Tree} from 'vs/base/parts/tree/browser/treeImpl';\nimport {IAction, IActionRunner} from 'vs/base/common/actions';\nimport workbenchEditorCommon = require('vs/workbench/common/editor');\nimport {CollapsibleState} from 'vs/base/browser/ui/splitview/splitview';\nimport {IWorkingFileEntry, IWorkingFilesModel, IWorkingFileModelChangeEvent, LocalFileChangeEvent, EventType as FileEventType, IFilesConfiguration, ITextFileService, AutoSaveMode} from 'vs/workbench/parts/files/common/files';\nimport * as DOM from 'vs/base/browser/dom';\nimport {IDisposable} from 'vs/base/common/lifecycle';\nimport errors = require('vs/base/common/errors');\nimport {EventType as WorkbenchEventType, UntitledEditorEvent, EditorEvent} from 'vs/workbench/common/events';\nimport {AdaptiveCollapsibleViewletView} from 'vs/workbench/browser/viewlet';\nimport {CloseAllWorkingFilesAction, SaveAllAction} from 'vs/workbench/parts/files/browser/fileActions';\nimport {WorkingFileEntry} from 'vs/workbench/parts/files/common/workingFilesModel';\nimport {WorkingFilesDragAndDrop, WorkingFilesSorter, WorkingFilesController, WorkingFilesDataSource, WorkingFilesRenderer, WorkingFilesAccessibilityProvider, WorkingFilesActionProvider} from 'vs/workbench/parts/files/browser/views/workingFilesViewer';\nimport {IWorkbenchEditorService} from 'vs/workbench/services/editor/common/editorService';\nimport {IConfigurationService, IConfigurationServiceEvent, ConfigurationServiceEventTypes} from 'vs/platform/configuration/common/configuration';\nimport {IEditorInput} from 'vs/platform/editor/common/editor';\nimport {IEventService} from 'vs/platform/event/common/event';\nimport {IInstantiationService} from 'vs/platform/instantiation/common/instantiation';\nimport {IContextMenuService} from 'vs/platform/contextview/browser/contextView';\nimport {IMessageService} from 'vs/platform/message/common/message';\n\nexport class WorkingFilesView extends AdaptiveCollapsibleViewletView {\n\n\tprivate static MEMENTO_COLLAPSED = 'workingFiles.memento.collapsed';\n\n\tprivate static DEFAULT_MAX_VISIBLE_FILES = 9;\n\tprivate static DEFAULT_DYNAMIC_HEIGHT = true;\n\n\tprivate settings: any;\n\tprivate maxVisibleWorkingFiles: number;\n\tprivate dynamicHeight: boolean;\n\n\tprivate model: IWorkingFilesModel;\n\tprivate dirtyCountElement: HTMLElement;\n\tprivate lastDirtyCount: number;\n\n\tprivate disposeables: IDisposable[];\n\n\tconstructor(actionRunner: IActionRunner, settings: any,\n\t\t@IEventService private eventService: IEventService,\n\t\t@IInstantiationService private instantiationService: IInstantiationService,\n\t\t@IMessageService messageService: IMessageService,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@ITextFileService private textFileService: ITextFileService,\n\t\t@IWorkbenchEditorService private editorService: IWorkbenchEditorService,\n\t\t@IConfigurationService private configurationService: IConfigurationService\n\t) {\n\t\tsuper(actionRunner, WorkingFilesView.computeExpandedBodySize(textFileService.getWorkingFilesModel()), !!settings[WorkingFilesView.MEMENTO_COLLAPSED], nls.localize('workingFilesSection', \"Working Files Section\"), messageService, contextMenuService);\n\n\t\tthis.settings = settings;\n\t\tthis.model = this.textFileService.getWorkingFilesModel();\n\t\tthis.lastDirtyCount = 0;\n\t\tthis.disposeables = [];\n\t}\n\n\tpublic renderHeader(container: HTMLElement): void {\n\t\tlet titleDiv = $('div.title').appendTo(container);\n\t\t$('span').text(nls.localize('workingFiles', \"Working Files\")).appendTo(titleDiv);\n\n\t\tthis.dirtyCountElement = $('div.monaco-count-badge').appendTo(titleDiv).hide().getHTMLElement();\n\t\tthis.updateDirtyIndicator();\n\n\t\tsuper.renderHeader(container);\n\t}\n\n\tpublic getActions(): IAction[] {\n\t\treturn [\n\t\t\tthis.instantiationService.createInstance(SaveAllAction, SaveAllAction.ID, SaveAllAction.LABEL),\n\t\t\tthis.instantiationService.createInstance(CloseAllWorkingFilesAction, this.model)\n\t\t];\n\t}\n\n\tpublic renderBody(container: HTMLElement): void {\n\t\tthis.treeContainer = super.renderViewTree(container);\n\t\tDOM.addClass(this.treeContainer, 'explorer-working-files');\n\n\t\tthis.createViewer($(this.treeContainer));\n\t}\n\n\tpublic create(): TPromise<void> {\n\n\t\t// Load Config\n\t\tconst configuration = this.configurationService.getConfiguration<IFilesConfiguration>();\n\t\tthis.onConfigurationUpdated(configuration);\n\n\t\t// listeners\n\t\tthis.registerListeners();\n\n\t\t// highlight active input\n\t\tthis.highlightInput(this.editorService.getActiveEditorInput());\n\n\t\treturn super.create();\n\t}\n\n\tprivate onConfigurationUpdated(configuration: IFilesConfiguration): void {\n\t\tlet visibleWorkingFiles = configuration && configuration.explorer && configuration.explorer.workingFiles && configuration.explorer.workingFiles.maxVisible;\n\t\tif (typeof visibleWorkingFiles === 'number') {\n\t\t\tthis.maxVisibleWorkingFiles = visibleWorkingFiles;\n\t\t} else {\n\t\t\tthis.maxVisibleWorkingFiles = WorkingFilesView.DEFAULT_MAX_VISIBLE_FILES;\n\t\t}\n\n\t\tlet dynamicHeight = configuration && configuration.explorer && configuration.explorer.workingFiles && configuration.explorer.workingFiles.dynamicHeight;\n\t\tif (typeof dynamicHeight === 'boolean') {\n\t\t\tthis.dynamicHeight = dynamicHeight;\n\t\t} else {\n\t\t\tthis.dynamicHeight = WorkingFilesView.DEFAULT_DYNAMIC_HEIGHT;\n\t\t}\n\n\t\t// Adjust expanded body size\n\t\tthis.expandedBodySize = this.getExpandedBodySize(this.model);\n\t}\n\n\tprivate registerListeners(): void {\n\n\t\t// update on model changes\n\t\tthis.disposeables.push(this.model.onModelChange(this.onWorkingFilesModelChange, this));\n\t\tthis.disposeables.push(this.model.onWorkingFileChange(this.onWorkingFileChange, this));\n\n\t\t// listen to untitled\n\t\tthis.toDispose.push(this.eventService.addListener2(WorkbenchEventType.UNTITLED_FILE_DIRTY, (e: UntitledEditorEvent) => this.onUntitledFileDirty()));\n\t\tthis.toDispose.push(this.eventService.addListener2(WorkbenchEventType.UNTITLED_FILE_DELETED, (e: UntitledEditorEvent) => this.onUntitledFileDeleted()));\n\n\t\t// listen to files being changed locally\n\t\tthis.toDispose.push(this.eventService.addListener2(FileEventType.FILE_DIRTY, (e: LocalFileChangeEvent) => this.onTextFileDirty(e)));\n\t\tthis.toDispose.push(this.eventService.addListener2(FileEventType.FILE_SAVED, (e: LocalFileChangeEvent) => this.onTextFileSaved(e)));\n\t\tthis.toDispose.push(this.eventService.addListener2(FileEventType.FILE_SAVE_ERROR, (e: LocalFileChangeEvent) => this.onTextFileSaveError(e)));\n\t\tthis.toDispose.push(this.eventService.addListener2(FileEventType.FILE_REVERTED, (e: LocalFileChangeEvent) => this.onTextFileReverted(e)));\n\n\t\t// listen to files being opened\n\t\tthis.toDispose.push(this.eventService.addListener2(WorkbenchEventType.EDITOR_INPUT_CHANGED, (e: EditorEvent) => this.onEditorInputChanged(e)));\n\n\t\t// Also handle configuration updates\n\t\tthis.toDispose.push(this.configurationService.addListener2(ConfigurationServiceEventTypes.UPDATED, (e: IConfigurationServiceEvent) => this.onConfigurationUpdated(e.config)));\n\t}\n\n\tprivate onTextFileDirty(e: LocalFileChangeEvent): void {\n\t\tif (this.textFileService.getAutoSaveMode() !== AutoSaveMode.AFTER_SHORT_DELAY) {\n\t\t\tthis.updateDirtyIndicator(); // no indication needed when auto save is enabled for short delay\n\t\t}\n\t}\n\n\tprivate onTextFileSaved(e: LocalFileChangeEvent): void {\n\t\tif (this.lastDirtyCount > 0) {\n\t\t\tthis.updateDirtyIndicator();\n\t\t}\n\t}\n\n\tprivate onTextFileSaveError(e: LocalFileChangeEvent): void {\n\t\tthis.updateDirtyIndicator();\n\t}\n\n\tprivate onTextFileReverted(e: LocalFileChangeEvent): void {\n\t\tif (this.lastDirtyCount > 0) {\n\t\t\tthis.updateDirtyIndicator();\n\t\t}\n\t}\n\n\tprivate onUntitledFileDirty(): void {\n\t\tthis.updateDirtyIndicator();\n\t}\n\n\tprivate onUntitledFileDeleted(): void {\n\t\tif (this.lastDirtyCount > 0) {\n\t\t\tthis.updateDirtyIndicator();\n\t\t}\n\t}\n\n\tprivate updateDirtyIndicator(): void {\n\t\tlet dirty = this.textFileService.getDirty().length;\n\t\tthis.lastDirtyCount = dirty;\n\t\tif (dirty === 0) {\n\t\t\t$(this.dirtyCountElement).hide();\n\t\t} else {\n\t\t\tconst label = nls.localize('dirtyCounter', \"{0} unsaved\", dirty);\n\t\t\t$(this.dirtyCountElement).show().text(label).title(label);\n\t\t}\n\t}\n\n\tprivate onWorkingFilesModelChange(event: IWorkingFileModelChangeEvent): void {\n\t\tif (this.isDisposed) {\n\t\t\treturn;\n\t\t}\n\n\t\t// View size\n\t\tthis.expandedBodySize = this.getExpandedBodySize(this.model);\n\n\t\tif (this.tree) {\n\n\t\t\t// Show in tree\n\t\t\tthis.tree.refresh();\n\n\t\t\t// Make sure to keep active editor input highlighted\n\t\t\tlet activeInput = this.editorService.getActiveEditorInput();\n\t\t\tthis.highlightInput(activeInput);\n\t\t}\n\t}\n\n\tprivate onWorkingFileChange(file: WorkingFileEntry): void {\n\t\tif (this.isDisposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.tree) {\n\t\t\tthis.tree.refresh(file);\n\t\t}\n\t}\n\n\tprivate getExpandedBodySize(model: IWorkingFilesModel): number {\n\t\treturn WorkingFilesView.computeExpandedBodySize(model, this.maxVisibleWorkingFiles, this.dynamicHeight);\n\t}\n\n\tprivate static computeExpandedBodySize(model: IWorkingFilesModel, maxVisibleWorkingFiles?: number, hasDynamicHeight?: boolean): number {\n\t\tlet entryCount = model.count();\n\n\t\tlet visibleWorkingFiles = maxVisibleWorkingFiles;\n\t\tif (typeof visibleWorkingFiles !== 'number') {\n\t\t\tvisibleWorkingFiles = WorkingFilesView.DEFAULT_MAX_VISIBLE_FILES;\n\t\t}\n\n\t\tlet dynamicHeight = hasDynamicHeight;\n\t\tif (typeof dynamicHeight !== 'boolean') {\n\t\t\tdynamicHeight = WorkingFilesView.DEFAULT_DYNAMIC_HEIGHT;\n\t\t}\n\n\t\tlet itemsToShow: number;\n\t\tif (dynamicHeight) {\n\t\t\titemsToShow = Math.min(Math.max(visibleWorkingFiles, 1), entryCount);\n\t\t} else {\n\t\t\titemsToShow = Math.max(visibleWorkingFiles, 1);\n\t\t}\n\n\t\treturn itemsToShow * WorkingFilesRenderer.FILE_ITEM_HEIGHT;\n\t}\n\n\tprivate onEditorInputChanged(e: EditorEvent): void {\n\t\tlet activeInput = this.editorService.getActiveEditorInput();\n\t\tif (activeInput === e.editorInput) {\n\t\t\tthis.highlightInput(e.editorInput);\n\t\t}\n\t}\n\n\tprivate highlightInput(input: IEditorInput): void {\n\t\tlet entry: IWorkingFileEntry;\n\n\t\tlet resource = workbenchEditorCommon.getUntitledOrFileResource(input);\n\t\tif (resource) {\n\t\t\tentry = this.model.findEntry(resource);\n\t\t}\n\n\t\tif (entry) {\n\t\t\tthis.highlightEntry(entry);\n\t\t} else {\n\t\t\tthis.highlightEntry(null);\n\t\t}\n\t}\n\n\tprivate highlightEntry(entry: IWorkingFileEntry): void {\n\t\tthis.tree.clearFocus();\n\t\tthis.tree.clearSelection();\n\n\t\tif (entry) {\n\t\t\tthis.tree.setFocus(entry);\n\t\t\tthis.tree.setSelection([entry]);\n\t\t\tthis.tree.reveal(entry).done(null, errors.onUnexpectedError);\n\t\t}\n\t}\n\n\tprivate createViewer(container: Builder): ITree {\n\t\tlet actionProvider = this.instantiationService.createInstance(WorkingFilesActionProvider, this.model);\n\t\tlet renderer = this.instantiationService.createInstance(WorkingFilesRenderer, this.model, actionProvider, this.actionRunner);\n\t\tlet dataSource = this.instantiationService.createInstance(WorkingFilesDataSource);\n\t\tlet controller = this.instantiationService.createInstance(WorkingFilesController, this.model, actionProvider);\n\t\tlet sorter = this.instantiationService.createInstance(WorkingFilesSorter);\n\t\tlet dnd = this.instantiationService.createInstance(WorkingFilesDragAndDrop, this.model);\n\t\tlet accessibility = this.instantiationService.createInstance(WorkingFilesAccessibilityProvider);\n\n\t\tthis.tree = new Tree(container.getHTMLElement(), {\n\t\t\tdataSource: dataSource,\n\t\t\trenderer: renderer,\n\t\t\tsorter: sorter,\n\t\t\tcontroller: controller,\n\t\t\tdnd: dnd,\n\t\t\taccessibilityProvider: accessibility\n\t\t}, {\n\t\t\t\tindentPixels: 0,\n\t\t\t\ttwistiePixels: 8,\n\t\t\t\tariaLabel: nls.localize('treeAriaLabel', \"Working Files\")\n\t\t\t});\n\n\t\tthis.tree.setInput(this.model);\n\n\t\treturn this.tree;\n\t}\n\n\tpublic getOptimalWidth():number {\n\t\tlet parentNode = this.tree.getHTMLElement();\n\t\tlet childNodes = [].slice.call(parentNode.querySelectorAll('.monaco-file-label > .file-name'));\n\t\treturn DOM.getLargestChildWidth(parentNode, childNodes);\n\t}\n\n\tpublic shutdown(): void {\n\t\tthis.settings[WorkingFilesView.MEMENTO_COLLAPSED] = (this.state === CollapsibleState.COLLAPSED);\n\n\t\tsuper.shutdown();\n\t}\n\n\tpublic dispose(): void {\n\t\tsuper.dispose();\n\n\t\twhile (this.disposeables.length) {\n\t\t\tthis.disposeables.pop().dispose();\n\t\t}\n\t}\n}"]}