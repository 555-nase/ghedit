{"version":3,"sources":["vs/workbench/parts/git/electron-main/askpassService.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;IAsBhG;QAIC;YAJD,iBAgDC;YA9CQ,iBAAY,GAA+B,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;YAGtE,kBAAG,CAAC,EAAE,CAAC,aAAa,EAAE,UAAC,KAAK,EAAE,MAA0B;gBACvD,KAAI,CAAC,YAAY,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,WAAW,GAAG,MAAM,CAAC,WAAW,CAAC;YAC/D,CAAC,CAAC,CAAC;QACJ,CAAC;QAEM,mCAAO,GAAd,UAAe,EAAU,EAAE,IAAY,EAAE,OAAe;YAAxD,iBAqCC;YApCA,MAAM,CAAC,IAAI,qBAAQ,CAAe,UAAC,CAAC,EAAE,CAAC;gBACtC,IAAI,YAAY,GAAG,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;gBAEzC,EAAE,CAAC,CAAC,OAAO,YAAY,KAAK,WAAW,CAAC,CAAC,CAAC;oBACzC,MAAM,CAAC,CAAC,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;gBACpC,CAAC;gBAED,EAAE,CAAC,CAAC,OAAO,KAAK,OAAO,CAAC,CAAC,CAAC;oBACzB,MAAM,CAAC,CAAC,CAAC,EAAE,QAAQ,EAAE,EAAE,EAAE,QAAQ,EAAE,EAAE,EAAE,CAAC,CAAC;gBAC1C,CAAC;gBAED,IAAI,GAAG,GAAG,IAAI,wBAAa,CAAC;oBAC3B,WAAW,EAAE,IAAI;oBACjB,WAAW,EAAE,IAAI;oBACjB,SAAS,EAAE,KAAK;oBAChB,KAAK,EAAE,GAAG;oBACV,MAAM,EAAE,QAAQ,CAAC,SAAS,GAAG,GAAG,GAAG,GAAG;oBACtC,IAAI,EAAE,IAAI;oBACV,KAAK,EAAE,GAAG,CAAC,QAAQ,CAAC,CAAK,EAAE,IAAK,CAAC;iBACjC,CAAC,CAAC;gBAEH,GAAG,CAAC,oBAAoB,CAAC,KAAK,CAAC,CAAC;gBAEhC,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,GAAG;oBACvB,MAAM,EAAE,GAAG;oBACX,WAAW,EAAE,IAAI;iBACjB,CAAC;gBAEF,GAAG,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,iDAAiD,CAAC,CAAC,CAAC;gBAC9E,GAAG,CAAC,WAAW,CAAC,iBAAiB,CAAC,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,EAAE,IAAA,EAAE,EAAE,MAAA,IAAI,EAAE,SAAA,OAAO,EAAE,CAAC,GAAG,GAAG,CAAC,CAAC;gBAEzF,GAAG,CAAC,IAAI,CAAC,QAAQ,EAAE;oBAClB,CAAC,CAAC,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC,WAAW,CAAC,CAAC;oBACrC,UAAU,CAAC,cAAM,OAAA,OAAO,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAA5B,CAA4B,EAAE,IAAI,GAAG,EAAE,CAAC,CAAC;gBAC3D,CAAC,CAAC,CAAC;YACJ,CAAC,CAAC,CAAC;QACJ,CAAC;QACF,wBAAC;IAAD,CAhDA,AAgDC,IAAA;IAhDY,yBAAiB,oBAgD7B,CAAA","file":"vs/workbench/parts/git/electron-main/askpassService.js","sourceRoot":"file:///Users/darrin/src/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from 'vs/nls';\nimport { ipcMain as ipc, BrowserWindow} from 'electron';\nimport platform = require('vs/base/common/platform');\nimport { TPromise } from 'vs/base/common/winjs.base';\n\nexport interface ICredentials {\n\tusername: string;\n\tpassword: string;\n}\n\ninterface ICredentialsResult {\n\tid: number;\n\tcredentials: ICredentials;\n}\n\ninterface IContext {\n\tcredentials: ICredentials;\n\twindow: Electron.BrowserWindow;\n}\n\nexport class GitAskpassService {\n\n\tprivate askpassCache: { [id: string]: IContext } = Object.create(null);\n\n\tconstructor() {\n\t\tipc.on('git:askpass', (event, result: ICredentialsResult) => {\n\t\t\tthis.askpassCache[result.id].credentials = result.credentials;\n\t\t});\n\t}\n\n\tpublic askpass(id: string, host: string, command: string): TPromise<ICredentials> {\n\t\treturn new TPromise<ICredentials>((c, e) => {\n\t\t\tlet cachedResult = this.askpassCache[id];\n\n\t\t\tif (typeof cachedResult !== 'undefined') {\n\t\t\t\treturn c(cachedResult.credentials);\n\t\t\t}\n\n\t\t\tif (command === 'fetch') {\n\t\t\t\treturn c({ username: '', password: '' });\n\t\t\t}\n\n\t\t\tlet win = new BrowserWindow({\n\t\t\t\talwaysOnTop: true,\n\t\t\t\tskipTaskbar: true,\n\t\t\t\tresizable: false,\n\t\t\t\twidth: 450,\n\t\t\t\theight: platform.isWindows ? 280 : 260,\n\t\t\t\tshow: true,\n\t\t\t\ttitle: nls.localize('git', \"Git\")\n\t\t\t});\n\n\t\t\twin.setMenuBarVisibility(false);\n\n\t\t\tthis.askpassCache[id] = {\n\t\t\t\twindow: win,\n\t\t\t\tcredentials: null\n\t\t\t};\n\n\t\t\twin.loadURL(require.toUrl('vs/workbench/parts/git/electron-main/index.html'));\n\t\t\twin.webContents.executeJavaScript('init(' + JSON.stringify({ id, host, command }) + ')');\n\n\t\t\twin.once('closed', () => {\n\t\t\t\tc(this.askpassCache[id].credentials);\n\t\t\t\tsetTimeout(() => delete this.askpassCache[id], 1000 * 10);\n\t\t\t});\n\t\t});\n\t}\n}"]}