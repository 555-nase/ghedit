{"version":3,"file":"vs/workbench/common/storage.js","sourceRoot":"file:///Users/darrin/src/vscode/src","sources":["vs/workbench/common/storage.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\n\nimport {EventEmitter} from 'vs/base/common/eventEmitter';\nimport types = require('vs/base/common/types');\nimport errors = require('vs/base/common/errors');\nimport strings = require('vs/base/common/strings');\nimport {IStorageService, StorageScope, StorageEvent, StorageEventType} from 'vs/platform/storage/common/storage';\nimport {IWorkspaceContextService, IWorkspace} from 'vs/platform/workspace/common/workspace';\n\n// Browser localStorage interface\nexport interface IStorage {\n\tlength: number;\n\tkey(index: number): string;\n\tclear(): void;\n\tsetItem(key: string, value: any): void;\n\tgetItem(key: string): string;\n\tremoveItem(key: string): void;\n}\n\nexport class Storage extends EventEmitter implements IStorageService {\n\n\tpublic serviceId = IStorageService;\n\n\tprivate static COMMON_PREFIX = 'storage://';\n\tprivate static GLOBAL_PREFIX = Storage.COMMON_PREFIX + 'global/';\n\tprivate static WORKSPACE_PREFIX = Storage.COMMON_PREFIX + 'workspace/';\n\tprivate static WORKSPACE_IDENTIFIER = 'workspaceIdentifier';\n\tprivate static NO_WORKSPACE_IDENTIFIER = '__$noWorkspace__';\n\n\tprivate workspaceStorage: IStorage;\n\tprivate globalStorage: IStorage;\n\n\tprivate toUnbind: { (): void; }[];\n\tprivate workspaceKey: string;\n\n\tconstructor(contextService: IWorkspaceContextService, globalStorage: IStorage, workspaceStorage = globalStorage) {\n\t\tsuper();\n\n\t\tlet workspace = contextService.getWorkspace();\n\n\t\tthis.globalStorage = globalStorage;\n\t\tthis.workspaceStorage = workspaceStorage;\n\n\t\tthis.toUnbind = [];\n\n\t\t// Calculate workspace storage key\n\t\tthis.workspaceKey = this.getWorkspaceKey(workspace);\n\n\t\t// Make sure to delete all workspace storage if the workspace has been recreated meanwhile\n\t\tlet workspaceUniqueId: number = workspace ? workspace.uid : null;\n\t\tif (types.isNumber(workspaceUniqueId)) {\n\t\t\tthis.cleanupWorkspaceScope(workspaceUniqueId, workspace.name);\n\t\t}\n\t}\n\n\tprivate getWorkspaceKey(workspace?: IWorkspace): string {\n\t\tlet workspaceUri: string = null;\n\t\tif (workspace && workspace.resource) {\n\t\t\tworkspaceUri = workspace.resource.toString();\n\t\t}\n\n\t\treturn workspaceUri ? this.calculateWorkspaceKey(workspaceUri) : Storage.NO_WORKSPACE_IDENTIFIER;\n\t}\n\n\tprivate calculateWorkspaceKey(workspaceUrl: string): string {\n\t\tlet root = 'file:///';\n\t\tlet index = workspaceUrl.indexOf(root);\n\t\tif (index === 0) {\n\t\t\treturn strings.rtrim(workspaceUrl.substr(root.length), '/') + '/';\n\t\t}\n\n\t\treturn workspaceUrl;\n\t}\n\n\tprivate cleanupWorkspaceScope(workspaceId: number, workspaceName: string): void {\n\n\t\t// Get stored identifier from storage\n\t\tlet id = this.getInteger(Storage.WORKSPACE_IDENTIFIER, StorageScope.WORKSPACE);\n\n\t\t// If identifier differs, assume the workspace got recreated and thus clean all storage for this workspace\n\t\tif (types.isNumber(id) && workspaceId !== id) {\n\t\t\tlet keyPrefix = this.toStorageKey('', StorageScope.WORKSPACE);\n\t\t\tlet toDelete: string[] = [];\n\t\t\tlet length = this.workspaceStorage.length;\n\n\t\t\tfor (let i = 0; i < length; i++) {\n\t\t\t\tlet key = this.workspaceStorage.key(i);\n\t\t\t\tif (key.indexOf(Storage.WORKSPACE_PREFIX) < 0) {\n\t\t\t\t\tcontinue; // ignore stored things that don't belong to storage service or are defined globally\n\t\t\t\t}\n\n\t\t\t\t// Check for match on prefix\n\t\t\t\tif (key.indexOf(keyPrefix) === 0) {\n\t\t\t\t\ttoDelete.push(key);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (toDelete.length > 0) {\n\t\t\t\tconsole.warn('Clearing previous version of local storage for workspace ', workspaceName);\n\t\t\t}\n\n\t\t\t// Run the delete\n\t\t\ttoDelete.forEach((keyToDelete) => {\n\t\t\t\tthis.workspaceStorage.removeItem(keyToDelete);\n\t\t\t});\n\t\t}\n\n\t\t// Store workspace identifier now\n\t\tif (workspaceId !== id) {\n\t\t\tthis.store(Storage.WORKSPACE_IDENTIFIER, workspaceId, StorageScope.WORKSPACE);\n\t\t}\n\t}\n\n\tpublic clear(): void {\n\t\tthis.globalStorage.clear();\n\t\tthis.workspaceStorage.clear();\n\t}\n\n\tpublic store(key: string, value: any, scope = StorageScope.GLOBAL): void {\n\t\tlet storage = (scope === StorageScope.GLOBAL) ? this.globalStorage : this.workspaceStorage;\n\n\t\tif (types.isUndefinedOrNull(value)) {\n\t\t\tthis.remove(key, scope); // we cannot store null or undefined, in that case we remove the key\n\t\t\treturn;\n\t\t}\n\n\t\tlet storageKey = this.toStorageKey(key, scope);\n\t\tlet before = storage.getItem(storageKey);\n\t\tlet after = value.toString();\n\n\t\t// Store\n\t\ttry {\n\t\t\tstorage.setItem(storageKey, value);\n\t\t} catch (error) {\n\t\t\terrors.onUnexpectedError(error);\n\t\t}\n\n\t\t// Emit Event\n\t\tif (before !== after) {\n\t\t\tthis.emit(StorageEventType.STORAGE, new StorageEvent(key, before, after));\n\t\t}\n\t}\n\n\tpublic get(key: string, scope = StorageScope.GLOBAL, defaultValue?: any): string {\n\t\tlet storage = (scope === StorageScope.GLOBAL) ? this.globalStorage : this.workspaceStorage;\n\n\t\tlet value = storage.getItem(this.toStorageKey(key, scope));\n\t\tif (types.isUndefinedOrNull(value)) {\n\t\t\treturn defaultValue;\n\t\t}\n\n\t\treturn value;\n\t}\n\n\tpublic remove(key: string, scope = StorageScope.GLOBAL): void {\n\t\tlet storage = (scope === StorageScope.GLOBAL) ? this.globalStorage : this.workspaceStorage;\n\n\t\tlet storageKey = this.toStorageKey(key, scope);\n\t\tlet before = storage.getItem(storageKey);\n\t\tlet after: any = null;\n\n\t\t// Remove\n\t\tstorage.removeItem(storageKey);\n\n\t\t// Emit Event\n\t\tif (before !== after) {\n\t\t\tthis.emit(StorageEventType.STORAGE, new StorageEvent(key, before, after));\n\t\t}\n\t}\n\n\tpublic swap(key: string, valueA: any, valueB: any, scope = StorageScope.GLOBAL, defaultValue?: any): void {\n\t\tlet value = this.get(key, scope);\n\t\tif (types.isUndefinedOrNull(value) && defaultValue) {\n\t\t\tthis.store(key, defaultValue, scope);\n\t\t} else if (value === valueA.toString()) { // Convert to string because store is string based\n\t\t\tthis.store(key, valueB, scope);\n\t\t} else {\n\t\t\tthis.store(key, valueA, scope);\n\t\t}\n\t}\n\n\tpublic getInteger(key: string, scope = StorageScope.GLOBAL, defaultValue?: number): number {\n\t\tlet value = this.get(key, scope, defaultValue);\n\n\t\tif (types.isUndefinedOrNull(value)) {\n\t\t\treturn defaultValue;\n\t\t}\n\n\t\treturn parseInt(value, 10);\n\t}\n\n\tpublic getBoolean(key: string, scope = StorageScope.GLOBAL, defaultValue?: boolean): boolean {\n\t\tlet value = this.get(key, scope, defaultValue);\n\n\t\tif (types.isUndefinedOrNull(value)) {\n\t\t\treturn defaultValue;\n\t\t}\n\n\t\tif (types.isString(value)) {\n\t\t\treturn value.toLowerCase() === 'true' ? true : false;\n\t\t}\n\n\t\treturn value ? true : false;\n\t}\n\n\tpublic dispose(): void {\n\t\tsuper.dispose();\n\n\t\twhile (this.toUnbind.length) {\n\t\t\tthis.toUnbind.pop()();\n\t\t}\n\t}\n\n\tprivate toStorageKey(key: string, scope: StorageScope): string {\n\t\tif (scope === StorageScope.GLOBAL) {\n\t\t\treturn Storage.GLOBAL_PREFIX + key.toLowerCase();\n\t\t}\n\n\t\treturn Storage.WORKSPACE_PREFIX + this.workspaceKey + key.toLowerCase();\n\t}\n}\n\n// In-Memory Local Storage Implementation\nexport class InMemoryLocalStorage implements IStorage {\n\tprivate store: { [key: string]: string; };\n\n\tconstructor() {\n\t\tthis.store = {};\n\t}\n\n\tpublic get length() {\n\t\treturn Object.keys(this.store).length;\n\t}\n\n\tpublic key(index: number): string {\n\t\tlet keys = Object.keys(this.store);\n\t\tif (keys.length > index) {\n\t\t\treturn keys[index];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tpublic clear(): void {\n\t\tthis.store = {};\n\t}\n\n\tpublic setItem(key: string, value: any): void {\n\t\tthis.store[key] = value.toString();\n\t}\n\n\tpublic getItem(key: string): string {\n\t\tlet item = this.store[key];\n\t\tif (!types.isUndefinedOrNull(item)) {\n\t\t\treturn item;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tpublic removeItem(key: string): void {\n\t\tdelete this.store[key];\n\t}\n}\n\nexport const inMemoryLocalStorageInstance = new InMemoryLocalStorage();"]}