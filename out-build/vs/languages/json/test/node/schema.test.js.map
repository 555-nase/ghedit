{"version":3,"file":"vs/languages/json/test/node/schema.test.js","sourceRoot":"file:///Users/darrin/src/vscode/src","sources":["vs/languages/json/test/node/schema.test.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\n\nimport assert = require('assert');\nimport http = require('vs/base/common/http');\nimport winjs = require('vs/base/common/winjs.base');\nimport SchemaService = require('vs/languages/json/common/jsonSchemaService');\nimport EditorCommon = require('vs/editor/common/editorCommon');\nimport Strings = require('vs/base/common/strings');\nimport JsonSchema = require('vs/base/common/jsonSchema');\nimport Json = require('vs/base/common/json');\nimport Parser = require('vs/languages/json/common/parser/jsonParser');\nimport pfs = require('vs/base/node/pfs');\nimport path = require('path');\nimport {IRequestService} from 'vs/platform/request/common/request';\n\nsuite('JSON - schema', () => {\n\tvar fixureDocuments = {\n\t\t'http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json': 'deploymentTemplate.json',\n\t\t'http://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json': 'deploymentParameters.json',\n\t\t'http://schema.management.azure.com/schemas/2015-01-01/Microsoft.Authorization.json': 'Microsoft.Authorization.json',\n\t\t'http://schema.management.azure.com/schemas/2015-01-01/Microsoft.Resources.json': 'Microsoft.Resources.json',\n\t\t'http://schema.management.azure.com/schemas/2014-04-01-preview/Microsoft.Sql.json': 'Microsoft.Sql.json',\n\t\t'http://schema.management.azure.com/schemas/2014-06-01/Microsoft.Web.json': 'Microsoft.Web.json',\n\t\t'http://schema.management.azure.com/schemas/2014-04-01/SuccessBricks.ClearDB.json': 'SuccessBricks.ClearDB.json',\n\t\t'http://schema.management.azure.com/schemas/2015-08-01/Microsoft.Compute.json': 'Microsoft.Compute.json'\n\t}\n\n\tvar requestServiceMock = <IRequestService> {\n\t\tmakeRequest: (options:http.IXHROptions) : winjs.TPromise<http.IXHRResponse> => {\n\t\t\tvar uri = options.url;\n\t\t\tif (uri.length && uri[uri.length - 1] === '#') {\n\t\t\t\turi = uri.substr(0, uri.length - 1);\n\t\t\t}\n\t\t\tvar fileName = fixureDocuments[uri];\n\t\t\tif (fileName) {\n\t\t\t\tvar fixtures = require.toUrl('../common/fixtures');\n\t\t\t\treturn pfs.readFile(path.join(fixtures, fileName)).then(value => {\n\t\t\t\t\treturn { responseText: value.toString(), status: 200 };\n\t\t\t\t}, error => {\n\t\t\t\t\treturn winjs.TPromise.wrapError({ responseText: '', status: 404 });\n\t\t\t\t})\n\t\t\t}\n\t\t\treturn winjs.TPromise.wrapError({ responseText: '', status: 404 });\n\t\t}\n\t}\n\n\ttest('Resolving $refs', function(testDone) {\n\t\tvar service = new SchemaService.JSONSchemaService(requestServiceMock);\n\t\tservice.setSchemaContributions({ schemas: {\n\t\t\t\"https://myschemastore/main\" : {\n\t\t\t\tid: 'https://myschemastore/main',\n\t\t\t\ttype: 'object',\n\t\t\t\tproperties: {\n\t\t\t\t\tchild: {\n\t\t\t\t\t\t'$ref': 'https://myschemastore/child'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"https://myschemastore/child\" :{\n\t\t\t\tid: 'https://myschemastore/child',\n\t\t\t\ttype: 'bool',\n\t\t\t\tdescription: 'Test description'\n\t\t\t}\n\t\t}});\n\n\t\tservice.getResolvedSchema('https://myschemastore/main').then(fs => {\n\t\t\tassert.deepEqual(fs.schema.properties['child'], {\n\t\t\t\tid: 'https://myschemastore/child',\n\t\t\t\ttype: 'bool',\n\t\t\t\tdescription: 'Test description'\n\t\t\t});\n\t\t}).done(() => testDone(), (error) => {\n\t\t\ttestDone(error);\n\t\t});\n\n\t});\n\n\ttest('FileSchema', function(testDone) {\n\t\tvar service = new SchemaService.JSONSchemaService(requestServiceMock);\n\n\t\tservice.setSchemaContributions({ schemas: {\n\t\t\t\"main\" : {\n\t\t\t\tid: 'main',\n\t\t\t\ttype: 'object',\n\t\t\t\tproperties: {\n\t\t\t\t\tchild: {\n\t\t\t\t\t\ttype: 'object',\n\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t'grandchild': {\n\t\t\t\t\t\t\t\ttype: 'number',\n\t\t\t\t\t\t\t\tdescription: 'Meaning of Life'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}});\n\n\t\tservice.getResolvedSchema('main').then(fs => {\n\t\t\tvar section = fs.getSection(['child', 'grandchild']);\n\t\t\tassert.equal(section.description, 'Meaning of Life');\n\t\t}).done(() => testDone(), (error) => {\n\t\t\ttestDone(error);\n\t\t});\n\t});\n\n\ttest('Array FileSchema', function(testDone) {\n\t\tvar service = new SchemaService.JSONSchemaService(requestServiceMock);\n\n\t\tservice.setSchemaContributions({ schemas: {\n\t\t\t\"main\" : {\n\t\t\t\tid: 'main',\n\t\t\t\ttype: 'object',\n\t\t\t\tproperties: {\n\t\t\t\t\tchild: {\n\t\t\t\t\t\ttype: 'array',\n\t\t\t\t\t\titems: {\n\t\t\t\t\t\t\t'type': 'object',\n\t\t\t\t\t\t\t'properties': {\n\t\t\t\t\t\t\t\t'grandchild': {\n\t\t\t\t\t\t\t\t\ttype: 'number',\n\t\t\t\t\t\t\t\t\tdescription: 'Meaning of Life'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}});\n\n\t\tservice.getResolvedSchema('main').then(fs => {\n\t\t\tvar section = fs.getSection(['child','0', 'grandchild']);\n\t\t\tassert.equal(section.description, 'Meaning of Life');\n\t\t}).done(() => testDone(), (error) => {\n\t\t\ttestDone(error);\n\t\t});\n\t});\n\n\ttest('Missing subschema', function(testDone) {\n\t\tvar service = new SchemaService.JSONSchemaService(requestServiceMock);\n\n\t\tservice.setSchemaContributions({ schemas: {\n\t\t\t\"main\" : {\n\t\t\t\tid: 'main',\n\t\t\t\ttype: 'object',\n\t\t\t\tproperties: {\n\t\t\t\t\tchild: {\n\t\t\t\t\t\ttype: 'object'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}});\n\n\t\tservice.getResolvedSchema('main').then(fs => {\n\t\t\tvar section = fs.getSection(['child','grandchild']);\n\t\t\tassert.strictEqual(section, null);\n\t\t}).done(() => testDone(), (error) => {\n\t\t\ttestDone(error);\n\t\t});\n\t});\n\n\ttest('Preloaded Schema', function(testDone) {\n\t\tvar service = new SchemaService.JSONSchemaService(requestServiceMock);\n\t\tvar id = 'https://myschemastore/test1';\n\t\tvar schema : JsonSchema.IJSONSchema = {\n\t\t\ttype: 'object',\n\t\t\tproperties: {\n\t\t\t\tchild: {\n\t\t\t\t\ttype: 'object',\n\t\t\t\t\tproperties: {\n\t\t\t\t\t\t'grandchild': {\n\t\t\t\t\t\t\ttype: 'number',\n\t\t\t\t\t\t\tdescription: 'Meaning of Life'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tservice.registerExternalSchema(id, [ '*.json' ], schema);\n\n\t\tservice.getSchemaForResource('test.json', null).then((schema) => {\n\t\t\tvar section = schema.getSection(['child','grandchild']);\n\t\t\tassert.equal(section.description, 'Meaning of Life');\n\t\t}).done(() => testDone(), (error) => {\n\t\t\ttestDone(error);\n\t\t});\n\t});\n\n\ttest('External Schema', function(testDone) {\n\t\tvar service = new SchemaService.JSONSchemaService(requestServiceMock);\n\t\tvar id = 'https://myschemastore/test1';\n\t\tvar schema : JsonSchema.IJSONSchema = {\n\t\t\t\ttype: 'object',\n\t\t\t\tproperties: {\n\t\t\t\t\tchild: {\n\t\t\t\t\t\ttype: 'object',\n\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t'grandchild': {\n\t\t\t\t\t\t\t\ttype: 'number',\n\t\t\t\t\t\t\t\tdescription: 'Meaning of Life'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\tservice.registerExternalSchema(id, [ '*.json' ], schema);\n\n\t\tservice.getSchemaForResource('test.json', null).then((schema) => {\n\t\t\tvar section = schema.getSection(['child','grandchild']);\n\t\t\tassert.equal(section.description, 'Meaning of Life');\n\t\t}).done(() => testDone(), (error) => {\n\t\t\ttestDone(error);\n\t\t});\n\t});\n\n\n\ttest('Resolving in-line $refs', function (testDone) {\n\t\tvar service = new SchemaService.JSONSchemaService(requestServiceMock);\n\t\tvar id = 'https://myschemastore/test1';\n\n\t\tvar schema:JsonSchema.IJSONSchema = {\n\t\t\tid: 'main',\n\t\t\ttype: 'object',\n\t\t\tdefinitions: {\n\t\t\t\t'grandchild': {\n\t\t\t\t\ttype: 'number',\n\t\t\t\t\tdescription: 'Meaning of Life'\n\t\t\t\t}\n\t\t\t},\n\t\t\tproperties: {\n\t\t\t\tchild: {\n\t\t\t\t\ttype: 'array',\n\t\t\t\t\titems: {\n\t\t\t\t\t\t'type': 'object',\n\t\t\t\t\t\t'properties': {\n\t\t\t\t\t\t\t'grandchild': {\n\t\t\t\t\t\t\t\t$ref: '#/definitions/grandchild'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tservice.registerExternalSchema(id, [ '*.json' ], schema);\n\n\t\tservice.getSchemaForResource('test.json', null).then((fs) => {\n\t\t\tvar section = fs.getSection(['child', '0', 'grandchild']);\n\t\t\tassert.equal(section.description, 'Meaning of Life');\n\t\t}).done(() => testDone(), (error) => {\n\t\t\ttestDone(error);\n\t\t});\n\t});\n\n\ttest('Resolving in-line $refs automatically for external schemas', function(testDone) {\n\t\tvar service = new SchemaService.JSONSchemaService(requestServiceMock);\n\t\tvar id = 'https://myschemastore/test1';\n\t\tvar schema:JsonSchema.IJSONSchema = {\n\t\t\tid: 'main',\n\t\t\ttype: 'object',\n\t\t\tdefinitions: {\n\t\t\t\t'grandchild': {\n\t\t\t\t\ttype: 'number',\n\t\t\t\t\tdescription: 'Meaning of Life'\n\t\t\t\t}\n\t\t\t},\n\t\t\tproperties: {\n\t\t\t\tchild: {\n\t\t\t\t\ttype: 'array',\n\t\t\t\t\titems: {\n\t\t\t\t\t\t'type': 'object',\n\t\t\t\t\t\t'properties': {\n\t\t\t\t\t\t\t'grandchild': {\n\t\t\t\t\t\t\t\t$ref: '#/definitions/grandchild'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tvar fsm = service.registerExternalSchema(id, [ '*.json' ], schema);\n\t\tfsm.getResolvedSchema().then((fs) => {\n\t\t\tvar section = fs.getSection(['child','0', 'grandchild']);\n\t\t\tassert.equal(section.description, 'Meaning of Life');\n\t\t}).done(() => testDone(), (error) => {\n\t\t\ttestDone(error);\n\t\t});\n\t});\n\n\n\ttest('Clearing External Schemas', function(testDone) {\n\t\tvar service = new SchemaService.JSONSchemaService(requestServiceMock);\n\t\tvar id1 = 'http://myschemastore/test1';\n\t\tvar schema1:JsonSchema.IJSONSchema = {\n\t\t\ttype: 'object',\n\t\t\tproperties: {\n\t\t\t\tchild: {\n\t\t\t\t\ttype: 'number'\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tvar id2 = 'http://myschemastore/test2';\n\t\tvar schema2:JsonSchema.IJSONSchema = {\n\t\t\ttype: 'object',\n\t\t\tproperties: {\n\t\t\t\tchild: {\n\t\t\t\t\ttype: 'string'\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tservice.registerExternalSchema(id1, [ 'test.json', 'bar.json' ], schema1);\n\n\t\tservice.getSchemaForResource('test.json', null).then((schema) => {\n\t\t\tvar section = schema.getSection(['child']);\n\t\t\tassert.equal(section.type, 'number');\n\n\t\t\tservice.clearExternalSchemas();\n\n\t\t\tservice.registerExternalSchema(id2, [ '*.json' ], schema2);\n\n\t\t\treturn service.getSchemaForResource('test.json', null).then((schema) => {\n\t\t\t\tvar section = schema.getSection(['child']);\n\t\t\t\tassert.equal(section.type, 'string');\n\t\t\t});\n\t\t}).done(() => testDone(), (error) => {\n\t\t\ttestDone(error);\n\t\t});\n\t});\n\n\ttest('Schema contributions', function(testDone) {\n\t\tvar service = new SchemaService.JSONSchemaService(requestServiceMock);\n\n\t\tservice.setSchemaContributions({ schemas: {\n\t\t\t\"http://myschemastore/myschemabar\" : {\n\t\t\t\tid: 'main',\n\t\t\t\ttype: 'object',\n\t\t\t\tproperties: {\n\t\t\t\t\tfoo: {\n\t\t\t\t\t\ttype: 'string'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, schemaAssociations: {\n\t\t\t'*.bar': ['http://myschemastore/myschemabar', 'http://myschemastore/myschemafoo']\n\t\t}});\n\n\t\tvar id2 = 'http://myschemastore/myschemafoo';\n\t\tvar schema2:JsonSchema.IJSONSchema = {\n\t\t\ttype: 'object',\n\t\t\tproperties: {\n\t\t\t\tchild: {\n\t\t\t\t\ttype: 'string'\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tservice.registerExternalSchema(id2, null, schema2);\n\n\t\tservice.getSchemaForResource('main.bar', null).then(resolvedSchema => {\n\t\t\tassert.deepEqual(resolvedSchema.errors, []);\n\t\t\tassert.equal(2, resolvedSchema.schema.allOf.length);\n\n\t\t\tservice.clearExternalSchemas();\n\t\t\treturn service.getSchemaForResource('main.bar', null).then(resolvedSchema => {\n\t\t\t\tassert.equal(resolvedSchema.errors.length, 1);\n\t\t\t\tassert.ok(resolvedSchema.errors[0].indexOf(\"Problems loading reference 'http://myschemastore/myschemafoo'\") === 0);\n\n\t\t\t\tservice.clearExternalSchemas();\n\t\t\t\tservice.registerExternalSchema(id2, null, schema2);\n\t\t\t\treturn service.getSchemaForResource('main.bar', null).then(resolvedSchema => {\n\t\t\t\t\tassert.equal(resolvedSchema.errors.length, 0);\n\t\t\t\t});\n\t\t\t});\n\t\t}).done(() => testDone(), (error) => {\n\t\t\ttestDone(error);\n\t\t});\n\t});\n\n\ttest('Resolving circular $refs', function(testDone) {\n\n\t\tvar service : SchemaService.IJSONSchemaService = new SchemaService.JSONSchemaService(requestServiceMock);\n\n\t\tvar input = {\n\t\t\t\"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n\t\t\t\"contentVersion\": \"1.0.0.0\",\n\t\t\t\"resources\": [\n\t\t\t\t{\n\t\t\t\t\t\"name\": \"SQLServer\",\n\t\t\t\t\t\"type\": \"Microsoft.Sql/servers\",\n\t\t\t\t\t\"location\": \"West US\",\n\t\t\t\t\t\"apiVersion\": \"2014-04-01-preview\",\n\t\t\t\t\t\"dependsOn\": [ ],\n\t\t\t\t\t\"tags\": {\n\t\t\t\t\t\t\"displayName\": \"SQL Server\"\n\t\t\t\t\t},\n\t\t\t\t\t\"properties\": {\n\t\t\t\t\t\t\"administratorLogin\": \"asdfasd\",\n\t\t\t\t\t\t\"administratorLoginPassword\": \"asdfasdfasd\"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t\tvar parser = new Parser.JSONParser();\n\t\tvar document = parser.parse(JSON.stringify(input));\n\n\t\tservice.getSchemaForResource('file://doc/mydoc.json', document).then(resolveSchema => {\n\t\t\tassert.deepEqual(resolveSchema.errors, []);\n\n\t\t\tvar content = JSON.stringify(resolveSchema.schema);\n\t\t\tassert.equal(content.indexOf('$ref'), -1); // no more $refs\n\n\t\t\tvar matchingSchemas = [];\n\t\t\tdocument.validate(resolveSchema.schema, matchingSchemas);\n\t\t\tassert.deepEqual(document.errors, []);\n\t\t\tassert.deepEqual(document.warnings, []);\n\t\t}).done(() => testDone(), (error) => {\n\t\t\ttestDone(error);\n\t\t});\n\n\t});\n\n\ttest('Resolving circular $refs, invalid document', function(testDone) {\n\n\t\tvar service : SchemaService.IJSONSchemaService = new SchemaService.JSONSchemaService(requestServiceMock);\n\n\t\tvar input = {\n\t\t\t\"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n\t\t\t\"contentVersion\": \"1.0.0.0\",\n\t\t\t\"resources\": [\n\t\t\t\t{\n\t\t\t\t\t\"name\": \"foo\",\n\t\t\t\t\t\"type\": \"Microsoft.Resources/deployments\",\n\t\t\t\t\t\"apiVersion\": \"2015-01-01\",\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t\tvar parser = new Parser.JSONParser();\n\t\tvar document = parser.parse(JSON.stringify(input));\n\n\t\tservice.getSchemaForResource('file://doc/mydoc.json', document).then(resolveSchema => {\n\t\t\tassert.deepEqual(resolveSchema.errors, []);\n\n\t\t\tvar content = JSON.stringify(resolveSchema.schema);\n\t\t\tassert.equal(content.indexOf('$ref'), -1); // no more $refs\n\n\t\t\tvar matchingSchemas = [];\n\t\t\tdocument.validate(resolveSchema.schema, matchingSchemas);\n\t\t\tassert.deepEqual(document.errors, []);\n\t\t\tassert.equal(document.warnings.length, 1);\n\t\t}).done(() => testDone(), (error) => {\n\t\t\ttestDone(error);\n\t\t});\n\n\t});\n\n\ttest('Validate Azure Resource Dfinition', function(testDone) {\n\n\n\t\tvar service : SchemaService.IJSONSchemaService = new SchemaService.JSONSchemaService(requestServiceMock);\n\n\t\tvar input = {\n\t\t\t\"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n\t\t\t\"contentVersion\": \"1.0.0.0\",\n\t\t\t\"resources\": [\n\t\t\t\t{\n\t\t\t\t\t\"apiVersion\": \"2015-06-15\",\n\t\t\t\t\t\"type\": \"Microsoft.Compute/virtualMachines\",\n\t\t\t\t\t\"name\": \"a\",\n\t\t\t\t\t\"location\": \"West US\",\n\t\t\t\t\t\"properties\": {\n\t\t\t\t\t\t\"hardwareProfile\": {\n\t\t\t\t\t\t\t\"vmSize\": \"Small\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"osProfile\": {\n\t\t\t\t\t\t\t\"computername\": \"a\",\n\t\t\t\t\t\t\t\"adminUsername\": \"a\",\n\t\t\t\t\t\t\t\"adminPassword\": \"a\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"storageProfile\": {\n\t\t\t\t\t\t\t\"imageReference\": {\n\t\t\t\t\t\t\t\t\"publisher\": \"a\",\n\t\t\t\t\t\t\t\t\"offer\": \"a\",\n\t\t\t\t\t\t\t\t\"sku\": \"a\",\n\t\t\t\t\t\t\t\t\"version\": \"latest\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\"osDisk\": {\n\t\t\t\t\t\t\t\t\"name\": \"osdisk\",\n\t\t\t\t\t\t\t\t\"vhd\": {\n\t\t\t\t\t\t\t\t\t\"uri\": \"[concat('http://', 'b','.blob.core.windows.net/',variables('vmStorageAccountContainerName'),'/',variables('OSDiskName'),'.vhd')]\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\"caching\": \"ReadWrite\",\n\t\t\t\t\t\t\t\t\"createOption\": \"FromImage\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"networkProfile\": {\n\t\t\t\t\t\t\t\"networkInterfaces\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"id\": \"[resourceId('Microsoft.Network/networkInterfaces',variables('nicName'))]\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"diagnosticsProfile\": {\n\t\t\t\t\t\t\t\"bootDiagnostics\": {\n\t\t\t\t\t\t\t\t\"enabled\": \"true\",\n\t\t\t\t\t\t\t\t\"storageUri\": \"[concat('http://',parameters('newStorageAccountName'),'.blob.core.windows.net')]\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t\tvar parser = new Parser.JSONParser();\n\t\tvar document = parser.parse(JSON.stringify(input));\n\n\t\tservice.getSchemaForResource('file://doc/mydoc.json', document).then(resolvedSchema => {\n\t\t\tassert.deepEqual(resolvedSchema.errors, []);\n\n\t\t\tdocument.validate(resolvedSchema.schema);\n\n\t\t\tassert.equal(document.warnings.length, 1);\n\t\t\tassert.equal(document.warnings[0].message, 'Missing property \"computerName\"');\n\t\t}).done(() => testDone(), (error) => {\n\t\t\ttestDone(error);\n\t\t});\n\n\t});\n\n});\n"]}