{"version":3,"file":"vs/platform/telemetry/common/workspaceStats.js","sourceRoot":"file:///Users/darrin/src/vscode/src","sources":["vs/platform/telemetry/common/workspaceStats.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n'use strict';\n\nimport winjs = require('vs/base/common/winjs.base');\nimport errors = require('vs/base/common/errors');\nimport {IFileService} from 'vs/platform/files/common/files';\nimport {ITelemetryService} from 'vs/platform/telemetry/common/telemetry';\nimport {IWorkspaceContextService} from 'vs/platform/workspace/common/workspace';\n\nexport class WorkspaceStats {\n\tconstructor(\n\t\t@IFileService private fileService: IFileService,\n\t\t@IWorkspaceContextService private contextService: IWorkspaceContextService,\n\t\t@ITelemetryService private telemetryService: ITelemetryService\n\t) {\n\t}\n\n\tprivate searchArray(arr: string[], regEx: RegExp): boolean {\n\t\treturn arr.some(v => v.search(regEx) > -1);\n\t}\n\n\tprivate getWorkspaceTags(): winjs.TPromise<{ [index: string]: boolean }> {\n\t\tlet tags: { [index: string]: boolean } = Object.create(null);\n\t\tlet workspace = this.contextService.getWorkspace();\n\n\t\tif (workspace && this.fileService) {\n\t\t\treturn this.fileService.resolveFile(workspace.resource).then(stats => {\n\t\t\t\tlet names = stats.children.map(c => c.name);\n\n\t\t\t\ttags['workspace.empty'] = false;\n\n\t\t\t\ttags['workspace.language.cs'] = this.searchArray(names, /^.+\\.cs$/i);\n\t\t\t\ttags['workspace.language.js'] = this.searchArray(names, /^.+\\.js$/i);\n\t\t\t\ttags['workspace.language.ts'] = this.searchArray(names, /^.+\\.ts$/i);\n\t\t\t\ttags['workspace.language.php'] = this.searchArray(names, /^.+\\.php$/i);\n\t\t\t\ttags['workspace.language.python'] = this.searchArray(names, /^.+\\.py$/i);\n\t\t\t\ttags['workspace.language.vb'] = this.searchArray(names, /^.+\\.vb$/i);\n\t\t\t\ttags['workspace.language.aspx'] = this.searchArray(names, /^.+\\.aspx$/i);\n\n\t\t\t\ttags['workspace.grunt'] = this.searchArray(names, /^gruntfile\\.js$/i);\n\t\t\t\ttags['workspace.gulp'] = this.searchArray(names, /^gulpfile\\.js$/i);\n\t\t\t\ttags['workspace.jake'] = this.searchArray(names, /^jakefile\\.js$/i);\n\n\t\t\t\ttags['workspace.tsconfig'] = this.searchArray(names, /^tsconfig\\.json$/i);\n\t\t\t\ttags['workspace.jsconfig'] = this.searchArray(names, /^jsconfig\\.json$/i);\n\t\t\t\ttags['workspace.config.xml'] = this.searchArray(names, /^config\\.xml/i);\n\t\t\t\ttags['workspace.vsc.extension'] = this.searchArray(names, /^vsc-extension-quickstart\\.md/i);\n\n\t\t\t\ttags['workspace.ASP5'] = this.searchArray(names, /^project\\.json$/i) && tags['workspace.language.cs'];\n\t\t\t\ttags['workspace.sln'] = this.searchArray(names, /^.+\\.sln$|^.+\\.csproj$/i);\n\t\t\t\ttags['workspace.unity'] = this.searchArray(names, /^Assets$/i) && this.searchArray(names, /^Library$/i) && this.searchArray(names, /^ProjectSettings/i);\n\t\t\t\ttags['workspace.npm'] = this.searchArray(names, /^package\\.json$|^node_modules$/i);\n\t\t\t\ttags['workspace.bower'] = this.searchArray(names, /^bower\\.json$|^bower_components$/i);\n\n\t\t\t\ttags['workspace.yeoman.code'] = this.searchArray(names, /^vscodequickstart\\.md$/i);\n\t\t\t\ttags['workspace.yeoman.code.ext'] = this.searchArray(names, /^vsc-extension-quickstart\\.md$/i);\n\n\t\t\t\tlet mainActivity = this.searchArray(names, /^MainActivity\\.cs$/i) || this.searchArray(names, /^MainActivity\\.fs$/i);\n\t\t\t\tlet appDelegate = this.searchArray(names, /^AppDelegate\\.cs$/i) || this.searchArray(names, /^AppDelegate\\.fs$/i);\n\t\t\t\tlet androidManifest = this.searchArray(names, /^AndroidManifest\\.xml$/i);\n\n\t\t\t\tlet platforms = this.searchArray(names, /^platforms$/i);\n\t\t\t\tlet plugins = this.searchArray(names, /^plugins$/i);\n\t\t\t\tlet www = this.searchArray(names, /^www$/i);\n\t\t\t\tlet properties = this.searchArray(names, /^Properties/i);\n\t\t\t\tlet resources = this.searchArray(names, /^Resources/i);\n\t\t\t\tlet jni = this.searchArray(names, /^JNI/i);\n\n\t\t\t\tif (tags['workspace.config.xml'] &&\n\t\t\t\t\t!tags['workspace.language.cs'] && !tags['workspace.language.vb'] && !tags['workspace.language.aspx']) {\n\t\t\t\t\tif (platforms && plugins && www) {\n\t\t\t\t\t\ttags['workspace.cordova.high'] = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttags['workspace.cordova.low'] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (mainActivity && properties && resources) {\n\t\t\t\t\ttags['workspace.xamarin.android'] = true;\n\t\t\t\t}\n\n\t\t\t\tif (appDelegate && resources) {\n\t\t\t\t\ttags['workspace.xamarin.ios'] = true;\n\t\t\t\t}\n\n\t\t\t\tif (androidManifest && jni) {\n\t\t\t\t\ttags['workspace.android.cpp'] = true;\n\t\t\t\t}\n\n\t\t\t\ttags['workspace.reactNative'] = this.searchArray(names, /^android$/i) && this.searchArray(names, /^ios$/i) &&\n\t\t\t\t\tthis.searchArray(names, /^index\\.android\\.js$/i) && this.searchArray(names, /^index\\.ios\\.js$/i);\n\n\t\t\t\treturn tags;\n\t\t\t}, error => { errors.onUnexpectedError(error); return null; });\n\t\t} else {\n\t\t\ttags['workspace.empty'] = true;\n\t\t\treturn winjs.TPromise.as(tags);\n\t\t}\n\t}\n\n\tpublic reportWorkspaceTags(): void {\n\t\tthis.getWorkspaceTags().then((tags) => {\n\t\t\tthis.telemetryService.publicLog('workspce.tags', tags);\n\t\t}, error => errors.onUnexpectedError(error));\n\t}\n}"]}