{"version":3,"sources":["vs/editor/contrib/hover/browser/hover.ts"],"names":[],"mappings":"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","file":"vs/editor/contrib/hover/browser/hover.js","sourceRoot":"file:///Users/darrin/src/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n'use strict';\n\nimport 'vs/css!./hover';\nimport * as nls from 'vs/nls';\nimport {ListenerUnbind} from 'vs/base/common/eventEmitter';\nimport {KeyCode, KeyMod} from 'vs/base/common/keyCodes';\nimport * as platform from 'vs/base/common/platform';\nimport {TPromise} from 'vs/base/common/winjs.base';\nimport {IKeyboardEvent} from 'vs/base/browser/keyboardEvent';\nimport {IOpenerService} from 'vs/platform/opener/common/opener';\nimport {KbExpr} from 'vs/platform/keybinding/common/keybindingService';\nimport {Range} from 'vs/editor/common/core/range';\nimport {EditorAction} from 'vs/editor/common/editorAction';\nimport {Behaviour} from 'vs/editor/common/editorActionEnablement';\nimport * as editorCommon from 'vs/editor/common/editorCommon';\nimport {CommonEditorRegistry, ContextKey, EditorActionDescriptor} from 'vs/editor/common/editorCommonExtensions';\nimport {ICodeEditor, IEditorMouseEvent} from 'vs/editor/browser/editorBrowser';\nimport {EditorBrowserRegistry} from 'vs/editor/browser/editorBrowserExtensions';\nimport {ModesContentHoverWidget} from './modesContentHover';\nimport {ModesGlyphHoverWidget} from './modesGlyphHover';\n\nclass ModesHoverController implements editorCommon.IEditorContribution {\n\n\tstatic ID = 'editor.contrib.hover';\n\n\tprivate _editor: ICodeEditor;\n\tprivate _toUnhook:ListenerUnbind[];\n\n\tprivate _contentWidget: ModesContentHoverWidget;\n\tprivate _glyphWidget: ModesGlyphHoverWidget;\n\n\tstatic getModesHoverController(editor: editorCommon.ICommonCodeEditor): ModesHoverController {\n\t\treturn <ModesHoverController>editor.getContribution(ModesHoverController.ID);\n\t}\n\n\tconstructor(editor: ICodeEditor,\n\t\t@IOpenerService openerService: IOpenerService\n\t) {\n\t\tthis._editor = editor;\n\n\t\tthis._toUnhook = [];\n\n\t\tif (editor.getConfiguration().hover) {\n\t\t\tthis._toUnhook.push(this._editor.addListener(editorCommon.EventType.MouseDown, (e: IEditorMouseEvent) => this._onEditorMouseDown(e)));\n\t\t\tthis._toUnhook.push(this._editor.addListener(editorCommon.EventType.MouseMove, (e: IEditorMouseEvent) => this._onEditorMouseMove(e)));\n\t\t\tthis._toUnhook.push(this._editor.addListener(editorCommon.EventType.MouseLeave, (e: IEditorMouseEvent) => this._hideWidgets()));\n\t\t\tthis._toUnhook.push(this._editor.addListener(editorCommon.EventType.KeyDown, (e:IKeyboardEvent) => this._onKeyDown(e)));\n\t\t\tthis._toUnhook.push(this._editor.addListener(editorCommon.EventType.ModelChanged, () => this._hideWidgets()));\n\t\t\tthis._toUnhook.push(this._editor.addListener(editorCommon.EventType.ModelDecorationsChanged, () => this._onModelDecorationsChanged()));\n\t\t\tthis._toUnhook.push(this._editor.addListener('scroll', () => this._hideWidgets()));\n\n\t\t\tthis._contentWidget = new ModesContentHoverWidget(editor, openerService);\n\t\t\tthis._glyphWidget = new ModesGlyphHoverWidget(editor);\n\t\t}\n\t}\n\n\tprivate _onModelDecorationsChanged(): void {\n\t\tthis._contentWidget.onModelDecorationsChanged();\n\t\tthis._glyphWidget.onModelDecorationsChanged();\n\t}\n\n\tprivate _onEditorMouseDown(mouseEvent: IEditorMouseEvent): void {\n\t\tvar targetType = mouseEvent.target.type;\n\n\t\tif (targetType === editorCommon.MouseTargetType.CONTENT_WIDGET && mouseEvent.target.detail ===  ModesContentHoverWidget.ID) {\n\t\t\t// mouse down on top of content hover widget\n\t\t\treturn;\n\t\t}\n\n\t\tif (targetType === editorCommon.MouseTargetType.OVERLAY_WIDGET && mouseEvent.target.detail === ModesGlyphHoverWidget.ID) {\n\t\t\t// mouse down on top of overlay hover widget\n\t\t\treturn;\n\t\t}\n\n\t\tthis._hideWidgets();\n\t}\n\n\tprivate _onEditorMouseMove(mouseEvent: IEditorMouseEvent): void {\n\t\tvar targetType = mouseEvent.target.type;\n\t\tvar stopKey = platform.isMacintosh ? 'metaKey' : 'ctrlKey';\n\n\t\tif (targetType === editorCommon.MouseTargetType.CONTENT_WIDGET && mouseEvent.target.detail ===  ModesContentHoverWidget.ID && !mouseEvent.event[stopKey]) {\n\t\t\t// mouse moved on top of content hover widget\n\t\t\treturn;\n\t\t}\n\n\t\tif (targetType === editorCommon.MouseTargetType.OVERLAY_WIDGET && mouseEvent.target.detail === ModesGlyphHoverWidget.ID && !mouseEvent.event[stopKey]) {\n\t\t\t// mouse moved on top of overlay hover widget\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._editor.getConfiguration().hover && targetType === editorCommon.MouseTargetType.CONTENT_TEXT) {\n\t\t\tthis._glyphWidget.hide();\n\t\t\tthis._contentWidget.startShowingAt(mouseEvent.target.range, false);\n\t\t} else if (targetType === editorCommon.MouseTargetType.GUTTER_GLYPH_MARGIN) {\n\t\t\tthis._contentWidget.hide();\n\t\t\tthis._glyphWidget.startShowingAt(mouseEvent.target.position.lineNumber);\n\t\t} else {\n\t\t\tthis._hideWidgets();\n\t\t}\n\t}\n\n\tprivate _onKeyDown(e: IKeyboardEvent): void {\n\t\tvar stopKey = platform.isMacintosh ? KeyCode.Meta : KeyCode.Ctrl;\n\t\tif (e.keyCode !== stopKey) {\n\t\t\t// Do not hide hover when Ctrl/Meta is pressed\n\t\t\tthis._hideWidgets();\n\t\t}\n\t}\n\n\tprivate _hideWidgets(): void {\n\t\tthis._glyphWidget.hide();\n\t\tthis._contentWidget.hide();\n\t}\n\n\tpublic showContentHover(range: editorCommon.IEditorRange, focus: boolean): void {\n\t\tthis._contentWidget.startShowingAt(range, focus);\n\t}\n\n\tpublic getId(): string {\n\t\treturn ModesHoverController.ID;\n\t}\n\n\tpublic dispose(): void {\n\t\twhile(this._toUnhook.length > 0) {\n\t\t\tthis._toUnhook.pop()();\n\t\t}\n\t\tif (this._glyphWidget) {\n\t\t\tthis._glyphWidget.dispose();\n\t\t\tthis._glyphWidget = null;\n\t\t}\n\t\tif (this._contentWidget) {\n\t\t\tthis._contentWidget.dispose();\n\t\t\tthis._contentWidget = null;\n\t\t}\n\t}\n}\n\nclass ShowHoverAction extends EditorAction {\n\tstatic ID = 'editor.action.showHover';\n\n\tconstructor(descriptor: editorCommon.IEditorActionDescriptorData, editor: editorCommon.ICommonCodeEditor) {\n\t\tsuper(descriptor, editor, Behaviour.TextFocus);\n\t}\n\n\tpublic run(): TPromise<any> {\n\t\tconst position = this.editor.getPosition();\n\t\tconst range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\n\t\t(<ModesHoverController>this.editor.getContribution(ModesHoverController.ID)).showContentHover(range, true);\n\n\t\treturn TPromise.as(null);\n\t}\n}\n\nEditorBrowserRegistry.registerEditorContribution(ModesHoverController);\nCommonEditorRegistry.registerEditorAction(new EditorActionDescriptor(ShowHoverAction, ShowHoverAction.ID, nls.localize('showHover', \"Show Hover\"), {\n\tcontext: ContextKey.EditorTextFocus,\n\tkbExpr: KbExpr.has(editorCommon.KEYBINDING_CONTEXT_EDITOR_TEXT_FOCUS),\n\tprimary: KeyMod.chord(KeyMod.CtrlCmd | KeyCode.KEY_K, KeyMod.CtrlCmd | KeyCode.KEY_I)\n}));\n"]}