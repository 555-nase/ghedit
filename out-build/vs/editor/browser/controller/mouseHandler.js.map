{"version":3,"file":"vs/editor/browser/controller/mouseHandler.js","sourceRoot":"file:///Users/darrin/src/vscode/src","sources":["vs/editor/browser/controller/mouseHandler.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\n\nimport {IDisposable, dispose, Disposable} from 'vs/base/common/lifecycle';\nimport * as platform from 'vs/base/common/platform';\nimport * as browser from 'vs/base/browser/browser';\nimport * as dom from 'vs/base/browser/dom';\nimport {GlobalMouseMoveMonitor} from 'vs/base/browser/globalMouseMoveMonitor';\nimport {IMouseEvent, StandardMouseEvent} from 'vs/base/browser/mouseEvent';\nimport {Position} from 'vs/editor/common/core/position';\nimport {Selection} from 'vs/editor/common/core/selection';\nimport * as editorCommon from 'vs/editor/common/editorCommon';\nimport {ViewEventHandler} from 'vs/editor/common/viewModel/viewEventHandler';\nimport {MouseTargetFactory, ISimplifiedMouseEvent} from 'vs/editor/browser/controller/mouseTarget';\nimport * as editorBrowser from 'vs/editor/browser/editorBrowser';\nimport {TimeoutTimer} from 'vs/base/common/async';\n\n/**\n * Merges mouse events when mouse move events are throttled\n */\nfunction createMouseMoveEventMerger(mouseTargetFactory:MouseTargetFactory) {\n\treturn function(lastEvent:IMouseEvent, currentEvent:MouseEvent): IMouseEvent {\n\t\tlet r = new StandardMouseEvent(currentEvent);\n\t\tlet targetIsWidget = false;\n\t\tif (mouseTargetFactory) {\n\t\t\ttargetIsWidget = mouseTargetFactory.mouseTargetIsWidget(r);\n\t\t}\n\t\tif (!targetIsWidget) {\n\t\t\tr.preventDefault();\n\t\t}\n\t\treturn r;\n\t};\n}\n\nclass EventGateKeeper<T> extends Disposable {\n\n\tpublic handler: (value:T)=>void;\n\n\tprivate _destination: (value:T)=>void;\n\tprivate _condition: ()=>boolean;\n\n\tprivate _retryTimer: TimeoutTimer;\n\tprivate _retryValue: T;\n\n\tconstructor(destination:(value:T)=>void, condition:()=>boolean) {\n\t\tsuper();\n\t\tthis._destination = destination;\n\t\tthis._condition = condition;\n\t\tthis._retryTimer = this._register(new TimeoutTimer());\n\t\tthis.handler = (value:T) => this._handle(value);\n\t}\n\n\tpublic dispose(): void {\n\t\tthis._retryValue = null;\n\t\tsuper.dispose();\n\t}\n\n\tprivate _handle(value:T): void {\n\t\tif (this._condition()) {\n\t\t\tthis._retryTimer.cancel();\n\t\t\tthis._retryValue = null;\n\t\t\tthis._destination(value);\n\t\t} else {\n\t\t\tthis._retryValue = value;\n\t\t\tthis._retryTimer.setIfNotSet(() => {\n\t\t\t\tlet tmp = this._retryValue;\n\t\t\t\tthis._retryValue = null;\n\t\t\t\tthis._handle(tmp);\n\t\t\t}, 10);\n\t\t}\n\t}\n}\n\nclass MousePosition {\n\tpublic position: editorCommon.IEditorPosition;\n\tpublic mouseColumn: number;\n\n\tconstructor(position:editorCommon.IEditorPosition, mouseColumn:number) {\n\t\tthis.position = position;\n\t\tthis.mouseColumn = mouseColumn;\n\t}\n}\n\nexport class MouseHandler extends ViewEventHandler implements IDisposable {\n\n\tstatic MOUSE_MOVE_MINIMUM_TIME = 100; // ms\n\n\tpublic context:editorBrowser.IViewContext;\n\tpublic viewController:editorBrowser.IViewController;\n\tpublic viewHelper:editorBrowser.IPointerHandlerHelper;\n\tpublic mouseTargetFactory: MouseTargetFactory;\n\tpublic listenersToRemove:IDisposable[];\n\tprivate toDispose:IDisposable[];\n\n\tprivate _mouseDownOperation: MouseDownOperation;\n\tprivate lastMouseLeaveTime:number;\n\n\tprivate _mouseMoveEventHandler: EventGateKeeper<IMouseEvent>;\n\n\tconstructor(context:editorBrowser.IViewContext, viewController:editorBrowser.IViewController, viewHelper:editorBrowser.IPointerHandlerHelper) {\n\t\tsuper();\n\n\t\tthis.context = context;\n\t\tthis.viewController = viewController;\n\t\tthis.viewHelper = viewHelper;\n\t\tthis.mouseTargetFactory = new MouseTargetFactory(this.context, viewHelper);\n\t\tthis.listenersToRemove = [];\n\n\t\tthis._mouseDownOperation = new MouseDownOperation(\n\t\t\tthis.context,\n\t\t\tthis.viewController,\n\t\t\tthis.viewHelper,\n\t\t\t(e, testEventTarget) => this._createMouseTarget(e, testEventTarget),\n\t\t\t(e) => this._getMouseColumn(e)\n\t\t);\n\n\t\tthis.toDispose = [];\n\n\t\tthis.lastMouseLeaveTime = -1;\n\n\t\tthis.listenersToRemove.push(dom.addDisposableListener(this.viewHelper.viewDomNode, 'contextmenu',\n\t\t\t(e: MouseEvent) => this._onContextMenu(e, true)));\n\n\t\tthis._mouseMoveEventHandler = new EventGateKeeper<IMouseEvent>((e) => this._onMouseMove(e), () => !this.viewHelper.isDirty());\n\t\tthis.toDispose.push(this._mouseMoveEventHandler);\n\t\tthis.listenersToRemove.push(dom.addDisposableThrottledListener(this.viewHelper.viewDomNode, 'mousemove',\n\t\t\tthis._mouseMoveEventHandler.handler,\n\t\t\tcreateMouseMoveEventMerger(this.mouseTargetFactory), MouseHandler.MOUSE_MOVE_MINIMUM_TIME));\n\n\t\tthis.listenersToRemove.push(dom.addDisposableListener(this.viewHelper.viewDomNode, 'mouseup',\n\t\t\t(e: MouseEvent) => this._onMouseUp(e)));\n\n\t\tthis.listenersToRemove.push(dom.addDisposableNonBubblingMouseOutListener(this.viewHelper.viewDomNode,\n\t\t\t(e:MouseEvent) => this._onMouseLeave(e)));\n\n\t\tthis.listenersToRemove.push(dom.addDisposableListener(this.viewHelper.viewDomNode, 'mousedown',\n\t\t\t(e: MouseEvent) => this._onMouseDown(e)));\n\n\t\tthis.context.addEventHandler(this);\n\t}\n\n\tpublic dispose(): void {\n\t\tthis.context.removeEventHandler(this);\n\t\tthis.listenersToRemove = dispose(this.listenersToRemove);\n\t\tthis.toDispose = dispose(this.toDispose);\n\t\tthis._mouseDownOperation.dispose();\n\t}\n\n\t// --- begin event handlers\n\t_layoutInfo:editorCommon.IEditorLayoutInfo;\n\tpublic onLayoutChanged(layoutInfo:editorCommon.IEditorLayoutInfo): boolean {\n\t\tthis._layoutInfo = layoutInfo;\n\t\treturn false;\n\t}\n\tpublic onScrollChanged(e:editorCommon.IScrollEvent): boolean {\n\t\tthis._mouseDownOperation.onScrollChanged();\n\t\treturn false;\n\t}\n\tpublic onCursorSelectionChanged(e:editorCommon.IViewCursorSelectionChangedEvent): boolean {\n\t\tthis._mouseDownOperation.onCursorSelectionChanged(e);\n\t\treturn false;\n\t}\n\t// --- end event handlers\n\n\tprotected _createMouseTarget(e:ISimplifiedMouseEvent, testEventTarget:boolean): editorBrowser.IMouseTarget {\n\t\tlet editorContent = dom.getDomNodePosition(this.viewHelper.viewDomNode);\n\t\treturn this.mouseTargetFactory.createMouseTarget(this._layoutInfo, editorContent, e, testEventTarget);\n\t}\n\n\tprivate _getMouseColumn(e:ISimplifiedMouseEvent): number {\n\t\tlet editorContent = dom.getDomNodePosition(this.viewHelper.viewDomNode);\n\t\treturn this.mouseTargetFactory.getMouseColumn(this._layoutInfo, editorContent, e);\n\t}\n\n\tprotected _onContextMenu(rawEvent: MouseEvent, testEventTarget:boolean): void {\n\t\tlet e = new StandardMouseEvent(rawEvent);\n\t\tlet t = this._createMouseTarget(e, testEventTarget);\n\t\tlet mouseEvent: editorBrowser.IEditorMouseEvent = {\n\t\t\tevent: e,\n\t\t\ttarget: t\n\t\t};\n\t\tthis.viewController.emitContextMenu(mouseEvent);\n\t}\n\n\tprivate _onMouseMove(e: IMouseEvent): void {\n\t\tif (this._mouseDownOperation.isActive()) {\n\t\t\t// In selection/drag operation\n\t\t\treturn;\n\t\t}\n\t\tlet actualMouseMoveTime = e.timestamp;\n\t\tif (actualMouseMoveTime < this.lastMouseLeaveTime) {\n\t\t\t// Due to throttling, this event occured before the mouse left the editor, therefore ignore it.\n\t\t\treturn;\n\t\t}\n\n\t\tlet t = this._createMouseTarget(e, true);\n\t\tlet mouseEvent: editorBrowser.IEditorMouseEvent = {\n\t\t\tevent: e,\n\t\t\ttarget: t\n\t\t};\n\t\tthis.viewController.emitMouseMove(mouseEvent);\n\t}\n\n\tprivate _onMouseLeave(rawEvent: MouseEvent): void {\n\t\tthis.lastMouseLeaveTime = (new Date()).getTime();\n\t\tlet mouseEvent: editorBrowser.IEditorMouseEvent = {\n\t\t\tevent: new StandardMouseEvent(rawEvent),\n\t\t\ttarget: null\n\t\t};\n\t\tthis.viewController.emitMouseLeave(mouseEvent);\n\t}\n\n\tpublic _onMouseUp(rawEvent: MouseEvent): void {\n\t\tlet e = new StandardMouseEvent(rawEvent);\n\t\tlet t = this._createMouseTarget(e, true);\n\n\t\tlet mouseEvent: editorBrowser.IEditorMouseEvent = {\n\t\t\tevent: e,\n\t\t\ttarget: t\n\t\t};\n\t\tthis.viewController.emitMouseUp(mouseEvent);\n\t}\n\n\tpublic _onMouseDown(rawEvent: MouseEvent): void {\n\t\tlet e = new StandardMouseEvent(rawEvent);\n\t\tlet t = this._createMouseTarget(e, true);\n\n\t\tlet targetIsContent = (t.type === editorCommon.MouseTargetType.CONTENT_TEXT || t.type === editorCommon.MouseTargetType.CONTENT_EMPTY);\n\t\tlet targetIsGutter = (t.type === editorCommon.MouseTargetType.GUTTER_GLYPH_MARGIN || t.type === editorCommon.MouseTargetType.GUTTER_LINE_NUMBERS || t.type === editorCommon.MouseTargetType.GUTTER_LINE_DECORATIONS);\n\t\tlet targetIsLineNumbers = (t.type === editorCommon.MouseTargetType.GUTTER_LINE_NUMBERS);\n\t\tlet selectOnLineNumbers = this.context.configuration.editor.selectOnLineNumbers;\n\t\tlet targetIsViewZone = (t.type === editorCommon.MouseTargetType.CONTENT_VIEW_ZONE || t.type === editorCommon.MouseTargetType.GUTTER_VIEW_ZONE);\n\n\t\tlet shouldHandle = e.leftButton;\n\t\tif (platform.isMacintosh && e.ctrlKey) {\n\t\t\tshouldHandle = false;\n\t\t}\n\n\t\tif (shouldHandle && (targetIsContent || (targetIsLineNumbers && selectOnLineNumbers))) {\n\t\t\tif (browser.isIE11orEarlier) {\n\t\t\t\t// IE does not want to focus when coming in from the browser's address bar\n\t\t\t\tif ((<any>e.browserEvent).fromElement) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.viewHelper.focusTextArea();\n\t\t\t\t} else {\n\t\t\t\t\t// TODO@Alex -> cancel this if focus is lost\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tthis.viewHelper.focusTextArea();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.viewHelper.focusTextArea();\n\t\t\t}\n\n\t\t\tthis._mouseDownOperation.start(t.type, e);\n\n\t\t} else if (targetIsGutter) {\n\t\t\t// Do not steal focus\n\t\t\te.preventDefault();\n\t\t} else if (targetIsViewZone) {\n\t\t\tlet viewZoneData = <editorBrowser.IViewZoneData>t.detail;\n\t\t\tif (this.viewHelper.shouldSuppressMouseDownOnViewZone(viewZoneData.viewZoneId)) {\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t}\n\n\t\tlet mouseEvent: editorBrowser.IEditorMouseEvent = {\n\t\t\tevent: e,\n\t\t\ttarget: t\n\t\t};\n\t\tthis.viewController.emitMouseDown(mouseEvent);\n\t}\n}\n\nclass MouseDownOperation extends Disposable {\n\n\tprivate _context:editorBrowser.IViewContext;\n\tprivate _viewController:editorBrowser.IViewController;\n\tprivate _viewHelper:editorBrowser.IPointerHandlerHelper;\n\tprivate _createMouseTarget:(e:ISimplifiedMouseEvent, testEventTarget:boolean)=>editorBrowser.IMouseTarget;\n\tprivate _getMouseColumn:(e:ISimplifiedMouseEvent)=>number;\n\n\tprivate _mouseMoveMonitor:GlobalMouseMoveMonitor<IMouseEvent>;\n\tprivate _mouseDownThenMoveEventHandler: EventGateKeeper<IMouseEvent>;\n\n\tprivate _currentSelection: editorCommon.IEditorSelection;\n\tprivate _mouseState: MouseDownState;\n\n\tprivate _onScrollTimeout: TimeoutTimer;\n\tprivate _isActive: boolean;\n\n\tprivate _lastMouseEvent: IMouseEvent;\n\n\tconstructor(\n\t\tcontext:editorBrowser.IViewContext,\n\t\tviewController:editorBrowser.IViewController,\n\t\tviewHelper:editorBrowser.IPointerHandlerHelper,\n\t\tcreateMouseTarget:(e:ISimplifiedMouseEvent, testEventTarget:boolean)=>editorBrowser.IMouseTarget,\n\t\tgetMouseColumn:(e:ISimplifiedMouseEvent)=>number\n\t) {\n\t\tsuper();\n\t\tthis._context = context;\n\t\tthis._viewController = viewController;\n\t\tthis._viewHelper = viewHelper;\n\t\tthis._createMouseTarget = createMouseTarget;\n\t\tthis._getMouseColumn = getMouseColumn;\n\n\t\tthis._currentSelection = Selection.createSelection(1, 1, 1, 1);\n\t\tthis._mouseState = new MouseDownState();\n\n\t\tthis._onScrollTimeout = this._register(new TimeoutTimer());\n\t\tthis._isActive = false;\n\n\t\tthis._lastMouseEvent = null;\n\n\t\tthis._mouseMoveMonitor = this._register(new GlobalMouseMoveMonitor<IMouseEvent>());\n\t\tthis._mouseDownThenMoveEventHandler = this._register(\n\t\t\tnew EventGateKeeper<IMouseEvent>(\n\t\t\t\t(e) => this._onMouseDownThenMove(e),\n\t\t\t\t() => !this._viewHelper.isDirty()\n\t\t\t)\n\t\t);\n\t}\n\n\tpublic dispose(): void {\n\t\tsuper.dispose();\n\t}\n\n\tpublic isActive(): boolean {\n\t\treturn this._isActive;\n\t}\n\n\tprivate _onMouseDownThenMove(e:IMouseEvent): void {\n\t\tthis._lastMouseEvent = e;\n\t\tthis._mouseState.setModifiers(e);\n\n\t\tlet position = this._findMousePosition(e, true);\n\t\tif (!position) {\n\t\t\t// Ignoring because position is unknown\n\t\t\treturn;\n\t\t}\n\n\t\tthis._dispatchMouse(position, true);\n\t}\n\n\tpublic start(targetType:editorCommon.MouseTargetType, e:IMouseEvent): void {\n\t\tthis._lastMouseEvent = e;\n\n\t\tthis._mouseState.setStartedOnLineNumbers(targetType === editorCommon.MouseTargetType.GUTTER_LINE_NUMBERS);\n\t\tthis._mouseState.setModifiers(e);\n\n\t\tlet position = this._findMousePosition(e, true);\n\t\tif (!position) {\n\t\t\t// Ignoring because position is unknown\n\t\t\treturn;\n\t\t}\n\n\t\tthis._mouseState.trySetCount(e.detail, position.position);\n\n\t\t// Overwrite the detail of the MouseEvent, as it will be sent out in an event and contributions might rely on it.\n\t\te.detail = this._mouseState.count;\n\n\t\tthis._dispatchMouse(position, e.shiftKey);\n\n\t\tif (!this._isActive) {\n\t\t\tthis._isActive = true;\n\t\t\tthis._mouseMoveMonitor.startMonitoring(\n\t\t\t\tcreateMouseMoveEventMerger(null),\n\t\t\t\tthis._mouseDownThenMoveEventHandler.handler,\n\t\t\t\t() => this._stop()\n\t\t\t);\n\t\t}\n\t}\n\n\tprivate _stop(): void {\n\t\tthis._isActive = false;\n\t\tthis._onScrollTimeout.cancel();\n\t}\n\n\tpublic onScrollChanged(): void {\n\t\tif (!this._isActive) {\n\t\t\treturn;\n\t\t}\n\t\tthis._onScrollTimeout.setIfNotSet(() => {\n\t\t\tlet position = this._findMousePosition(this._lastMouseEvent, false);\n\t\t\tif (!position) {\n\t\t\t\t// Ignoring because position is unknown\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._dispatchMouse(position, true);\n\t\t}, 10);\n\t}\n\n\tpublic onCursorSelectionChanged(e:editorCommon.IViewCursorSelectionChangedEvent): void {\n\t\tthis._currentSelection = e.selection;\n\t}\n\n\t// private _getMouseColumn(e: ISimplifiedMouseEvent)\n\n\tprivate _getPositionOutsideEditor(e: ISimplifiedMouseEvent): MousePosition {\n\t\tlet editorContent = dom.getDomNodePosition(this._viewHelper.viewDomNode);\n\t\tlet mouseColumn = this._getMouseColumn(e);\n\n\t\tif (e.posy < editorContent.top) {\n\t\t\tlet aboveLineNumber = this._viewHelper.getLineNumberAtVerticalOffset(Math.max(this._viewHelper.getScrollTop() - (editorContent.top - e.posy), 0));\n\t\t\treturn new MousePosition(new Position(aboveLineNumber, 1), mouseColumn);\n\t\t}\n\n\t\tif (e.posy > editorContent.top + editorContent.height) {\n\t\t\tlet belowLineNumber = this._viewHelper.getLineNumberAtVerticalOffset(this._viewHelper.getScrollTop() + (e.posy - editorContent.top));\n\t\t\treturn new MousePosition(new Position(belowLineNumber, this._context.model.getLineMaxColumn(belowLineNumber)), mouseColumn);\n\t\t}\n\n\t\tlet possibleLineNumber = this._viewHelper.getLineNumberAtVerticalOffset(this._viewHelper.getScrollTop() + (e.posy - editorContent.top));\n\n\t\tif (e.posx < editorContent.left) {\n\t\t\treturn new MousePosition(new Position(possibleLineNumber, 1), mouseColumn);\n\t\t}\n\n\t\tif (e.posx > editorContent.left + editorContent.width) {\n\t\t\treturn new MousePosition(new Position(possibleLineNumber, this._context.model.getLineMaxColumn(possibleLineNumber)), mouseColumn);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tprivate _findMousePosition(e:ISimplifiedMouseEvent, testEventTarget:boolean): MousePosition {\n\t\tlet positionOutsideEditor = this._getPositionOutsideEditor(e);\n\t\tif (positionOutsideEditor) {\n\t\t\treturn positionOutsideEditor;\n\t\t}\n\n\t\tlet t = this._createMouseTarget(e, testEventTarget);\n\t\tlet hintedPosition = t.position;\n\t\tif (!hintedPosition) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (t.type === editorCommon.MouseTargetType.CONTENT_VIEW_ZONE || t.type === editorCommon.MouseTargetType.GUTTER_VIEW_ZONE) {\n\t\t\t// Force position on view zones to go above or below depending on where selection started from\n\t\t\tlet selectionStart = new Position(this._currentSelection.selectionStartLineNumber, this._currentSelection.selectionStartColumn);\n\t\t\tlet viewZoneData = <editorBrowser.IViewZoneData>t.detail;\n\t\t\tlet positionBefore = viewZoneData.positionBefore;\n\t\t\tlet positionAfter = viewZoneData.positionAfter;\n\n\t\t\tif (positionBefore && positionAfter) {\n\t\t\t\tif (positionBefore.isBefore(selectionStart)) {\n\t\t\t\t\treturn new MousePosition(positionBefore, t.mouseColumn);\n\t\t\t\t} else {\n\t\t\t\t\treturn new MousePosition(positionAfter, t.mouseColumn);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn new MousePosition(hintedPosition, t.mouseColumn);\n\t}\n\n\tprivate _dispatchMouse(position: MousePosition, inSelectionMode:boolean): void {\n\t\tthis._viewController.dispatchMouse({\n\t\t\tposition: position.position,\n\t\t\tmouseColumn: position.mouseColumn,\n\t\t\tstartedOnLineNumbers: this._mouseState.startedOnLineNumbers,\n\n\t\t\tinSelectionMode: inSelectionMode,\n\t\t\tmouseDownCount: this._mouseState.count,\n\t\t\taltKey: this._mouseState.altKey,\n\t\t\tctrlKey: this._mouseState.ctrlKey,\n\t\t\tmetaKey: this._mouseState.metaKey,\n\t\t\tshiftKey: this._mouseState.shiftKey,\n\t\t});\n\t}\n}\n\nclass MouseDownState {\n\n\tprivate static CLEAR_MOUSE_DOWN_COUNT_TIME = 400; // ms\n\n\tprivate _altKey: boolean;\n\tpublic get altKey(): boolean { return this._altKey; }\n\n\tprivate _ctrlKey: boolean;\n\tpublic get ctrlKey(): boolean { return this._ctrlKey; }\n\n\tprivate _metaKey: boolean;\n\tpublic get metaKey(): boolean { return this._metaKey; }\n\n\tprivate _shiftKey: boolean;\n\tpublic get shiftKey(): boolean { return this._shiftKey; }\n\n\tprivate _startedOnLineNumbers: boolean;\n\tpublic get startedOnLineNumbers(): boolean { return this._startedOnLineNumbers; }\n\n\tprivate _lastMouseDownPosition: editorCommon.IEditorPosition;\n\tprivate _lastMouseDownPositionEqualCount: number;\n\tprivate _lastMouseDownCount: number;\n\tprivate _lastSetMouseDownCountTime: number;\n\n\tconstructor() {\n\t\tthis._altKey = false;\n\t\tthis._ctrlKey = false;\n\t\tthis._metaKey = false;\n\t\tthis._shiftKey = false;\n\t\tthis._startedOnLineNumbers = false;\n\t\tthis._lastMouseDownPosition = null;\n\t\tthis._lastMouseDownPositionEqualCount = 0;\n\t\tthis._lastMouseDownCount = 0;\n\t\tthis._lastSetMouseDownCountTime = 0;\n\t}\n\n\tpublic get count(): number {\n\t\treturn this._lastMouseDownCount;\n\t}\n\n\tpublic setModifiers(source:IMouseEvent) {\n\t\tthis._altKey = source.altKey;\n\t\tthis._ctrlKey = source.ctrlKey;\n\t\tthis._metaKey = source.metaKey;\n\t\tthis._shiftKey = source.shiftKey;\n\t}\n\n\tpublic setStartedOnLineNumbers(startedOnLineNumbers:boolean): void {\n\t\tthis._startedOnLineNumbers = startedOnLineNumbers;\n\t}\n\n\tpublic trySetCount(setMouseDownCount:number, newMouseDownPosition:editorCommon.IEditorPosition): void {\n\t\t// a. Invalidate multiple clicking if too much time has passed (will be hit by IE because the detail field of mouse events contains garbage in IE10)\n\t\tlet currentTime = (new Date()).getTime();\n\t\tif (currentTime - this._lastSetMouseDownCountTime > MouseDownState.CLEAR_MOUSE_DOWN_COUNT_TIME) {\n\t\t\tsetMouseDownCount = 1;\n\t\t}\n\t\tthis._lastSetMouseDownCountTime = currentTime;\n\n\t\t// b. Ensure that we don't jump from single click to triple click in one go (will be hit by IE because the detail field of mouse events contains garbage in IE10)\n\t\tif (setMouseDownCount > this._lastMouseDownCount + 1) {\n\t\t\tsetMouseDownCount = this._lastMouseDownCount + 1;\n\t\t}\n\n\t\t// c. Invalidate multiple clicking if the logical position is different\n\t\tif (this._lastMouseDownPosition && this._lastMouseDownPosition.equals(newMouseDownPosition)) {\n\t\t\tthis._lastMouseDownPositionEqualCount++;\n\t\t} else {\n\t\t\tthis._lastMouseDownPositionEqualCount = 1;\n\t\t}\n\t\tthis._lastMouseDownPosition = newMouseDownPosition;\n\n\t\t// Finally set the lastMouseDownCount\n\t\tthis._lastMouseDownCount = Math.min(setMouseDownCount, this._lastMouseDownPositionEqualCount);\n\t}\n\n}\n"]}