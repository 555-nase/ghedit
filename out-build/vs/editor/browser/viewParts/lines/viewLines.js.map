{"version":3,"file":"vs/editor/browser/viewParts/lines/viewLines.js","sourceRoot":"file:///Users/darrin/src/vscode/src","sources":["vs/editor/browser/viewParts/lines/viewLines.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\n\nimport {RunOnceScheduler} from 'vs/base/common/async';\nimport * as browser from 'vs/base/browser/browser';\nimport {StyleMutator} from 'vs/base/browser/styleMutator';\nimport {Range} from 'vs/editor/common/core/range';\nimport * as editorCommon from 'vs/editor/common/editorCommon';\nimport {ClassNames, ILayoutProvider, IViewContext} from 'vs/editor/browser/editorBrowser';\nimport {IVisibleLineData, ViewLayer} from 'vs/editor/browser/view/viewLayer';\nimport {ViewLine, createLine} from 'vs/editor/browser/viewParts/lines/viewLine';\n\nclass LastRenderedData {\n\n\tprivate _currentVisibleRange: Range;\n\tprivate _bigNumbersDelta: number;\n\n\tconstructor() {\n\t\tthis._currentVisibleRange = new Range(1, 1, 1, 1);\n\t\tthis._bigNumbersDelta = 0;\n\t}\n\n\tpublic getCurrentVisibleRange(): Range {\n\t\treturn this._currentVisibleRange;\n\t}\n\n\tpublic setCurrentVisibleRange(currentVisibleRange:Range): void {\n\t\tthis._currentVisibleRange = currentVisibleRange;\n\t}\n\n\tpublic getBigNumbersDelta(): number {\n\t\treturn this._bigNumbersDelta;\n\t}\n\n\tpublic setBigNumbersDelta(bigNumbersDelta:number): void {\n\t\tthis._bigNumbersDelta = bigNumbersDelta;\n\t}\n}\n\nexport class ViewLines extends ViewLayer {\n\t/**\n\t * Width to extends a line to render the line feed at the end of the line\n\t */\n\tprivate static LINE_FEED_WIDTH = 10;\n\t/**\n\t * Adds this ammount of pixels to the right of lines (no-one wants to type near the edge of the viewport)\n\t */\n\tprivate static HORIZONTAL_EXTRA_PX = 30;\n\n\n\tprivate _layoutProvider:ILayoutProvider;\n\t_lines:ViewLine[];\n\tprivate _textRangeRestingSpot:HTMLElement;\n\n\t// --- config\n\tprivate _lineHeight: number;\n\tprivate _isViewportWrapping: boolean;\n\tprivate _revealHorizontalRightPadding: number;\n\n\t// --- width\n\tprivate _maxLineWidth: number;\n\tprivate _asyncUpdateLineWidths: RunOnceScheduler;\n\n\tprivate _lastCursorRevealRangeHorizontallyEvent:editorCommon.IViewRevealRangeEvent;\n\tprivate _lastRenderedData: LastRenderedData;\n\n\tconstructor(context:IViewContext, layoutProvider:ILayoutProvider) {\n\t\tsuper(context);\n\t\tthis._lineHeight = this._context.configuration.editor.lineHeight;\n\t\tthis._isViewportWrapping = this._context.configuration.editor.wrappingInfo.isViewportWrapping;\n\t\tthis._revealHorizontalRightPadding = this._context.configuration.editor.revealHorizontalRightPadding;\n\t\tthis._layoutProvider = layoutProvider;\n\t\tthis.domNode.setClassName(ClassNames.VIEW_LINES);\n\n\t\t// --- width & height\n\t\tthis._maxLineWidth = 0;\n\t\tthis._asyncUpdateLineWidths = new RunOnceScheduler(() => {\n\t\t\tthis._updateLineWidths();\n\t\t}, 200);\n\n\t\tthis._lastRenderedData = new LastRenderedData();\n\n\t\tthis._lastCursorRevealRangeHorizontallyEvent = null;\n\t\tthis._textRangeRestingSpot = document.createElement('div');\n\t\tthis._textRangeRestingSpot.className = 'textRangeRestingSpot';\n\t}\n\n\tpublic dispose(): void {\n\t\tthis._asyncUpdateLineWidths.dispose();\n\t\tthis._layoutProvider = null;\n\t\tsuper.dispose();\n\t}\n\n\tpublic getDomNode(): HTMLElement {\n\t\treturn this.domNode.domNode;\n\t}\n\n\t// ---- begin view event handlers\n\n\tpublic onConfigurationChanged(e:editorCommon.IConfigurationChangedEvent): boolean {\n\t\tvar shouldRender = super.onConfigurationChanged(e);\n\t\tif (e.wrappingInfo) {\n\t\t\tthis._maxLineWidth = 0;\n\t\t}\n\n\t\tif (e.lineHeight) {\n\t\t\tthis._lineHeight = this._context.configuration.editor.lineHeight;\n\t\t}\n\t\tif (e.wrappingInfo) {\n\t\t\tthis._isViewportWrapping = this._context.configuration.editor.wrappingInfo.isViewportWrapping;\n\t\t}\n\t\tif (e.revealHorizontalRightPadding) {\n\t\t\tthis._revealHorizontalRightPadding = this._context.configuration.editor.revealHorizontalRightPadding;\n\t\t}\n\n\t\treturn shouldRender;\n\t}\n\n\tpublic onLayoutChanged(layoutInfo:editorCommon.IEditorLayoutInfo): boolean {\n\t\tvar shouldRender = super.onLayoutChanged(layoutInfo);\n\t\tthis._maxLineWidth = 0;\n\t\treturn shouldRender;\n\t}\n\n\tpublic onModelFlushed(): boolean {\n\t\tvar shouldRender = super.onModelFlushed();\n\t\tthis._maxLineWidth = 0;\n\t\treturn shouldRender;\n\t}\n\n\tpublic onScrollWidthChanged(scrollWidth:number): boolean {\n\t\tthis.domNode.setWidth(scrollWidth);\n\t\treturn false;\n\t}\n\n\tpublic onModelDecorationsChanged(e:editorCommon.IViewDecorationsChangedEvent): boolean {\n\t\tvar shouldRender = super.onModelDecorationsChanged(e);\n\t\tfor (var i = 0; i < this._lines.length; i++) {\n\t\t\tthis._lines[i].onModelDecorationsChanged();\n\t\t}\n\t\treturn shouldRender || true;\n\t}\n\n\tpublic onCursorRevealRange(e:editorCommon.IViewRevealRangeEvent): boolean {\n\t\tvar newScrollTop = this._computeScrollTopToRevealRange(this._layoutProvider.getCurrentViewport(), e.range, e.verticalType);\n\n\t\tif (e.revealHorizontal) {\n\t\t\tthis._lastCursorRevealRangeHorizontallyEvent = e;\n\t\t}\n\n\t\tthis._layoutProvider.setScrollTop(newScrollTop);\n\n\t\treturn true;\n\t}\n\n\tpublic onCursorScrollRequest(e:editorCommon.IViewScrollRequestEvent): boolean {\n\t\tlet currentScrollTop = this._layoutProvider.getScrollTop();\n\t\tlet newScrollTop = currentScrollTop + e.deltaLines * this._lineHeight;\n\t\tthis._layoutProvider.setScrollTop(newScrollTop);\n\t\treturn true;\n\t}\n\n\tpublic onScrollChanged(e:editorCommon.IScrollEvent): boolean {\n\t\treturn super.onScrollChanged(e) || true;\n\t}\n\n\t// ---- end view event handlers\n\n\t// ----------- HELPERS FOR OTHERS\n\n\tpublic getPositionFromDOMInfo(spanNode:HTMLElement, offset:number): editorCommon.IPosition {\n\t\tvar lineNumber = this._getLineNumberFromDOMInfo(spanNode);\n\n\t\tif (lineNumber === -1) {\n\t\t\t// Couldn't find span node\n\t\t\treturn null;\n\t\t}\n\n\t\tif (lineNumber < 1 || lineNumber > this._context.model.getLineCount()) {\n\t\t\t// lineNumber is outside range\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this._context.model.getLineMaxColumn(lineNumber) === 1) {\n\t\t\t// Line is empty\n\t\t\treturn {\n\t\t\t\tlineNumber: lineNumber,\n\t\t\t\tcolumn: 1\n\t\t\t};\n\t\t}\n\n\t\tvar lineIndex = lineNumber - this._rendLineNumberStart;\n\t\tif (lineIndex < 0 || lineIndex >= this._lines.length) {\n\t\t\t// Couldn't find line\n\t\t\treturn null;\n\t\t}\n\n\t\tvar column = this._lines[lineIndex].getColumnOfNodeOffset(lineNumber, spanNode, offset);\n\t\tvar minColumn = this._context.model.getLineMinColumn(lineNumber);\n\t\tif (column < minColumn) {\n\t\t\tcolumn = minColumn;\n\t\t}\n\t\treturn {\n\t\t\tlineNumber: lineNumber,\n\t\t\tcolumn: column\n\t\t};\n\t}\n\n\tprivate _getLineNumberFromDOMInfo(spanNode:HTMLElement): number {\n\t\twhile (spanNode && spanNode.nodeType === 1) {\n\t\t\tif (spanNode.className === ClassNames.VIEW_LINE) {\n\t\t\t\treturn parseInt(spanNode.getAttribute('lineNumber'), 10);\n\t\t\t}\n\t\t\tspanNode = spanNode.parentElement;\n\t\t}\n\t\treturn -1;\n\t}\n\n\tpublic getLineWidth(lineNumber: number): number {\n\t\tvar lineIndex = lineNumber - this._rendLineNumberStart;\n\t\tif (lineIndex < 0 || lineIndex >= this._lines.length) {\n\t\t\treturn -1;\n\t\t}\n\n\t\treturn this._lines[lineIndex].getWidth();\n\t}\n\n\tpublic linesVisibleRangesForRange(range:editorCommon.IRange, includeNewLines:boolean): editorCommon.LineVisibleRanges[] {\n\t\tif (this.shouldRender()) {\n\t\t\t// Cannot read from the DOM because it is dirty\n\t\t\t// i.e. the model & the dom are out of sync, so I'd be reading something stale\n\t\t\treturn null;\n\t\t}\n\n\t\tlet originalEndLineNumber = range.endLineNumber;\n\t\trange = Range.intersectRanges(range, this._lastRenderedData.getCurrentVisibleRange());\n\t\tif (!range) {\n\t\t\treturn null;\n\t\t}\n\n\t\tlet visibleRanges:editorCommon.LineVisibleRanges[] = [];\n\t\tlet clientRectDeltaLeft = this.domNode.domNode.getBoundingClientRect().left;\n\n\t\tlet nextLineModelLineNumber:number;\n\t\tif (includeNewLines) {\n\t\t\tnextLineModelLineNumber = this._context.model.convertViewPositionToModelPosition(range.startLineNumber, 1).lineNumber;\n\t\t}\n\n\t\tfor (let lineNumber = range.startLineNumber; lineNumber <= range.endLineNumber; lineNumber++) {\n\t\t\tlet lineIndex = lineNumber - this._rendLineNumberStart;\n\n\t\t\tif (lineIndex < 0 || lineIndex >= this._lines.length) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet startColumn = lineNumber === range.startLineNumber ? range.startColumn : 1;\n\t\t\tlet endColumn = lineNumber === range.endLineNumber ? range.endColumn : this._context.model.getLineMaxColumn(lineNumber);\n\t\t\tlet visibleRangesForLine = this._lines[lineIndex].getVisibleRangesForRange(startColumn, endColumn, clientRectDeltaLeft, this._textRangeRestingSpot);\n\n\t\t\tif (!visibleRangesForLine || visibleRangesForLine.length === 0) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (includeNewLines && lineNumber < originalEndLineNumber) {\n\t\t\t\tlet currentLineModelLineNumber = nextLineModelLineNumber;\n\t\t\t\tnextLineModelLineNumber = this._context.model.convertViewPositionToModelPosition(lineNumber + 1, 1).lineNumber;\n\n\t\t\t\tif (currentLineModelLineNumber !== nextLineModelLineNumber) {\n\t\t\t\t\tvisibleRangesForLine[visibleRangesForLine.length - 1].width += ViewLines.LINE_FEED_WIDTH;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvisibleRanges.push(new editorCommon.LineVisibleRanges(lineNumber, visibleRangesForLine));\n\t\t}\n\n\t\tif (visibleRanges.length === 0) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn visibleRanges;\n\t}\n\n\tpublic visibleRangesForRange2(range:editorCommon.IRange, deltaTop:number): editorCommon.VisibleRange[] {\n\n\t\tif (this.shouldRender()) {\n\t\t\t// Cannot read from the DOM because it is dirty\n\t\t\t// i.e. the model & the dom are out of sync, so I'd be reading something stale\n\t\t\treturn null;\n\t\t}\n\n\t\trange = Range.intersectRanges(range, this._lastRenderedData.getCurrentVisibleRange());\n\t\tif (!range) {\n\t\t\treturn null;\n\t\t}\n\n\t\tlet result:editorCommon.VisibleRange[] = [];\n\t\tlet clientRectDeltaLeft = this.domNode.domNode.getBoundingClientRect().left;\n\t\tlet bigNumbersDelta = this._lastRenderedData.getBigNumbersDelta();\n\n\t\tfor (let lineNumber = range.startLineNumber; lineNumber <= range.endLineNumber; lineNumber++) {\n\t\t\tlet lineIndex = lineNumber - this._rendLineNumberStart;\n\n\t\t\tif (lineIndex < 0 || lineIndex >= this._lines.length) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet startColumn = lineNumber === range.startLineNumber ? range.startColumn : 1;\n\t\t\tlet endColumn = lineNumber === range.endLineNumber ? range.endColumn : this._context.model.getLineMaxColumn(lineNumber);\n\t\t\tlet visibleRangesForLine = this._lines[lineIndex].getVisibleRangesForRange(startColumn, endColumn, clientRectDeltaLeft, this._textRangeRestingSpot);\n\n\t\t\tif (!visibleRangesForLine || visibleRangesForLine.length === 0) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet adjustedLineNumberVerticalOffset = this._layoutProvider.getVerticalOffsetForLineNumber(lineNumber) - bigNumbersDelta + deltaTop;\n\t\t\tfor (let i = 0, len = visibleRangesForLine.length; i < len; i++) {\n\t\t\t\tresult.push(new editorCommon.VisibleRange(adjustedLineNumberVerticalOffset, visibleRangesForLine[i].left, visibleRangesForLine[i].width));\n\t\t\t}\n\t\t}\n\n\t\tif (result.length === 0) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t// --- implementation\n\n\t_createLine(): IVisibleLineData {\n\t\treturn createLine(this._context);\n\t}\n\n\tprivate _updateLineWidths(): void {\n\t\tvar i:number,\n\t\t\tlocalMaxLineWidth = 1,\n\t\t\twidthInPx:number;\n\n\t\t// Read line widths\n\t\tfor (i = 0; i < this._lines.length; i++) {\n\t\t\twidthInPx = this._lines[i].getWidth();\n\t\t\tlocalMaxLineWidth = Math.max(localMaxLineWidth, widthInPx);\n\t\t}\n\n\t\tthis._ensureMaxLineWidth(localMaxLineWidth);\n\t}\n\n\tpublic prepareRender(): void {\n\t\tthrow new Error('Not supported');\n\t}\n\n\tpublic render(): void {\n\t\tthrow new Error('Not supported');\n\t}\n\n\tpublic renderText(linesViewportData:editorCommon.ViewLinesViewportData, onAfterLinesRendered:()=>void): void {\n\t\tif (!this.shouldRender()) {\n\t\t\tthrow new Error('I did not ask to render!');\n\t\t}\n\n\t\t// (1) render lines - ensures lines are in the DOM\n\t\tsuper._renderLines(linesViewportData);\n\t\tthis._lastRenderedData.setBigNumbersDelta(linesViewportData.bigNumbersDelta);\n\t\tthis._lastRenderedData.setCurrentVisibleRange(linesViewportData.visibleRange);\n\t\tthis.domNode.setWidth(this._layoutProvider.getScrollWidth());\n\t\tthis.domNode.setHeight(Math.min(this._layoutProvider.getTotalHeight(), 1000000));\n\n\t\t// (2) execute DOM writing that forces sync layout (e.g. textArea manipulation)\n\t\tonAfterLinesRendered();\n\n\t\t// (3) compute horizontal scroll position:\n\t\t//  - this must happen after the lines are in the DOM since it might need a line that rendered just now\n\t\t//  - it might change `scrollWidth` and `scrollLeft`\n\t\tif (this._lastCursorRevealRangeHorizontallyEvent) {\n\t\t\tlet revealHorizontalRange = this._lastCursorRevealRangeHorizontallyEvent.range;\n\t\t\tthis._lastCursorRevealRangeHorizontallyEvent = null;\n\n\t\t\t// allow `visibleRangesForRange2` to work\n\t\t\tthis.onDidRender();\n\n\t\t\t// compute new scroll position\n\t\t\tvar newScrollLeft = this._computeScrollLeftToRevealRange(revealHorizontalRange);\n\n\t\t\tvar isViewportWrapping = this._isViewportWrapping;\n\t\t\tif (!isViewportWrapping) {\n\t\t\t\t// ensure `scrollWidth` is large enough\n\t\t\t\tthis._ensureMaxLineWidth(newScrollLeft.maxHorizontalOffset);\n\t\t\t}\n\n\t\t\t// set `scrollLeft`\n\t\t\tthis._layoutProvider.setScrollLeft(newScrollLeft.scrollLeft);\n\t\t}\n\n\t\t// (4) handle scrolling\n\t\tif (browser.canUseTranslate3d) {\n\t\t\tvar transform = 'translate3d(' + -this._layoutProvider.getScrollLeft() + 'px, ' + linesViewportData.visibleRangesDeltaTop + 'px, 0px)';\n\t\t\tStyleMutator.setTransform(<HTMLElement>this.domNode.domNode.parentNode, transform);\n\t\t} else {\n\t\t\tStyleMutator.setTop(<HTMLElement>this.domNode.domNode.parentNode, linesViewportData.visibleRangesDeltaTop); // TODO@Alex\n\t\t\tStyleMutator.setLeft(<HTMLElement>this.domNode.domNode.parentNode, -this._layoutProvider.getScrollLeft()); // TODO@Alex\n\t\t}\n\n\t\t// Update max line width (not so important, it is just so the horizontal scrollbar doesn't get too small)\n\t\tthis._asyncUpdateLineWidths.schedule();\n\t}\n\n\t// --- width\n\n\tprivate _ensureMaxLineWidth(lineWidth: number): void {\n\t\tlet iLineWidth = Math.ceil(lineWidth);\n\t\tif (this._maxLineWidth < iLineWidth) {\n\t\t\tthis._maxLineWidth = iLineWidth;\n\t\t\tthis._layoutProvider.onMaxLineWidthChanged(this._maxLineWidth);\n\t\t}\n\t}\n\n\tprivate _computeScrollTopToRevealRange(viewport:editorCommon.Viewport, range: editorCommon.IEditorRange, verticalType: editorCommon.VerticalRevealType): number {\n\t\tvar viewportStartY = viewport.top,\n\t\t\tviewportHeight = viewport.height,\n\t\t\tviewportEndY = viewportStartY + viewportHeight,\n\t\t\tboxStartY:number,\n\t\t\tboxEndY:number;\n\n\t\t// Have a box that includes one extra line height (for the horizontal scrollbar)\n\t\tboxStartY = this._layoutProvider.getVerticalOffsetForLineNumber(range.startLineNumber);\n\t\tboxEndY = this._layoutProvider.getVerticalOffsetForLineNumber(range.endLineNumber) + this._layoutProvider.heightInPxForLine(range.endLineNumber);\n\t\tif (verticalType === editorCommon.VerticalRevealType.Simple) {\n\t\t\t// Reveal one line more for the arrow down case, when the last line would be covered by the scrollbar\n\t\t\tboxEndY += this._lineHeight;\n\t\t}\n\n\t\tvar newScrollTop: number;\n\n\t\tif (verticalType === editorCommon.VerticalRevealType.Center || verticalType === editorCommon.VerticalRevealType.CenterIfOutsideViewport) {\n\t\t\tif (verticalType === editorCommon.VerticalRevealType.CenterIfOutsideViewport && viewportStartY <= boxStartY && boxEndY <= viewportEndY) {\n\t\t\t\t// Box is already in the viewport... do nothing\n\t\t\t\tnewScrollTop = viewportStartY;\n\t\t\t} else {\n\t\t\t\t// Box is outside the viewport... center it\n\t\t\t\tvar boxMiddleY = (boxStartY + boxEndY) / 2;\n\t\t\t\tnewScrollTop = Math.max(0, boxMiddleY - viewportHeight/2);\n\t\t\t}\n\t\t} else {\n\t\t\tnewScrollTop = this._computeMinimumScrolling(viewportStartY, viewportEndY, boxStartY, boxEndY);\n\t\t}\n\n\t\treturn newScrollTop;\n\t}\n\n\tprivate _computeScrollLeftToRevealRange(range: editorCommon.IEditorRange): { scrollLeft: number; maxHorizontalOffset: number; } {\n\n\t\tvar maxHorizontalOffset = 0;\n\n\t\tif (range.startLineNumber !== range.endLineNumber) {\n\t\t\t// Two or more lines? => scroll to base (That's how you see most of the two lines)\n\t\t\treturn {\n\t\t\t\tscrollLeft: 0,\n\t\t\t\tmaxHorizontalOffset: maxHorizontalOffset\n\t\t\t};\n\t\t}\n\n\t\tvar viewport = this._layoutProvider.getCurrentViewport(),\n\t\t\tviewportStartX = viewport.left,\n\t\t\tviewportEndX = viewportStartX + viewport.width;\n\n\t\tvar visibleRanges = this.visibleRangesForRange2(range, 0),\n\t\t\tboxStartX = Number.MAX_VALUE,\n\t\t\tboxEndX = 0;\n\n\t\tif (!visibleRanges) {\n\t\t\t// Unknown\n\t\t\treturn {\n\t\t\t\tscrollLeft: viewportStartX,\n\t\t\t\tmaxHorizontalOffset: maxHorizontalOffset\n\t\t\t};\n\t\t}\n\n\t\tvar i:number,\n\t\t\tvisibleRange:editorCommon.VisibleRange;\n\n\t\tfor (i = 0; i < visibleRanges.length; i++) {\n\t\t\tvisibleRange = visibleRanges[i];\n\t\t\tif (visibleRange.left < boxStartX) {\n\t\t\t\tboxStartX = visibleRange.left;\n\t\t\t}\n\t\t\tif (visibleRange.left + visibleRange.width > boxEndX) {\n\t\t\t\tboxEndX = visibleRange.left + visibleRange.width;\n\t\t\t}\n\t\t}\n\n\t\tmaxHorizontalOffset = boxEndX;\n\n\t\tboxStartX = Math.max(0, boxStartX - ViewLines.HORIZONTAL_EXTRA_PX);\n\t\tboxEndX += this._revealHorizontalRightPadding;\n\n\t\tvar newScrollLeft = this._computeMinimumScrolling(viewportStartX, viewportEndX, boxStartX, boxEndX);\n\t\treturn {\n\t\t\tscrollLeft: newScrollLeft,\n\t\t\tmaxHorizontalOffset: maxHorizontalOffset\n\t\t};\n\t}\n\n\tprivate _computeMinimumScrolling(viewportStart: number, viewportEnd: number, boxStart: number, boxEnd: number): number {\n\t\tviewportStart = viewportStart|0;\n\t\tviewportEnd = viewportEnd|0;\n\t\tboxStart = boxStart|0;\n\t\tboxEnd = boxEnd|0;\n\n\t\tlet viewportLength = viewportEnd - viewportStart;\n\t\tlet boxLength = boxEnd - boxStart;\n\n\t\tif (boxLength < viewportLength) {\n\t\t\t// The box would fit in the viewport\n\t\t\tif (boxStart < viewportStart) {\n\t\t\t\t// The box is above the viewport\n\t\t\t\treturn boxStart;\n\t\t\t} else if (boxEnd > viewportEnd) {\n\t\t\t\t// The box is below the viewport\n\t\t\t\treturn Math.max(0, boxEnd - viewportLength);\n\t\t\t}\n\t\t} else {\n\t\t\t// The box would not fit in the viewport\n\t\t\t// Reveal the beginning of the box\n\t\t\treturn boxStart;\n\t\t}\n\n\t\treturn viewportStart;\n\t}\n}\n"]}